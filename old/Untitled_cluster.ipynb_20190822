{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "406829\n",
      "Index([u'InvoiceNo', u'StockCode', u'Description', u'Quantity', u'InvoiceDate',\n",
      "       u'UnitPrice', u'CustomerID', u'Country'],\n",
      "      dtype='object')\n",
      "     InvoiceNo StockCode                     Description  Quantity  \\\n",
      "5000    537026     22551        PLASTERS IN TIN SPACEBOY        12   \n",
      "5001    537026    85099B         JUMBO BAG RED RETROSPOT        10   \n",
      "5002    537026     22355       CHARLOTTE BAG SUKI DESIGN        10   \n",
      "5003    537026     84992  72 SWEETHEART FAIRY CAKE CASES        24   \n",
      "5004    537026      POST                         POSTAGE         2   \n",
      "\n",
      "          InvoiceDate  UnitPrice  CustomerID  Country  TotalRevenue  \n",
      "5000  12/3/2010 16:35       1.65     12395.0  Belgium          19.8  \n",
      "5001  12/3/2010 16:35       1.95     12395.0  Belgium          19.5  \n",
      "5002  12/3/2010 16:35       0.85     12395.0  Belgium           8.5  \n",
      "5003  12/3/2010 16:35       0.55     12395.0  Belgium          13.2  \n",
      "5004  12/3/2010 16:35      18.00     12395.0  Belgium          36.0  \n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "data = pd.read_csv('./data.csv')\n",
    "\n",
    "data = data[~data['CustomerID'].isna()].reset_index(drop=True)\n",
    "print len(data)\n",
    "print data.keys()\n",
    "import matplotlib.pyplot as plt\n",
    "data['TotalRevenue'] = data['Quantity']*data['UnitPrice']/1#interpretation\n",
    "print data.iloc[5000:5005]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "  InvoiceNo StockCode                          Description  Quantity  \\\n",
      "0    536365    85123A   WHITE HANGING HEART T-LIGHT HOLDER         6   \n",
      "1    536365     71053                  WHITE METAL LANTERN         6   \n",
      "2    536365    84406B       CREAM CUPID HEARTS COAT HANGER         8   \n",
      "3    536365    84029G  KNITTED UNION FLAG HOT WATER BOTTLE         6   \n",
      "4    536365    84029E       RED WOOLLY HOTTIE WHITE HEART.         6   \n",
      "\n",
      "      InvoiceDate  UnitPrice  CustomerID         Country  TotalRevenue  Month  \\\n",
      "0  12/1/2010 8:26       2.55     17850.0  United Kingdom         15.30     12   \n",
      "1  12/1/2010 8:26       3.39     17850.0  United Kingdom         20.34     12   \n",
      "2  12/1/2010 8:26       2.75     17850.0  United Kingdom         22.00     12   \n",
      "3  12/1/2010 8:26       3.39     17850.0  United Kingdom         20.34     12   \n",
      "4  12/1/2010 8:26       3.39     17850.0  United Kingdom         20.34     12   \n",
      "\n",
      "   Day  Year  Time  Hour  Min  \n",
      "0    1  2010  8:26     8   26  \n",
      "1    1  2010  8:26     8   26  \n",
      "2    1  2010  8:26     8   26  \n",
      "3    1  2010  8:26     8   26  \n",
      "4    1  2010  8:26     8   26  \n"
     ]
    }
   ],
   "source": [
    "data['Month'] = data['InvoiceDate'].apply(lambda x : x.split('/')[0]).astype(np.uint8)\n",
    "data['Day'] = data['InvoiceDate'].apply(lambda x : x.split('/')[1]).astype(np.uint8)\n",
    "data['Year'] = data['InvoiceDate'].apply(lambda x : x.split('/')[2].split(' ')[0]).astype(np.uint16)\n",
    "data['Time'] = data['InvoiceDate'].apply(lambda x : x.split('/')[2].split(' ')[1])\n",
    "data['Hour']= data['Time'].apply(lambda x : x.split(':')[0]).astype(np.uint8)\n",
    "data['Min']= data['Time'].apply(lambda x : x.split(':')[1]).astype(np.uint8)\n",
    "print data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXoAAAD8CAYAAAB5Pm/hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvIxREBQAADbBJREFUeJzt3V+MXOddxvHvg02CVKqQ1AVZdsw6bBThKxpWbgKo4gKCnWgbqCKwhdRQrFopGMEFF47KRS9TJLiIGki2ahQJVUlD+NNUcWRQaRQhRWkclKa2jJut5SpLotohYkHchJSXizmmk+3OenZnZsf76/cjjXbmnfPnfXMmj8a/8545aa0hSarrR6bdAUnSZBn0klScQS9JxRn0klScQS9JxRn0klScQS9JxRn0klScQS9JxW2fdgcAduzY0WZmZqbdDUnaUl5++eW3WmsfvNJyV0XQz8zMcOrUqWl3Q5K2lCTfGWY5SzeSVNxUgz7JfJKF5eXlaXZDkkqbatC31r7SWjt63XXXTbMbklSapRtJKs6gl6TirNFLUnHW6CWpOEs3klTcVXHB1Chmjj8ztX1feOCuqe1bkoblN3pJKs6TsZJUnCdjJak4SzeSVJxBL0nFGfSSVJxBL0nFGfSSVJzTKyWpOKdXSlJxlm4kqTiDXpKKM+glqTiDXpKKM+glqTiDXpKKM+glqTiDXpKK88pYSSrOK2MlqThLN5JUnEEvScUZ9JJUnEEvScUZ9JJUnEEvScUZ9JJUnEEvScUZ9JJUnEEvScWNPeiT/GySh5M8leRT496+JGl9hgr6JI8muZjk9Ir2A0nOJVlMchygtXa2tXYf8JvA3Pi7LElaj2G/0T8GHOhvSLINeAg4COwDDifZ1733UeCfga+OraeSpA0ZKuhba88Db69o3g8sttbOt9beAZ4A7u6Wf7q19gvAb4+zs5Kk9ds+wrq7gNf7Xi8BH07yy8DHgGuBE4NWTnIUOAqwZ8+eEbohSVrLKEGfVdpaa+054LkrrdxaWwAWAObm5toI/ZAkrWGUWTdLwI19r3cDb6xnA95hSpImb5Sgfwm4OcneJNcAh4Cn17MB7zAlSZM37PTKx4EXgFuSLCU50lp7FzgGnATOAk+21s5MrquSpI0YqkbfWjs8oP0Ea5xwvZIk88D87OzsRjchSboCbw4uScX5WzeSVNxUg95ZN5I0eZZuJKk4SzeSVJxBL0nFWaOXpOKs0UtScZZuJKk4g16SirNGL0nFWaOXpOIs3UhScQa9JBVn0EtScQa9JBXnrBtJKs5ZN5JUnKUbSSrOoJek4gx6SSrOoJek4px1I0nFOetGkoqzdCNJxRn0klScQS9JxRn0klScQS9JxRn0klScQS9JxRn0klScV8ZKUnFeGStJxVm6kaTiDHpJKs6gl6TiDHpJKs6gl6TiDHpJKs6gl6TiDHpJKs6gl6TiDHpJKm4iQZ/k15N8PsmXk9wxiX1IkoYzdNAneTTJxSSnV7QfSHIuyWKS4wCttb9vrX0S+B3gt8baY0nSuqznG/1jwIH+hiTbgIeAg8A+4HCSfX2L/En3viRpSoYO+tba88DbK5r3A4uttfOttXeAJ4C70/NZ4NnW2r+Mr7uSpPUatUa/C3i97/VS1/YHwK8A9yS5b7UVkxxNcirJqUuXLo3YDUnSINtHXD+rtLXW2oPAg2ut2FpbABYA5ubm2oj9kCQNMOo3+iXgxr7Xu4E3RtymJGmMRg36l4Cbk+xNcg1wCHh62JW9laAkTd56plc+DrwA3JJkKcmR1tq7wDHgJHAWeLK1dmbYbXorQUmavKFr9K21wwPaTwAnNrLzJPPA/Ozs7EZWlyQNwZuDS1Jx/taNJBVn0EtScVMNemfdSNLkWaOXpOIs3UhScZZuJKk4SzeSVJylG0kqzqCXpOIMekkqzpOxklScJ2MlqThLN5JUnEEvScUZ9JJUnCdjJak4T8ZKUnGWbiSpOINekooz6CWpOINekooz6CWpOKdXSlJxTq+UpOIs3UhScQa9JBVn0EtScQa9JBVn0EtScQa9JBVn0EtScdunufMk88D87OzsNLuxYTPHn5nKfi88cNdU9itpa/KCKUkqztKNJBVn0EtScQa9JBVn0EtScQa9JBVn0EtScQa9JBVn0EtScQa9JBVn0EtScQa9JBU39qBPclOSLyR5atzbliSt31BBn+TRJBeTnF7RfiDJuSSLSY4DtNbOt9aOTKKzkqT1G/Yb/WPAgf6GJNuAh4CDwD7gcJJ9Y+2dJGlkQwV9a+154O0VzfuBxe4b/DvAE8DdY+6fJGlEo9TodwGv971eAnYl+UCSh4EPJbl/0MpJjiY5leTUpUuXRuiGJGkto9xhKqu0tdbavwP3XWnl1toCsAAwNzfXRuiHJGkNo3yjXwJu7Hu9G3hjPRtIMp9kYXl5eYRuSJLWMkrQvwTcnGRvkmuAQ8DT69mAtxKUpMkbdnrl48ALwC1JlpIcaa29CxwDTgJngSdba2cm11VJ0kYMVaNvrR0e0H4COLHRnSeZB+ZnZ2c3uglJ0hVM9ScQLN1I0uT5WzeSVNwo0ytHZulmY2aOPzO1fV944K6p7VvSxli6kaTiLN1IUnEGvSQVN9Wg98pYSZo8a/SSVJylG0kqzqCXpOKs0UtScdboJak4SzeSVJxBL0nFGfSSVJwnYyWpOE/GSlJxlm4kqTiDXpKKM+glqTiDXpKKM+glqTjvGastYVr3yfUeuarA6ZWSVJylG0kqzqCXpOIMekkqzqCXpOIMekkqzqCXpOIMekkqzqCXpOK8MlbSD71pXXkNm3P1tVfGSlJxlm4kqTiDXpKKM+glqTiDXpKKM+glqTiDXpKKM+glqTiDXpKKM+glqTiDXpKKG/tv3SR5H/AXwDvAc621L457H5Kk4Q31jT7Jo0kuJjm9ov1AknNJFpMc75o/BjzVWvsk8NEx91eStE7Dlm4eAw70NyTZBjwEHAT2AYeT7AN2A693i31vPN2UJG3UUEHfWnseeHtF835gsbV2vrX2DvAEcDewRC/sh96+JGlyRqnR7+L739yhF/AfBh4EPpfkLuArg1ZOchQ4CrBnz54RuqHNNM3f7f5hM63/1pvx++jaXKMEfVZpa621/wY+caWVW2sLwALA3NxcG6EfkqQ1jFJaWQJu7Hu9G3hjPRtIMp9kYXl5eYRuSJLWMkrQvwTcnGRvkmuAQ8DT69mAd5iSpMkbdnrl48ALwC1JlpIcaa29CxwDTgJngSdba2cm11VJ0kYMVaNvrR0e0H4COLHRnXtzcEmaPG8OLknFOc9dkoqbatA760aSJs/SjSQVl9amf61SkkvAd8a4yR3AW2Pc3tWg4pjAcW0lFccEW3tcP91a++CVFroqgn7ckpxqrc1Nux/jVHFM4Li2kopjgrrj6ufJWEkqzqCXpOKqBv3CtDswARXHBI5rK6k4Jqg7rv9XskYvSfq+qt/oJUmdUkE/4B62V50kF5J8M8krSU51bTck+cckr3V/r+/ak+TBbkyvJrm1bzv3dsu/luTevvaf77a/2K272r0DRh3DD9xHeDPGMGgfEx7XZ5L8W3e8XklyZ99793d9PJfk1/raV/0sdr/2+mLX/y91v/xKkmu714vd+zNjHNONSb6W5GySM0n+sGvf0sdrjXFt6eM1Ea21Eg9gG/Bt4CbgGuAbwL5p92tAXy8AO1a0/SlwvHt+HPhs9/xO4Fl6N3q5DXixa78BON/9vb57fn333teB27t1ngUOTmAMHwFuBU5v5hgG7WPC4/oM8MerLLuv+5xdC+ztPn/b1vosAk8Ch7rnDwOf6p7/HvBw9/wQ8KUxjmkncGv3/P3At7q+b+njtca4tvTxmsRj6h0Y40G/HTjZ9/p+4P5p92tAXy/wg0F/DtjZPd8JnOuePwIcXrkccBh4pK/9ka5tJ/Cvfe3vWW7M45jhvYE48TEM2seExzUoON7zGaP3k923D/osdiH4FrB95Wf28rrd8+3dcpnQcfsy8KtVjtcq4yp1vMbxqFS6We0etrum1JcracA/JHk5vXvnAvxUa+1NgO7vT3btg8a1VvvSKu2bYTPGMGgfk3asK2M82ld+WO+4PgD8R+vdy6G//T3b6t5f7pYfq67E8CHgRQodrxXjgiLHa1wqBf2q97Dd9F4M5xdba7cCB4HfT/KRNZYdNK71tk/TVh/DXwI/A/wc8CbwZ137OMc18TEn+XHgb4A/aq3951qLDujLVXm8VhlXieM1TpWCfuR72G6W1tob3d+LwN8B+4HvJtkJ0P292C0+aFxrte9epX0zbMYYBu1jYlpr322tfa+19r/A5+kdL1j/uN4CfiLJ9hXt79lW9/51wNvjGkOSH6UXhl9srf1t17zlj9dq46pwvMatUtCPfA/bzZDkfUnef/k5cAdwml5fL89iuJdevZGu/ePdTIjbgOXun8AngTuSXN/90/QOevXDN4H/SnJbN/Ph433bmrTNGMOgfUzM5aDq/Aa943W5L4e6GRh7gZvpnZRc9bPYegXdrwH3rNL//nHdA/xTt/w4+h/gC8DZ1tqf9721pY/XoHFt9eM1EdM+STDOB73ZAt+idwb909Puz4A+3kTvrP43gDOX+0mvvvdV4LXu7w1de4CHujF9E5jr29bvAovd4xN97XP0PtzfBj7HBE4SAY/T+2fx/9D7dnNkM8YwaB8THtdfdf1+ld7/4Dv7lv9018dz9M1uGvRZ7I7/17vx/jVwbdf+Y93rxe79m8Y4pl+iV1Z4FXile9y51Y/XGuPa0sdrEg+vjJWk4iqVbiRJqzDoJak4g16SijPoJak4g16SijPoJak4g16SijPoJam4/wP1xeGmQqGBowAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "temp = data.groupby(['CustomerID',])['TotalRevenue'].apply(sum).reset_index(drop=False)\n",
    "plt.hist(temp.TotalRevenue);plt.yscale('log');plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# different scales, from the following, hence use log scale"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(array([4.31e+03, 1.20e+01, 3.00e+00, 1.00e+00, 0.00e+00, 2.00e+00]), array([     0,  50000, 100000, 150000, 200000, 250000, 300000]), <a list of 6 Patch objects>)\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAnMAAAKECAYAAABsJ7yvAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvIxREBQAAIABJREFUeJzs3XmcV2X9///HCxAQEAFZRAVxV1wSJTUjG0BFsdBUNNME4yeWWtpyK5cU1PSr3z6Zlkm5oLhn7mYupGBf3FLcPpqpCCjgAoKKS7Jevz/eZ4ZhnHnPGZoZ5ujjfru9b+ec61znnNdgfzw751znipQSkiRJKqZWa7sASZIkrTnDnCRJUoEZ5iRJkgrMMCdJklRghjlJkqQCM8xJkiQVmGFOkiSpwAxzkiRJBWaYkyRJKjDDnCRJUoG1WdsFNJfu3bunfv36re0yJEmS6jV9+vR3U0o98vT9woS5fv368dRTT63tMiRJkuoVEa/n7etjVkmSpAIzzEmSJBWYYU6SJKnADHOSJEkFZpiTJEkqMMOcJElSgRnmJEmSCswwJ0mSVGCGOUmSpAIzzEmSJBWYYU6SJKnADHOSJEkFZpiTJEkqMMOcJElSgRnmJEmSCsww10RuvPFGIoKI4OSTT65q/93vfseWW27JuuuuS+fOnRk4cCA333xz1f558+YxfPhwunXrVnV8TQsXLuS73/0uXbt2pWPHjuy33368/PLLZetZuHAhP/7xj9liiy1o164dvXr14oADDuDpp59ulL+3stbZs2c3yvkkSVI+hrkmMHfuXI4//njatGnzmX2zZs1ihx124JhjjmHAgAFMnz6dI444ghkzZgDw7rvv8uqrrzJw4MA6z3/kkUdy3XXXse222zJ06FDuv/9+hg0bxtKlS2vtP3/+fL785S9z0UUX8f7773PooYdSUVHB008/zT/+8Y/G+aNbsOXLl6/tEiRJajoppS/Eb9ddd03NYeXKlWnIkCGpf//+6fDDD09AOumkk+rsu/766ycgPfjgg6vte+aZZxKQSv+JPtverVu3tGTJkpRSSoMGDUpAuuqqq2q9znHHHZeA1KNHjzR37tyq9v/85z9p5syZKaWUNt100wSkKVOmpJRSuuqqqxKQvv71r6eUUlq0aFE69NBD0wYbbJDatWuX+vXrl8aOHZtSSlV1Vv9NmTIlrVy5Mv3pT39KO+ywQ+rQoUPaYost0umnn57+85//pJRSmjJlSgLS+uuvny644ILUpUuX1Ldv33T//fenP/zhD6l79+6pd+/eadKkSVU1f/zxx+kXv/hF2mKLLVKHDh3SgAED0u233161f9SoUQlIY8eOTXvvvXdaZ5110pQpU9IDDzyQdtlll9ShQ4fUuXPnNGDAgHTrrbeW+08pSdJaAzyVcmYc78w1sosuuohp06Zx/fXX0759+1r73Hffffzwhz+koqKCDz74gEGDBjFo0KBc53/mmWcA2GmnnWjbti1A1V28Z599ttZj7r77bgDGjBnDxhtvXNXevn17Nttss1zX/c1vfsMtt9zCVlttxTHHHMN2223Ho48+CsBJJ51U1e+YY47hpJNOYpNNNmHChAkcd9xxzJkzh8MPP5zly5dz7rnnrtYfYPHixVx33XXssssuvPHGG4wcOZLzzz+fvfbai7feeosf/OAHfPDBB1V/wwUXXMD666/PIYccwpw5czj44IOZOnXqaue87LLLWLZsGUcddRSdO3fmmGOO4bnnnuOQQw7hkEMOoVWrVrzwwgu5/nZJklqyzz4H1Bp74YUXOPXUUzn77LPZeeed6+z3+OOPc8kllwClQDV8+HDWWWedXNd45513AOjUqVNVW8eOHQF4++23az1m/vz5AGy66aa5rlGbZcuWAbD77rvzne98h/79+7PuuusCpQB78cUXA3DmmWfSr18/AEaMGAHAxRdfzKhRo3juuefYeeedueKKK6r6Q+nu8N/+9jeWL1/OZpttxuLFi7nxxhsZPnw43bt3Z+HChbzyyiv069ePm266iVatWrHnnnvSunVrtt9+ex5++GH++Mc/UlFRUXXOvfbaa7WAt2zZMtq3b8+IESPYcccd2WqrrSj9Hx9JkorNO3ON6NZbb2Xp0qU8/PDDfOMb3+DBBx8E4K677uLUU0+t6jd+/HiWLVvGc889R8+ePTnttNO44YYbcl2jV69eAHz00UdVbZXrG264Ya3H9OzZE4DXX38999+yYsWK1bZPPvlkhg0bxqWXXsruu+9Oly5dOProo1m5cmWd56gcDLHddtsBsO222wKwcuVK5syZU9WvU6dObLLJJnTp0qWqbZtttqnaB/Dxxx9XnW/lypVccsklXHzxxTz88MMAVe8cVtpzzz1X2/7Tn/5E7969GTlyJNtuuy09e/bkL3/5S65/C0mSWjLDXCOqfHZ97733cs899zB37lygNOjhscceA+DDDz8EoE2bNuy0005VAeeVV17JdY3KO37PPfccS5YsAeDJJ58E4Etf+lKtx3zjG98A4Morr2TevHlV7UuXLuWNN94AVt3dW7x4McBnHkF269aN++67jw8//JDnnnuO7bffnhtuuIFHHnkEgFatSv9Tqh7uKu/Q/fvf/waoGnHbqlUr+vTpU9WvdevWn6m5trbK87Vt25YFCxZU/XsvXbqU22+/fbW+7dq1W217//3359VXX+Xdd9/llltuYeHChZx++umfuYYkSUVjmGtE48ePX+2FxFGjRgGld8oqH/ltuOGGjBgxgh/84AfsvffePPDAA7Rq1Yp99tkHKI1mHT16NGeeeWbVeUePHs3o0aMBGDBgAPvssw/vvfceFRUVfPOb3+TRRx+lT58+fOc736m1rrPOOotNN92UBQsWsNNOO3HUUUdx5JFHsuWWW3LbbbdVnRfgl7/8JSeddBKXXnrpauc4//zz2XXXXTnuuOO45JJLqu6Srb/++gBV4ezEE0/k5JNP5uOPP+aEE06o+vvHjBnDgQceCJTee6vrfcJyevTowWGHHcbSpUvZfffd+f73v8/IkSPp06cPV155ZdljBwwYwPDhwzn99NOZOHEiwGp3AiVJKirfmWtE/U65Z7Xtd6eX7sxNnDaLO7J9aeOd+NuUR1jxyWJatetAuz470Hm3gznqrx/AX+9h+QfvMG/SpNXOMynbnrrhSABWbDuaDvOW8sQzT8GK5bTvN4AVe49lm3F/r7O2FSPOY71Hb2LxjH9y/Y1/plW7DrTtvRUXPBtcdMo9LF9vCO02ms4L/36VV95bQbsvDWfpk3fw+MyF9DvlHj6ZsYIP3vqIZ168hbR8KW0696Dr3kcw4oY5cMMcPv7S4bReNJF7772Pe++9l1tX7kardTel277H8+HTf+Wqa66ndaeudN5jJPettx/9TrmHT994HoDFny6n3yn3sPLTj+qsv9KVV17J5ptvzi233MLVV19Nt27d+MpXvsJ+++1X9ri9996be+65hylTptC2bVsqKiq48MIL672eJEktXXxRXgIfOHBgeuqpp5r0GjXDnNbM7PMPWNslSJK0VkXE9JRS3R+drcbHrJIkSQVmmJMkSSoww5wkSVKB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RwF3Vms/OhvVugfwQfYY9n5g34jomg182DdrkyRJ+sJp05wXi4gbgQqge0TMpTQq9Xzg5ogYA7wBjMy6/w0YDswAPgGOAUgpLYqIc4Ans35np5RqDqqQJEn6QmjWMJdSOqKOXUNr6ZuAE+o4z0RgYiOWJkmSVEgt4TGrJEmS1pBhTpIkqcAMc5IkSQVmmJMkSSoww5wkSVKBGeYkSZIKzDAnSZJUYIY5SZKkAjPMSZIkFZhhTpIkqcAMc2qRLrroInbaaSdat25NRDB+/PjV9t9444187Wtfo0ePHnTo0IEddtiBiRPrn+Ht7rvvZujQoXTp0oUOHTqw3XbbceaZZzZKzePHjyciGD16dKOcT5KkPAxzapGmT59Ot27d6NOnT63777//fmbOnMmwYcMYNGgQL774ImPGjOHuu++u85y//vWvGTFiBA899BDbb789Rx55JD169OCSSy5pqj+jxVi2bNnaLkGS1EQMc2qRrr32WqZOncrOO+9c6/4TTzyRWbNmcd111/HAAw/w9a9/HYDJkyfX2n/OnDmcfvrpAJx66qk88sgjXH755fzjH//gkUceAeDqq68mIqioqKg6rl+/fkQEU6dOBeCGG26gf//+rLvuunTr1o2vfOUrTJs2jfHjx3PWWWcBMGnSpNXOM3v2bEaOHEnv3r3p2rUrgwcP5oknnqi6RkVFBRHBySefzFe+8hU6dOjAEUccwaxZsxg8eDAdO3Zkv/32Y9GiRVXHTJs2jYqKCrp27cpGG23E9773PRYuXFh1vYggIvjjH//IRhttxL777svSpUs59thj2XDDDWnXrh19+vRhxIgRDfwvI0lqaQxzKqSBAwfStm3bqu2lS5cCsMkmm9Ta/7777mPZsmW0atWKX/7yl6vt22677XJd8z//+Q+jR4/m9ddf58gjj+SAAw5g8eLFvPbaa+yxxx7svvvuVec76aSTOPTQQ/n4448ZMmQIt9xyC1tvvTVDhgxh6tSpDBkyhNdee2218//hD39gyy23ZJ111uGmm25iwIABrL/++vTo0YP777+fCy+8EIAXXniBoUOHMn36dPbbbz+23nprrrrqKkaOHElKabVznn766ey///7sueeeXHPNNVxxxRV0796dMWPGsOuuu1YFWUlScbVZ2wVI/60LL7yQxx57jC233JLvf//7tfaZP38+QNU7dmtixYoVrFixgp49e3LQQQfRv39/Nt98c1asWEHr1q15/PHHeeKJJ9htt9246KKLALj55puZNWsWm2++OVOnTiUi+Na3vsUdd9zBlVdeyXnnnVd1/lGjRnHFFVcwevRoJk2axNZbb80dd9zB73//e370ox/xzDPPADBhwgSWLl3KgAED6NWrF7169eLxxx9nypQpvPzyy7Rv377qnH/5y18YMmRI1XEAO+64I0ceeST9+/enc+fOa/RvIUlqObwzp0I766yz+OlPf8rmm2/Ogw8+WGc46dmzJwALFizgk08+yX3+FStWVK136tSJCRMmkFLim9/8JltssQV9+vTh//2//1fn8bNnzwZgm222ISIA2HbbbQF4/fXXV+tbeYewS5cuVccArLfeegB8/PHHq53ziSee4OKLL+biiy9myZIlAMyYMWO1c371q1+tWj/66KM57LDDuPPOOxk0aBAbbLAB+++/f9V5JUnFZJhTIa1cuZLjjz+e8ePHM2DAAB555BH69u1bZ/9hw4bRpk0bVq5cybnnnrvavldffRWAjh07ArB48WIAFi5cyNtvv71a31GjRjFv3jzefPNNLr74YubOncs555wDQOvWratqq9SvXz8AXnnllapHoC+//DIAm2666Wrnrjy+ru2a5/zJT35CSqnqN3PmTL7xjW+s1rddu3ZV623atOHPf/4zixcv5qWXXmLvvfdm8uTJ3HbbbbVeR5JUDD5mVYt0xRVXMG3aNJ5++mkA7rjjDmbPns1BBx3EQQcdxBlnnMGECRNo1aoVAwYM4Pzzzwdgyy235MQTT/zM+fr27cs555zDqaeeynnnncfUqVPZfvvtmTlzJs888wwLFy7kS1/6EhHBs88+ywknnMBTTz3F8uXLVztPr169qKioYKONNuJ///d/gVV30ipH3t5777388Ic/pKKiggMOOIB+/frx2muvMXjwYLp3787tt9/Ouuuuy/e+9701+rcZO3Ysl19+ORdffDEzZ86ke/fuvPTSSzz66KOrBcmabrzxRi644AIGDhxIp06dPlO/JKmYouYL059XAwcOTE899VSTXqPfKfc06fm/SN6957d8/MKDn2lf/6tH0GXQkXXub9dnBzb8zvl1nveTVx9n8VN3svTt12Dlclp37knHbQfR5WtHAfDBE7ew+InbiNbr0GnHvfnoxYdYsXgBvY44j/Z9d2LB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\n",
      "text/plain": [
       "<Figure size 720x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#ignoring customers who causes losses because they are small portion of revenue\n",
    "bins=range(0,300001,50000)\n",
    "xx=plt.hist(temp['TotalRevenue'],bins=bins)\n",
    "print xx\n",
    "plt.close()\n",
    "plt.subplots(figsize=(10,10))\n",
    "xxx=plt.hist(temp['TotalRevenue'],weights = temp['TotalRevenue'].values/1000, bins=bins)\n",
    "for i in range(len(xxx[1])-1):\n",
    "    plt.text(xxx[1][i],xxx[0][i]+0.03,str(int(xx[0][i]))+' Customers',fontsize=12,fontweight='bold')\n",
    "plt.xticks(np.array(bins)+25000,['Spent\\n' + str(bins[x]/1000)+'k-'+str(bins[x+1]/1000)+'k' for x in  range(len(bins)-1)],rotation=60)\n",
    "plt.xlabel('Spending',fontsize=15,fontweight='bold')\n",
    "plt.ylabel('Contribution to Revenue in Millions',fontsize=15,fontweight='bold')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "#combine certain stock types which are obviously simillar differetn colour t-shirts\n",
    "def f(x):\n",
    "    if  x[:-1].isdigit() and x[-1].isdigit() is False:\n",
    "        return x[:-1]\n",
    "    else : return x\n",
    "data['StockCode_NR'] = data['StockCode'].apply(f)\n",
    "\n",
    "#returns cost 0.1%, so ignore first\n",
    "data = data[data['TotalRevenue']>0].reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 Top 0.01 percent of customers,3.0 percent of profit\n",
      "4 Top 0.1 percent of customers,12.0 percent of profit\n",
      "43 Top 1 percent of customers,32.0 percent of profit\n",
      "86 Top 2 percent of customers,39.0 percent of profit\n",
      "216 Top 5 percent of customers,50.0 percent of profit\n",
      "433 Top 10 percent of customers,61.0 percent of profit\n",
      "867 Top 20 percent of customers,75.0 percent of profit\n",
      "2169 Top 50 percent of customers,92.0 percent of profit\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# are there any subgroups of important customer\n",
    "temp = data.groupby(['CustomerID',])['TotalRevenue'].apply(sum).reset_index(drop=False)\n",
    "temp2 = temp.sort_values('TotalRevenue').iloc[::-1].reset_index(drop=True)\n",
    "result,val = [] ,0\n",
    "for i in range(len(temp2)):\n",
    "    val += temp2.iloc[i]['TotalRevenue']\n",
    "    result += [val,]\n",
    "temp2['cummulative_profit'] = np.array(result)/val\n",
    "for i in [0.01,0.1,1,2,5,10,20,50]:\n",
    "    num = int(len(temp2)*1.*i/100)\n",
    "    print num,\n",
    "    print 'Top %s percent of customers,%s percent of profit'%(i,100*np.round(temp2.loc[num]['cummulative_profit'],2))\n",
    "plt.plot(temp2['cummulative_profit']);plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 Top 0.01 percent of products,2.0 percent of profit\n",
      "3 Top 0.1 percent of products,5.0 percent of profit\n",
      "32 Top 1 percent of products,14.000000000000002 percent of profit\n",
      "64 Top 2 percent of products,22.0 percent of profit\n",
      "160 Top 5 percent of products,37.0 percent of profit\n",
      "320 Top 10 percent of products,51.0 percent of profit\n",
      "640 Top 20 percent of products,70.0 percent of profit\n",
      "1600 Top 50 percent of products,91.0 percent of profit\n",
      "1920 Top 60 percent of products,94.0 percent of profit\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2677\n",
      "threshold= 10 , 0.84 of products account for 0.975 of revenue\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# are there any subgroups of important customer\n",
    "temp = data.groupby(['StockCode_NR'])['TotalRevenue'].apply(sum).reset_index(drop=False)\n",
    "temp['num_times_brought'] = data.groupby(['StockCode_NR'])['TotalRevenue'].apply(len).reset_index(drop=True)\n",
    "temp2 = temp.sort_values('num_times_brought').iloc[::-1].reset_index(drop=True)\n",
    "\n",
    "result,val = [0,] ,0\n",
    "for i in range(len(temp2)):\n",
    "    val += temp2.iloc[i]['TotalRevenue']\n",
    "    result += [val,]\n",
    "temp2['cummulative_profit'] = np.array(result[1:])/val\n",
    "temp2['Total_profit'] = (np.array(result[1:])-np.array(result[:-1]))/val\n",
    "for i in [0.01,0.1,1,2,5,10,20,50,60]:\n",
    "    num = int(len(temp2)*1.*i/100)\n",
    "    print num,\n",
    "    print 'Top %s percent of products,%s percent of profit'%(i,100*np.round(temp2.loc[num]['cummulative_profit'],2))\n",
    "plt.plot(temp2['cummulative_profit']);plt.show()\n",
    "x = 10\n",
    "print np.sum(temp2['num_times_brought']>x)\n",
    "print 'threshold=',x,',',np.round(np.mean(temp2['num_times_brought']>x),2),'of products account for',\n",
    "print np.round(np.sum(temp2[temp2['num_times_brought']>x]['TotalRevenue'])/np.sum(temp2['TotalRevenue']),3),'of revenue\\n\\n'\n",
    "temp3 = temp2[temp2['num_times_brought']>x]\n",
    "data2 = pd.merge(data,temp3[['StockCode_NR','num_times_brought','Total_profit']]\n",
    "         ,on='StockCode_NR',how='inner')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info = data.groupby(['CustomerID',])['TotalRevenue'].apply(sum).reset_index(drop=False)\n",
    "customer_info = customer_info.sort_values('TotalRevenue').iloc[::-1].reset_index(drop=False)\n",
    "\n",
    "for year in pd.unique(data.Year):\n",
    "    for month in sorted(map(int,pd.unique(data.Month))):\n",
    "        temp0  =  data2[(data2.Year==year) & (data2.Month==month)]\n",
    "        if len(temp0) == 0:\n",
    "            continue\n",
    "        temp = temp0.groupby(['CustomerID',])['TotalRevenue'].apply(sum).reset_index(drop=False)\n",
    "        temp2 = temp.sort_values('TotalRevenue').iloc[::-1].reset_index(drop=True)\n",
    "        result,val = [] ,0\n",
    "        for i in range(len(temp2)):\n",
    "            val += temp2.iloc[i]['TotalRevenue']\n",
    "            result += [val,]\n",
    "        temp2['cummulative_profit'] = np.array(result)/val\n",
    "        temp2.rename(columns={'TotalRevenue' : 'Revenue_%s_%s'%(year,month)},inplace=True)\n",
    "        customer_info = pd.merge(customer_info,temp2[temp2.keys()[:2]],on='CustomerID',how='left').fillna(0)\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2677\n"
     ]
    }
   ],
   "source": [
    "dictt_StockCode = {}\n",
    "counter = 0\n",
    "for i in data2.groupby(['num_times_brought','StockCode_NR']).apply(len).reset_index(drop=False)['StockCode_NR'].iloc[::-1]:\n",
    "    dictt_StockCode[i] = counter\n",
    "    counter += 1\n",
    "data2['StockCode_NR_int'] = data2['StockCode_NR'].map(dictt_StockCode)\n",
    "print counter"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/leexiongan/anaconda3/envs/python27/lib/python2.7/site-packages/pandas/core/computation/expressions.py:183: UserWarning: evaluating in Python space because the '*' operator is not supported by numexpr for the bool dtype, use '&' instead\n",
      "  .format(op=op_str, alt_op=unsupported[op_str]))\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(115837, 28156, 27028, 26685, 53713, 234170)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train = data2[((data2['Year']==2010)*(data2['Month'].isin([12,]))) | \\\n",
    "              ((data2['Year']==2011)*(data2['Month'].isin([1,2,3,4])))]\n",
    "test = data2[ ((data2['Year']==2011)*(data2['Month'].isin([5])))]\n",
    "test2 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([6,])))]\n",
    "test3 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([7,])))]\n",
    "test4 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([6,7,])))]\n",
    "test5 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([6,7,8,9,10,11])))]\n",
    "\n",
    "len(train),len(test),len(test2),len(test3),len(test4),len(test5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "#get all orders from customer during time period \n",
    "Invoice = train.groupby(['CustomerID',]).apply(lambda x :(list(x['StockCode_NR_int']),\n",
    "                                                         list(x['Quantity']))).reset_index(drop=0)\n",
    "#print Invoice.head()\n",
    "customer_info_orders = pd.merge(customer_info,Invoice,on='CustomerID',how='outer')\n",
    "customer_info_orders.rename(columns={0 : 'orders'},inplace=True)\n",
    "\n",
    "Invoice_future = test.groupby(['CustomerID',]).apply(lambda x :(list(x['StockCode_NR_int']),\n",
    "                                                         list(x['Quantity']))).reset_index(drop=0)\n",
    "#print Invoice.head()\n",
    "customer_info_orders = pd.merge(customer_info_orders,Invoice_future,on='CustomerID',how='outer')\n",
    "customer_info_orders.rename(columns={0 : 'orders_future'},inplace=True)\n",
    "\n",
    "Invoice_future = test2.groupby(['CustomerID',]).apply(lambda x :(list(x['StockCode_NR_int']),\n",
    "                                                         list(x['Quantity']))).reset_index(drop=0)\n",
    "#print Invoice.head()\n",
    "customer_info_orders = pd.merge(customer_info_orders,Invoice_future,on='CustomerID',how='outer')\n",
    "customer_info_orders.rename(columns={0 : 'orders_future2'},inplace=True)\n",
    "\n",
    "Invoice_future = test3.groupby(['CustomerID',]).apply(lambda x :(list(x['StockCode_NR_int']),\n",
    "                                                         list(x['Quantity']))).reset_index(drop=0)\n",
    "#print Invoice.head()\n",
    "customer_info_orders = pd.merge(customer_info_orders,Invoice_future,on='CustomerID',how='outer')\n",
    "customer_info_orders.rename(columns={0 : 'orders_future3'},inplace=True)\n",
    "\n",
    "Invoice_future = test4.groupby(['CustomerID',]).apply(lambda x :(list(x['StockCode_NR_int']),\n",
    "                                                         list(x['Quantity']))).reset_index(drop=0)\n",
    "#print Invoice.head()\n",
    "customer_info_orders = pd.merge(customer_info_orders,Invoice_future,on='CustomerID',how='outer')\n",
    "customer_info_orders.rename(columns={0 : 'orders_future4'},inplace=True)\n",
    "\n",
    "Invoice_future = test5.groupby(['CustomerID',]).apply(lambda x :(list(x['StockCode_NR_int']),\n",
    "                                                         list(x['Quantity']))).reset_index(drop=0)\n",
    "#print Invoice.head()\n",
    "customer_info_orders = pd.merge(customer_info_orders,Invoice_future,on='CustomerID',how='outer')\n",
    "customer_info_orders.rename(columns={0 : 'orders_future5'},inplace=True)\n",
    "\n",
    "customer_info_orders = customer_info_orders.sort_values('CustomerID').reset_index(drop=True)\n",
    "#print customer_info_orders"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>CustomerID</th>\n",
       "      <th>TotalRevenue</th>\n",
       "      <th>Revenue_2010_12</th>\n",
       "      <th>Revenue_2011_1</th>\n",
       "      <th>Revenue_2011_2</th>\n",
       "      <th>Revenue_2011_3</th>\n",
       "      <th>Revenue_2011_4</th>\n",
       "      <th>Revenue_2011_5</th>\n",
       "      <th>Revenue_2011_6</th>\n",
       "      <th>...</th>\n",
       "      <th>Revenue_2011_9</th>\n",
       "      <th>Revenue_2011_10</th>\n",
       "      <th>Revenue_2011_11</th>\n",
       "      <th>Revenue_2011_12</th>\n",
       "      <th>orders</th>\n",
       "      <th>orders_future</th>\n",
       "      <th>orders_future2</th>\n",
       "      <th>orders_future3</th>\n",
       "      <th>orders_future4</th>\n",
       "      <th>orders_future5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>12346.0</td>\n",
       "      <td>77183.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>77183.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([598], [74215])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>12347.0</td>\n",
       "      <td>4310.00</td>\n",
       "      <td>674.29</td>\n",
       "      <td>475.39</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>636.25</td>\n",
       "      <td>0.00</td>\n",
       "      <td>382.52</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1294.32</td>\n",
       "      <td>0.00</td>\n",
       "      <td>224.82</td>\n",
       "      <td>([1490, 1490, 77, 77, 25, 25, 40, 40, 138, 519...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...</td>\n",
       "      <td>([77, 25, 25, 25, 40, 138, 138, 111, 283, 101,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>12348.0</td>\n",
       "      <td>1797.24</td>\n",
       "      <td>892.80</td>\n",
       "      <td>227.44</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>367.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>310.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([10, 10, 10, 67, 67, 65, 65, 439, 128, 128, 1...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([10, 312, 549], [1, 120, 96])</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>12349.0</td>\n",
       "      <td>1757.55</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1757.55</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([30, 81, 10, 293, 637, 103, 103, 510, 340, 45...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>12350.0</td>\n",
       "      <td>334.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>334.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([10, 1019, 100, 217, 1120, 133, 90, 1114, 120...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>12352.0</td>\n",
       "      <td>2506.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>296.50</td>\n",
       "      <td>1265.31</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>632.50</td>\n",
       "      <td>0.00</td>\n",
       "      <td>311.73</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([62, 95, 426, 10, 10, 365, 946, 819, 522, 522...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([95, 426, 111, 10, 10, 10, 946, 946, 819, 819...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>12353.0</td>\n",
       "      <td>89.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>89.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([781, 813, 1162, 837], [8, 2, 6, 4])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>12354.0</td>\n",
       "      <td>1079.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1079.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([532, 81, 56, 410, 246, 111, 7, 6, 293, 900, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>12355.0</td>\n",
       "      <td>459.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>459.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([526, 526, 526, 2, 42, 58, 744, 837, 478, 93,...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>12356.0</td>\n",
       "      <td>2811.43</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2271.62</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>481.46</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>58.35</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([10, 278, 14, 65, 65, 365, 510, 49, 340, 303,...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([2, 176], [2, 3])</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>12357.0</td>\n",
       "      <td>6207.67</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6182.47</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([72, 72, 219, 77, 25, 40, 386, 348, 125, 637,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>12358.0</td>\n",
       "      <td>1168.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>683.20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([10, 386, 348, 125, 125, 458, 91, 817, 813, 1...</td>\n",
       "      <td>([10, 386, 348, 125, 125, 458, 91, 817, 813, 1...</td>\n",
       "      <td>([10, 386, 348, 125, 125, 458, 91, 817, 813, 1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>12359.0</td>\n",
       "      <td>6372.58</td>\n",
       "      <td>0.00</td>\n",
       "      <td>547.50</td>\n",
       "      <td>1838.91</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1109.32</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2876.85</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([532, 62, 95, 30, 1284, 916, 426, 116, 202, 4...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([0, 82, 192, 770, 835, 2, 417, 102, 42, 175, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([0, 82, 192, 770, 835, 2, 417, 102, 42, 175, ...</td>\n",
       "      <td>([77, 25, 40, 0, 0, 0, 44, 80, 1099, 193, 82, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>12360.0</td>\n",
       "      <td>2662.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1083.58</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1043.78</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([81, 283, 10, 7, 7, 278, 168, 273, 1483, 49, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([324, 81, 81, 10, 10, 7, 7, 7, 7, 168, 168, 2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>12361.0</td>\n",
       "      <td>189.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>189.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([81, 56, 410, 10, 6, 18, 35, 150, 75, 156], [...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>12362.0</td>\n",
       "      <td>5226.23</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>479.10</td>\n",
       "      <td>0.00</td>\n",
       "      <td>495.24</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>829.99</td>\n",
       "      <td>1641.91</td>\n",
       "      <td>419.44</td>\n",
       "      <td>529.04</td>\n",
       "      <td>([56, 56, 1318, 10, 10, 6, 168, 79, 18, 35, 12...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 81, 10, 36, 43, 133, 90, 85, 2, 541, 334...</td>\n",
       "      <td>([25, 81, 10, 36, 43, 133, 90, 85, 2, 541, 334...</td>\n",
       "      <td>([77, 77, 25, 25, 25, 40, 40, 81, 81, 81, 81, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>12363.0</td>\n",
       "      <td>552.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>299.10</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([14, 67, 65, 303, 128, 113, 96, 350, 251, 503...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([225, 136, 336, 742, 490, 263, 220], [12, 36,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>12364.0</td>\n",
       "      <td>1313.10</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>79.80</td>\n",
       "      <td>299.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>310.32</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([10, 10, 10, 278, 278, 14, 67, 65, 49, 49, 34...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>12365.0</td>\n",
       "      <td>641.38</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>641.38</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([1058, 929, 1501, 258, 2667, 2, 1663, 104, 42...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>12367.0</td>\n",
       "      <td>168.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>168.90</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>20</td>\n",
       "      <td>12370.0</td>\n",
       "      <td>3545.69</td>\n",
       "      <td>1851.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>837.11</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>739.28</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([1, 4, 281, 240, 178, 178, 178, 10, 64, 166, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([1, 4, 946, 819, 821, 153, 568, 767, 174, 126...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>21</td>\n",
       "      <td>12371.0</td>\n",
       "      <td>1887.96</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1887.96</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([72, 219, 281, 10, 6, 273, 36, 929, 1458, 106...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>22</td>\n",
       "      <td>12372.0</td>\n",
       "      <td>1298.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>399.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>515.70</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>383.12</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([138, 81, 56, 116, 410, 1585, 979, 10, 150, 7...</td>\n",
       "      <td>([81, 56, 10, 150, 75, 229, 90, 715, 114, 156,...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([81, 56, 116, 410, 10, 75, 90, 114, 156, 784,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>23</td>\n",
       "      <td>12373.0</td>\n",
       "      <td>364.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>364.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([81, 10, 0, 44, 35, 19, 155, 179, 150, 204, 1...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>24</td>\n",
       "      <td>12374.0</td>\n",
       "      <td>742.93</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>742.93</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([10, 123, 635, 106, 59, 718, 888, 605, 113, 1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>25</td>\n",
       "      <td>12375.0</td>\n",
       "      <td>457.50</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>230.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>227.20</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([10, 10, 0, 7, 7, 83, 226, 179, 142, 135, 87,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>26</td>\n",
       "      <td>12377.0</td>\n",
       "      <td>1628.12</td>\n",
       "      <td>1001.52</td>\n",
       "      <td>608.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([77, 25, 40, 81, 56, 116, 410, 1585, 1585, 97...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>27</td>\n",
       "      <td>12378.0</td>\n",
       "      <td>4008.62</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([281, 240, 916, 77, 40, 81, 56, 116, 410, 111...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>28</td>\n",
       "      <td>12379.0</td>\n",
       "      <td>852.24</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>459.84</td>\n",
       "      <td>...</td>\n",
       "      <td>392.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([116, 410, 10, 7, 273, 14, 49, 248, 229, 1133...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([116, 410, 10, 7, 273, 14, 49, 248, 229, 1133...</td>\n",
       "      <td>([81, 116, 410, 10, 10, 0, 7, 6, 273, 14, 49, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>29</td>\n",
       "      <td>12380.0</td>\n",
       "      <td>2724.81</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>607.55</td>\n",
       "      <td>...</td>\n",
       "      <td>626.01</td>\n",
       "      <td>450.86</td>\n",
       "      <td>1040.39</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([81, 10, 28, 0, 0, 131, 7, 7, 6, 182, 342, 18...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([81, 10, 28, 0, 0, 131, 7, 7, 6, 182, 342, 18...</td>\n",
       "      <td>([30, 1263, 81, 81, 81, 111, 111, 10, 10, 10, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4308</th>\n",
       "      <td>4308</td>\n",
       "      <td>18242.0</td>\n",
       "      <td>2232.49</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>694.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>1538.41</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([4, 30, 31, 450, 48, 1064, 129, 682, 738, 185...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([4, 77, 25, 40, 376, 7, 41, 450, 223, 204, 2,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4309</th>\n",
       "      <td>4309</td>\n",
       "      <td>18245.0</td>\n",
       "      <td>2567.06</td>\n",
       "      <td>365.73</td>\n",
       "      <td>439.18</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>501.38</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>894.25</td>\n",
       "      <td>([1, 30, 77, 40, 651, 22, 157, 124, 48, 48, 35...</td>\n",
       "      <td>([1, 406, 22, 48, 48, 113, 801, 1543, 1475, 26...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 293, 92, 1538, 801, 229, 541, 956, 467, ...</td>\n",
       "      <td>([25, 293, 92, 1538, 801, 229, 541, 956, 467, ...</td>\n",
       "      <td>([25, 293, 92, 1538, 801, 229, 541, 956, 467, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4310</th>\n",
       "      <td>4310</td>\n",
       "      <td>18246.0</td>\n",
       "      <td>596.10</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>232.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>363.20</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([406, 401], [60, 10])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([405, 401], [16, 80])</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4311</th>\n",
       "      <td>4311</td>\n",
       "      <td>18248.0</td>\n",
       "      <td>804.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>496.46</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([1, 14, 67, 623, 293, 167, 637, 49, 106, 2258...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([1, 14, 67, 623, 293, 167, 637, 49, 106, 2258...</td>\n",
       "      <td>([1, 14, 67, 623, 293, 21, 167, 637, 637, 49, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4312</th>\n",
       "      <td>4312</td>\n",
       "      <td>18249.0</td>\n",
       "      <td>95.34</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>95.34</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([605, 204, 1024, 1357, 34, 905, 696, 1872], [...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4313</th>\n",
       "      <td>4313</td>\n",
       "      <td>18250.0</td>\n",
       "      <td>349.27</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>349.27</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([532, 30, 283, 65, 31, 48, 171, 259, 2, 102, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4314</th>\n",
       "      <td>4314</td>\n",
       "      <td>18251.0</td>\n",
       "      <td>4314.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>4314.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([14, 101, 67, 65, 128, 113, 136, 127, 1047, 8...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4315</th>\n",
       "      <td>4315</td>\n",
       "      <td>18252.0</td>\n",
       "      <td>526.67</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>30.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>456.77</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([3, 1808], [4, 12])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([3, 1808], [4, 12])</td>\n",
       "      <td>([4, 123, 28, 83, 342, 405, 5, 5, 5, 510, 522,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4316</th>\n",
       "      <td>4316</td>\n",
       "      <td>18255.0</td>\n",
       "      <td>103.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>103.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([1, 110, 433, 66, 294, 1693], [6, 16, 6, 24, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4317</th>\n",
       "      <td>4317</td>\n",
       "      <td>18257.0</td>\n",
       "      <td>2337.63</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>363.80</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>357.40</td>\n",
       "      <td>214.40</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>774.76</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([30, 1240, 1284, 916, 0, 31, 124, 479, 43, 41...</td>\n",
       "      <td>([298, 449, 27, 396, 47, 69, 55, 172, 1877, 15...</td>\n",
       "      <td>([532, 28, 203, 47, 55, 26, 15, 144, 351, 1500...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([532, 28, 203, 47, 55, 26, 15, 144, 351, 1500...</td>\n",
       "      <td>([1, 178, 532, 28, 28, 0, 0, 7, 7, 6, 44, 41, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4318</th>\n",
       "      <td>4318</td>\n",
       "      <td>18259.0</td>\n",
       "      <td>2338.60</td>\n",
       "      <td>376.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>891.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1070.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([123, 39, 139, 59, 918, 308, 328], [8, 6, 24,...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([72, 151, 151, 219, 219, 123, 123, 130, 130, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4319</th>\n",
       "      <td>4319</td>\n",
       "      <td>18260.0</td>\n",
       "      <td>2643.20</td>\n",
       "      <td>230.70</td>\n",
       "      <td>557.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>548.75</td>\n",
       "      <td>451.58</td>\n",
       "      <td>427.97</td>\n",
       "      <td>427.13</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([1, 4, 4, 4, 1145, 64, 14, 67, 67, 65, 119, 1...</td>\n",
       "      <td>([4, 14, 157, 42, 176, 724, 3, 97, 57, 57, 93,...</td>\n",
       "      <td>([157, 119, 74, 432, 812, 243, 1264, 58, 218, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([157, 119, 74, 432, 812, 243, 1264, 58, 218, ...</td>\n",
       "      <td>([157, 119, 74, 432, 812, 243, 1264, 58, 218, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4320</th>\n",
       "      <td>4320</td>\n",
       "      <td>18261.0</td>\n",
       "      <td>324.24</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>224.80</td>\n",
       "      <td>99.44</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([22, 309, 174, 174, 301, 301, 169, 483, 431, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4321</th>\n",
       "      <td>4321</td>\n",
       "      <td>18262.0</td>\n",
       "      <td>149.48</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([6, 31, 128, 152, 476, 630, 454, 2088, 1681, ...</td>\n",
       "      <td>([6, 31, 128, 152, 476, 630, 454, 2088, 1681, ...</td>\n",
       "      <td>([6, 31, 128, 152, 476, 630, 454, 2088, 1681, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4322</th>\n",
       "      <td>4322</td>\n",
       "      <td>18263.0</td>\n",
       "      <td>1213.16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>307.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>401.76</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([138, 239, 192, 439, 53, 234, 669, 186, 384, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([632, 632, 1011, 939, 1302, 810, 1606, 2270, ...</td>\n",
       "      <td>([632, 632, 1011, 939, 1302, 810, 1606, 2270, ...</td>\n",
       "      <td>([632, 632, 154, 441, 53, 1011, 495, 939, 1302...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4323</th>\n",
       "      <td>4323</td>\n",
       "      <td>18265.0</td>\n",
       "      <td>801.51</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>312.96</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([14, 167, 277, 249, 129, 180, 43, 394, 2, 970...</td>\n",
       "      <td>([14, 167, 277, 249, 129, 180, 43, 394, 2, 970...</td>\n",
       "      <td>([4, 95, 109, 14, 82, 167, 277, 119, 249, 129,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4324</th>\n",
       "      <td>4324</td>\n",
       "      <td>18268.0</td>\n",
       "      <td>25.50</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([676], [2])</td>\n",
       "      <td>([676], [2])</td>\n",
       "      <td>([676], [2])</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4325</th>\n",
       "      <td>4325</td>\n",
       "      <td>18269.0</td>\n",
       "      <td>168.60</td>\n",
       "      <td>168.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([111, 1311, 1983, 918, 466, 173, 1732], [24, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4326</th>\n",
       "      <td>4326</td>\n",
       "      <td>18270.0</td>\n",
       "      <td>283.15</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>88.35</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>171.20</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([676, 94, 2633, 449], [3, 12, 6, 12])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([398, 828, 2255, 1815, 2304, 368], [12, 12, 8...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4327</th>\n",
       "      <td>4327</td>\n",
       "      <td>18272.0</td>\n",
       "      <td>3078.58</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>980.54</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>604.25</td>\n",
       "      <td>0.00</td>\n",
       "      <td>367.88</td>\n",
       "      <td>([30, 7, 7, 7, 14, 67, 124, 124, 450, 556, 129...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([30, 7, 7, 7, 31, 124, 129, 112, 43, 171, 102...</td>\n",
       "      <td>([30, 7, 7, 7, 31, 124, 129, 112, 43, 171, 102...</td>\n",
       "      <td>([30, 30, 7, 7, 7, 14, 31, 31, 31, 124, 888, 6...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4328</th>\n",
       "      <td>4328</td>\n",
       "      <td>18273.0</td>\n",
       "      <td>204.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>51.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>102.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>51.00</td>\n",
       "      <td>([1812], [20])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([1812], [40])</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4329</th>\n",
       "      <td>4329</td>\n",
       "      <td>18274.0</td>\n",
       "      <td>175.92</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>175.92</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([397, 333, 605, 2, 206, 507, 311, 8, 295, 200...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4330</th>\n",
       "      <td>4330</td>\n",
       "      <td>18276.0</td>\n",
       "      <td>335.86</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>335.86</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([283, 89, 174, 1118, 104, 833, 66, 312, 445, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4331</th>\n",
       "      <td>4331</td>\n",
       "      <td>18277.0</td>\n",
       "      <td>110.38</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>110.38</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([4, 386, 125, 767, 162, 51, 1717, 368], [8, 3...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4332</th>\n",
       "      <td>4332</td>\n",
       "      <td>18278.0</td>\n",
       "      <td>173.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>173.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 123, 70, 43, 222, 46, 474, 52, 915], [4,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4333</th>\n",
       "      <td>4333</td>\n",
       "      <td>18280.0</td>\n",
       "      <td>180.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>180.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([25, 82, 948, 92, 1093, 276, 329, 208, 1572, ...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4334</th>\n",
       "      <td>4334</td>\n",
       "      <td>18281.0</td>\n",
       "      <td>80.82</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>80.82</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([92, 545, 412, 646, 877, 1016, 15], [6, 12, 1...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([92, 545, 412, 646, 877, 1016, 15], [6, 12, 1...</td>\n",
       "      <td>([92, 545, 412, 646, 877, 1016, 15], [6, 12, 1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4335</th>\n",
       "      <td>4335</td>\n",
       "      <td>18282.0</td>\n",
       "      <td>178.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>77.84</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([277, 605, 672, 1493, 1468, 2601, 221], [1, 9...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4336</th>\n",
       "      <td>4336</td>\n",
       "      <td>18283.0</td>\n",
       "      <td>2094.88</td>\n",
       "      <td>0.00</td>\n",
       "      <td>215.00</td>\n",
       "      <td>102.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>111.78</td>\n",
       "      <td>99.47</td>\n",
       "      <td>307.53</td>\n",
       "      <td>...</td>\n",
       "      <td>134.90</td>\n",
       "      <td>114.65</td>\n",
       "      <td>651.56</td>\n",
       "      <td>208.00</td>\n",
       "      <td>([1, 281, 240, 240, 178, 246, 992, 992, 64, 28...</td>\n",
       "      <td>([246, 0, 131, 6, 6, 1431, 1431, 182, 296, 79,...</td>\n",
       "      <td>([1, 1, 64, 28, 28, 28, 0, 0, 0, 0, 0, 131, 13...</td>\n",
       "      <td>([1, 81, 246, 64, 28, 0, 6, 101, 44, 110, 296,...</td>\n",
       "      <td>([1, 1, 1, 81, 246, 64, 64, 28, 28, 28, 28, 0,...</td>\n",
       "      <td>([1, 1, 1, 30, 138, 138, 138, 81, 246, 246, 24...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4337</th>\n",
       "      <td>4337</td>\n",
       "      <td>18287.0</td>\n",
       "      <td>1837.28</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>765.28</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1072.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([324, 635, 91, 720, 993, 971, 1109, 1832, 142...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([123, 130, 89, 1446, 1446, 1447, 169, 204, 95...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4338 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      index  CustomerID  TotalRevenue  Revenue_2010_12  Revenue_2011_1  \\\n",
       "0         0     12346.0      77183.60             0.00        77183.60   \n",
       "1         1     12347.0       4310.00           674.29          475.39   \n",
       "2         2     12348.0       1797.24           892.80          227.44   \n",
       "3         3     12349.0       1757.55             0.00            0.00   \n",
       "4         4     12350.0        334.40             0.00            0.00   \n",
       "5         5     12352.0       2506.04             0.00            0.00   \n",
       "6         6     12353.0         89.00             0.00            0.00   \n",
       "7         7     12354.0       1079.40             0.00            0.00   \n",
       "8         8     12355.0        459.40             0.00            0.00   \n",
       "9         9     12356.0       2811.43             0.00         2271.62   \n",
       "10       10     12357.0       6207.67             0.00            0.00   \n",
       "11       11     12358.0       1168.06             0.00            0.00   \n",
       "12       12     12359.0       6372.58             0.00          547.50   \n",
       "13       13     12360.0       2662.06             0.00            0.00   \n",
       "14       14     12361.0        189.90             0.00            0.00   \n",
       "15       15     12362.0       5226.23             0.00            0.00   \n",
       "16       16     12363.0        552.00             0.00            0.00   \n",
       "17       17     12364.0       1313.10             0.00            0.00   \n",
       "18       18     12365.0        641.38             0.00            0.00   \n",
       "19       19     12367.0        168.90             0.00            0.00   \n",
       "20       20     12370.0       3545.69          1851.22            0.00   \n",
       "21       21     12371.0       1887.96             0.00            0.00   \n",
       "22       22     12372.0       1298.04             0.00            0.00   \n",
       "23       23     12373.0        364.60             0.00            0.00   \n",
       "24       24     12374.0        742.93             0.00            0.00   \n",
       "25       25     12375.0        457.50             0.00            0.00   \n",
       "26       26     12377.0       1628.12          1001.52          608.90   \n",
       "27       27     12378.0       4008.62             0.00            0.00   \n",
       "28       28     12379.0        852.24             0.00            0.00   \n",
       "29       29     12380.0       2724.81             0.00            0.00   \n",
       "...     ...         ...           ...              ...             ...   \n",
       "4308   4308     18242.0       2232.49             0.00            0.00   \n",
       "4309   4309     18245.0       2567.06           365.73          439.18   \n",
       "4310   4310     18246.0        596.10             0.00            0.00   \n",
       "4311   4311     18248.0        804.02             0.00            0.00   \n",
       "4312   4312     18249.0         95.34             0.00            0.00   \n",
       "4313   4313     18250.0        349.27             0.00            0.00   \n",
       "4314   4314     18251.0       4314.72             0.00            0.00   \n",
       "4315   4315     18252.0        526.67             0.00            0.00   \n",
       "4316   4316     18255.0        103.30             0.00            0.00   \n",
       "4317   4317     18257.0       2337.63             0.00            0.00   \n",
       "4318   4318     18259.0       2338.60           376.30            0.00   \n",
       "4319   4319     18260.0       2643.20           230.70          557.07   \n",
       "4320   4320     18261.0        324.24             0.00            0.00   \n",
       "4321   4321     18262.0        149.48             0.00            0.00   \n",
       "4322   4322     18263.0       1213.16             0.00            0.00   \n",
       "4323   4323     18265.0        801.51             0.00            0.00   \n",
       "4324   4324     18268.0         25.50             0.00            0.00   \n",
       "4325   4325     18269.0        168.60           168.60            0.00   \n",
       "4326   4326     18270.0        283.15             0.00            0.00   \n",
       "4327   4327     18272.0       3078.58             0.00            0.00   \n",
       "4328   4328     18273.0        204.00             0.00            0.00   \n",
       "4329   4329     18274.0        175.92             0.00            0.00   \n",
       "4330   4330     18276.0        335.86             0.00            0.00   \n",
       "4331   4331     18277.0        110.38             0.00            0.00   \n",
       "4332   4332     18278.0        173.90             0.00            0.00   \n",
       "4333   4333     18280.0        180.60             0.00            0.00   \n",
       "4334   4334     18281.0         80.82             0.00            0.00   \n",
       "4335   4335     18282.0        178.05             0.00            0.00   \n",
       "4336   4336     18283.0       2094.88             0.00          215.00   \n",
       "4337   4337     18287.0       1837.28             0.00            0.00   \n",
       "\n",
       "      Revenue_2011_2  Revenue_2011_3  Revenue_2011_4  Revenue_2011_5  \\\n",
       "0               0.00            0.00            0.00            0.00   \n",
       "1               0.00            0.00          636.25            0.00   \n",
       "2               0.00            0.00          367.00            0.00   \n",
       "3               0.00            0.00            0.00            0.00   \n",
       "4             334.40            0.00            0.00            0.00   \n",
       "5             296.50         1265.31            0.00            0.00   \n",
       "6               0.00            0.00            0.00           89.00   \n",
       "7               0.00            0.00         1079.40            0.00   \n",
       "8               0.00            0.00            0.00          459.40   \n",
       "9               0.00            0.00          481.46            0.00   \n",
       "10              0.00            0.00            0.00            0.00   \n",
       "11              0.00            0.00            0.00            0.00   \n",
       "12           1838.91            0.00            0.00            0.00   \n",
       "13              0.00            0.00            0.00         1083.58   \n",
       "14            189.90            0.00            0.00            0.00   \n",
       "15            479.10            0.00          495.24            0.00   \n",
       "16              0.00            0.00          299.10            0.00   \n",
       "17              0.00            0.00            0.00            0.00   \n",
       "18            641.38            0.00            0.00            0.00   \n",
       "19              0.00            0.00            0.00            0.00   \n",
       "20              0.00          837.11            0.00            0.00   \n",
       "21              0.00            0.00            0.00            0.00   \n",
       "22            399.22            0.00            0.00          515.70   \n",
       "23            364.60            0.00            0.00            0.00   \n",
       "24              0.00            0.00            0.00            0.00   \n",
       "25              0.00            0.00            0.00            0.00   \n",
       "26              0.00            0.00            0.00            0.00   \n",
       "27              0.00            0.00            0.00            0.00   \n",
       "28              0.00            0.00            0.00            0.00   \n",
       "29              0.00            0.00            0.00            0.00   \n",
       "...              ...             ...             ...             ...   \n",
       "4308            0.00            0.00            0.00          694.08   \n",
       "4309            0.00            0.00            0.00          501.38   \n",
       "4310            0.00            0.00          232.90            0.00   \n",
       "4311            0.00            0.00            0.00            0.00   \n",
       "4312            0.00            0.00            0.00            0.00   \n",
       "4313          349.27            0.00            0.00            0.00   \n",
       "4314            0.00            0.00            0.00            0.00   \n",
       "4315            0.00            0.00            0.00            0.00   \n",
       "4316            0.00            0.00            0.00            0.00   \n",
       "4317          363.80            0.00            0.00          357.40   \n",
       "4318            0.00            0.00            0.00            0.00   \n",
       "4319            0.00          548.75          451.58          427.97   \n",
       "4320            0.00            0.00            0.00            0.00   \n",
       "4321            0.00            0.00            0.00            0.00   \n",
       "4322            0.00            0.00          307.60            0.00   \n",
       "4323            0.00            0.00            0.00            0.00   \n",
       "4324            0.00            0.00            0.00            0.00   \n",
       "4325            0.00            0.00            0.00            0.00   \n",
       "4326            0.00           88.35            0.00            0.00   \n",
       "4327            0.00            0.00          980.54            0.00   \n",
       "4328            0.00           51.00            0.00            0.00   \n",
       "4329            0.00            0.00            0.00            0.00   \n",
       "4330            0.00            0.00            0.00            0.00   \n",
       "4331            0.00            0.00            0.00            0.00   \n",
       "4332            0.00            0.00            0.00            0.00   \n",
       "4333            0.00          180.60            0.00            0.00   \n",
       "4334            0.00            0.00            0.00            0.00   \n",
       "4335            0.00            0.00            0.00            0.00   \n",
       "4336          102.90            0.00          111.78           99.47   \n",
       "4337            0.00            0.00            0.00          765.28   \n",
       "\n",
       "      Revenue_2011_6  ...  Revenue_2011_9  Revenue_2011_10  Revenue_2011_11  \\\n",
       "0               0.00  ...            0.00             0.00             0.00   \n",
       "1             382.52  ...            0.00          1294.32             0.00   \n",
       "2               0.00  ...          310.00             0.00             0.00   \n",
       "3               0.00  ...            0.00             0.00          1757.55   \n",
       "4               0.00  ...            0.00             0.00             0.00   \n",
       "5               0.00  ...          632.50             0.00           311.73   \n",
       "6               0.00  ...            0.00             0.00             0.00   \n",
       "7               0.00  ...            0.00             0.00             0.00   \n",
       "8               0.00  ...            0.00             0.00             0.00   \n",
       "9               0.00  ...            0.00             0.00            58.35   \n",
       "10              0.00  ...            0.00             0.00          6182.47   \n",
       "11              0.00  ...            0.00             0.00             0.00   \n",
       "12           1109.32  ...            0.00          2876.85             0.00   \n",
       "13              0.00  ...            0.00          1043.78             0.00   \n",
       "14              0.00  ...            0.00             0.00             0.00   \n",
       "15              0.00  ...          829.99          1641.91           419.44   \n",
       "16              0.00  ...            0.00             0.00             0.00   \n",
       "17              0.00  ...           79.80           299.06             0.00   \n",
       "18              0.00  ...            0.00             0.00             0.00   \n",
       "19              0.00  ...            0.00             0.00             0.00   \n",
       "20              0.00  ...            0.00           739.28             0.00   \n",
       "21              0.00  ...            0.00          1887.96             0.00   \n",
       "22              0.00  ...          383.12             0.00             0.00   \n",
       "23              0.00  ...            0.00             0.00             0.00   \n",
       "24              0.00  ...            0.00             0.00           742.93   \n",
       "25              0.00  ...          230.30             0.00           227.20   \n",
       "26              0.00  ...            0.00             0.00             0.00   \n",
       "27              0.00  ...            0.00             0.00             0.00   \n",
       "28            459.84  ...          392.40             0.00             0.00   \n",
       "29            607.55  ...          626.01           450.86          1040.39   \n",
       "...              ...  ...             ...              ...              ...   \n",
       "4308            0.00  ...         1538.41             0.00             0.00   \n",
       "4309            0.00  ...            0.00             0.00             0.00   \n",
       "4310            0.00  ...            0.00             0.00           363.20   \n",
       "4311          496.46  ...            0.00             0.00             0.00   \n",
       "4312            0.00  ...            0.00             0.00            95.34   \n",
       "4313            0.00  ...            0.00             0.00             0.00   \n",
       "4314            0.00  ...         4314.72             0.00             0.00   \n",
       "4315           30.00  ...            0.00           456.77             0.00   \n",
       "4316            0.00  ...          103.30             0.00             0.00   \n",
       "4317          214.40  ...            0.00           774.76             0.00   \n",
       "4318            0.00  ...          891.90             0.00          1070.40   \n",
       "4319          427.13  ...            0.00             0.00             0.00   \n",
       "4320            0.00  ...          224.80            99.44             0.00   \n",
       "4321            0.00  ...            0.00             0.00             0.00   \n",
       "4322            0.00  ...            0.00             0.00           401.76   \n",
       "4323            0.00  ...          312.96             0.00             0.00   \n",
       "4324            0.00  ...            0.00             0.00             0.00   \n",
       "4325            0.00  ...            0.00             0.00             0.00   \n",
       "4326            0.00  ...            0.00             0.00           171.20   \n",
       "4327            0.00  ...            0.00           604.25             0.00   \n",
       "4328            0.00  ...          102.00             0.00             0.00   \n",
       "4329            0.00  ...            0.00             0.00           175.92   \n",
       "4330            0.00  ...            0.00           335.86             0.00   \n",
       "4331            0.00  ...            0.00           110.38             0.00   \n",
       "4332            0.00  ...          173.90             0.00             0.00   \n",
       "4333            0.00  ...            0.00             0.00             0.00   \n",
       "4334           80.82  ...            0.00             0.00             0.00   \n",
       "4335            0.00  ...            0.00             0.00             0.00   \n",
       "4336          307.53  ...          134.90           114.65           651.56   \n",
       "4337            0.00  ...            0.00          1072.00             0.00   \n",
       "\n",
       "      Revenue_2011_12                                             orders  \\\n",
       "0                0.00                                   ([598], [74215])   \n",
       "1              224.82  ([1490, 1490, 77, 77, 25, 25, 40, 40, 138, 519...   \n",
       "2                0.00  ([10, 10, 10, 67, 67, 65, 65, 439, 128, 128, 1...   \n",
       "3                0.00                                                NaN   \n",
       "4                0.00  ([10, 1019, 100, 217, 1120, 133, 90, 1114, 120...   \n",
       "5                0.00  ([62, 95, 426, 10, 10, 365, 946, 819, 522, 522...   \n",
       "6                0.00                                                NaN   \n",
       "7                0.00  ([532, 81, 56, 410, 246, 111, 7, 6, 293, 900, ...   \n",
       "8                0.00                                                NaN   \n",
       "9                0.00  ([10, 278, 14, 65, 65, 365, 510, 49, 340, 303,...   \n",
       "10               0.00                                                NaN   \n",
       "11             683.20                                                NaN   \n",
       "12               0.00  ([532, 62, 95, 30, 1284, 916, 426, 116, 202, 4...   \n",
       "13               0.00                                                NaN   \n",
       "14               0.00  ([81, 56, 410, 10, 6, 18, 35, 150, 75, 156], [...   \n",
       "15             529.04  ([56, 56, 1318, 10, 10, 6, 168, 79, 18, 35, 12...   \n",
       "16               0.00  ([14, 67, 65, 303, 128, 113, 96, 350, 251, 503...   \n",
       "17             310.32                                                NaN   \n",
       "18               0.00  ([1058, 929, 1501, 258, 2667, 2, 1663, 104, 42...   \n",
       "19             168.90                                                NaN   \n",
       "20               0.00  ([1, 4, 281, 240, 178, 178, 178, 10, 64, 166, ...   \n",
       "21               0.00                                                NaN   \n",
       "22               0.00  ([138, 81, 56, 116, 410, 1585, 979, 10, 150, 7...   \n",
       "23               0.00  ([81, 10, 0, 44, 35, 19, 155, 179, 150, 204, 1...   \n",
       "24               0.00                                                NaN   \n",
       "25               0.00                                                NaN   \n",
       "26               0.00  ([77, 25, 40, 81, 56, 116, 410, 1585, 1585, 97...   \n",
       "27               0.00                                                NaN   \n",
       "28               0.00                                                NaN   \n",
       "29               0.00                                                NaN   \n",
       "...               ...                                                ...   \n",
       "4308             0.00                                                NaN   \n",
       "4309           894.25  ([1, 30, 77, 40, 651, 22, 157, 124, 48, 48, 35...   \n",
       "4310             0.00                             ([406, 401], [60, 10])   \n",
       "4311             0.00                                                NaN   \n",
       "4312             0.00                                                NaN   \n",
       "4313             0.00  ([532, 30, 283, 65, 31, 48, 171, 259, 2, 102, ...   \n",
       "4314             0.00                                                NaN   \n",
       "4315             0.00                                                NaN   \n",
       "4316             0.00                                                NaN   \n",
       "4317             0.00  ([30, 1240, 1284, 916, 0, 31, 124, 479, 43, 41...   \n",
       "4318             0.00  ([123, 39, 139, 59, 918, 308, 328], [8, 6, 24,...   \n",
       "4319             0.00  ([1, 4, 4, 4, 1145, 64, 14, 67, 67, 65, 119, 1...   \n",
       "4320             0.00                                                NaN   \n",
       "4321             0.00                                                NaN   \n",
       "4322             0.00  ([138, 239, 192, 439, 53, 234, 669, 186, 384, ...   \n",
       "4323             0.00                                                NaN   \n",
       "4324             0.00                                                NaN   \n",
       "4325             0.00  ([111, 1311, 1983, 918, 466, 173, 1732], [24, ...   \n",
       "4326             0.00             ([676, 94, 2633, 449], [3, 12, 6, 12])   \n",
       "4327           367.88  ([30, 7, 7, 7, 14, 67, 124, 124, 450, 556, 129...   \n",
       "4328            51.00                                     ([1812], [20])   \n",
       "4329             0.00                                                NaN   \n",
       "4330             0.00                                                NaN   \n",
       "4331             0.00                                                NaN   \n",
       "4332             0.00                                                NaN   \n",
       "4333             0.00  ([25, 82, 948, 92, 1093, 276, 329, 208, 1572, ...   \n",
       "4334             0.00                                                NaN   \n",
       "4335            77.84                                                NaN   \n",
       "4336           208.00  ([1, 281, 240, 240, 178, 246, 992, 992, 64, 28...   \n",
       "4337             0.00                                                NaN   \n",
       "\n",
       "                                          orders_future  \\\n",
       "0                                                   NaN   \n",
       "1                                                   NaN   \n",
       "2                                                   NaN   \n",
       "3                                                   NaN   \n",
       "4                                                   NaN   \n",
       "5                                                   NaN   \n",
       "6                 ([781, 813, 1162, 837], [8, 2, 6, 4])   \n",
       "7                                                   NaN   \n",
       "8     ([526, 526, 526, 2, 42, 58, 744, 837, 478, 93,...   \n",
       "9                                                   NaN   \n",
       "10                                                  NaN   \n",
       "11                                                  NaN   \n",
       "12                                                  NaN   \n",
       "13    ([81, 283, 10, 7, 7, 278, 168, 273, 1483, 49, ...   \n",
       "14                                                  NaN   \n",
       "15                                                  NaN   \n",
       "16                                                  NaN   \n",
       "17                                                  NaN   \n",
       "18                                                  NaN   \n",
       "19                                                  NaN   \n",
       "20                                                  NaN   \n",
       "21                                                  NaN   \n",
       "22    ([81, 56, 10, 150, 75, 229, 90, 715, 114, 156,...   \n",
       "23                                                  NaN   \n",
       "24                                                  NaN   \n",
       "25                                                  NaN   \n",
       "26                                                  NaN   \n",
       "27                                                  NaN   \n",
       "28                                                  NaN   \n",
       "29                                                  NaN   \n",
       "...                                                 ...   \n",
       "4308  ([4, 30, 31, 450, 48, 1064, 129, 682, 738, 185...   \n",
       "4309  ([1, 406, 22, 48, 48, 113, 801, 1543, 1475, 26...   \n",
       "4310                                                NaN   \n",
       "4311                                                NaN   \n",
       "4312                                                NaN   \n",
       "4313                                                NaN   \n",
       "4314                                                NaN   \n",
       "4315                                                NaN   \n",
       "4316                                                NaN   \n",
       "4317  ([298, 449, 27, 396, 47, 69, 55, 172, 1877, 15...   \n",
       "4318                                                NaN   \n",
       "4319  ([4, 14, 157, 42, 176, 724, 3, 97, 57, 57, 93,...   \n",
       "4320                                                NaN   \n",
       "4321                                                NaN   \n",
       "4322                                                NaN   \n",
       "4323                                                NaN   \n",
       "4324                                                NaN   \n",
       "4325                                                NaN   \n",
       "4326                                                NaN   \n",
       "4327                                                NaN   \n",
       "4328                                                NaN   \n",
       "4329                                                NaN   \n",
       "4330                                                NaN   \n",
       "4331                                                NaN   \n",
       "4332                                                NaN   \n",
       "4333                                                NaN   \n",
       "4334                                                NaN   \n",
       "4335                                                NaN   \n",
       "4336  ([246, 0, 131, 6, 6, 1431, 1431, 182, 296, 79,...   \n",
       "4337  ([324, 635, 91, 720, 993, 971, 1109, 1832, 142...   \n",
       "\n",
       "                                         orders_future2  \\\n",
       "0                                                   NaN   \n",
       "1     ([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...   \n",
       "2                                                   NaN   \n",
       "3                                                   NaN   \n",
       "4                                                   NaN   \n",
       "5                                                   NaN   \n",
       "6                                                   NaN   \n",
       "7                                                   NaN   \n",
       "8                                                   NaN   \n",
       "9                                                   NaN   \n",
       "10                                                  NaN   \n",
       "11                                                  NaN   \n",
       "12    ([0, 82, 192, 770, 835, 2, 417, 102, 42, 175, ...   \n",
       "13                                                  NaN   \n",
       "14                                                  NaN   \n",
       "15                                                  NaN   \n",
       "16                                                  NaN   \n",
       "17                                                  NaN   \n",
       "18                                                  NaN   \n",
       "19                                                  NaN   \n",
       "20                                                  NaN   \n",
       "21                                                  NaN   \n",
       "22                                                  NaN   \n",
       "23                                                  NaN   \n",
       "24                                                  NaN   \n",
       "25                                                  NaN   \n",
       "26                                                  NaN   \n",
       "27                                                  NaN   \n",
       "28    ([116, 410, 10, 7, 273, 14, 49, 248, 229, 1133...   \n",
       "29    ([81, 10, 28, 0, 0, 131, 7, 7, 6, 182, 342, 18...   \n",
       "...                                                 ...   \n",
       "4308                                                NaN   \n",
       "4309                                                NaN   \n",
       "4310                                                NaN   \n",
       "4311  ([1, 14, 67, 623, 293, 167, 637, 49, 106, 2258...   \n",
       "4312                                                NaN   \n",
       "4313                                                NaN   \n",
       "4314                                                NaN   \n",
       "4315                               ([3, 1808], [4, 12])   \n",
       "4316                                                NaN   \n",
       "4317  ([532, 28, 203, 47, 55, 26, 15, 144, 351, 1500...   \n",
       "4318                                                NaN   \n",
       "4319  ([157, 119, 74, 432, 812, 243, 1264, 58, 218, ...   \n",
       "4320                                                NaN   \n",
       "4321                                                NaN   \n",
       "4322                                                NaN   \n",
       "4323                                                NaN   \n",
       "4324                                                NaN   \n",
       "4325                                                NaN   \n",
       "4326                                                NaN   \n",
       "4327                                                NaN   \n",
       "4328                                                NaN   \n",
       "4329                                                NaN   \n",
       "4330                                                NaN   \n",
       "4331                                                NaN   \n",
       "4332                                                NaN   \n",
       "4333                                                NaN   \n",
       "4334  ([92, 545, 412, 646, 877, 1016, 15], [6, 12, 1...   \n",
       "4335                                                NaN   \n",
       "4336  ([1, 1, 64, 28, 28, 28, 0, 0, 0, 0, 0, 131, 13...   \n",
       "4337                                                NaN   \n",
       "\n",
       "                                         orders_future3  \\\n",
       "0                                                   NaN   \n",
       "1                                                   NaN   \n",
       "2                                                   NaN   \n",
       "3                                                   NaN   \n",
       "4                                                   NaN   \n",
       "5                                                   NaN   \n",
       "6                                                   NaN   \n",
       "7                                                   NaN   \n",
       "8                                                   NaN   \n",
       "9                                                   NaN   \n",
       "10                                                  NaN   \n",
       "11    ([10, 386, 348, 125, 125, 458, 91, 817, 813, 1...   \n",
       "12                                                  NaN   \n",
       "13                                                  NaN   \n",
       "14                                                  NaN   \n",
       "15    ([25, 81, 10, 36, 43, 133, 90, 85, 2, 541, 334...   \n",
       "16                                                  NaN   \n",
       "17                                                  NaN   \n",
       "18                                                  NaN   \n",
       "19                                                  NaN   \n",
       "20                                                  NaN   \n",
       "21                                                  NaN   \n",
       "22                                                  NaN   \n",
       "23                                                  NaN   \n",
       "24                                                  NaN   \n",
       "25                                                  NaN   \n",
       "26                                                  NaN   \n",
       "27                                                  NaN   \n",
       "28                                                  NaN   \n",
       "29                                                  NaN   \n",
       "...                                                 ...   \n",
       "4308                                                NaN   \n",
       "4309  ([25, 293, 92, 1538, 801, 229, 541, 956, 467, ...   \n",
       "4310                                                NaN   \n",
       "4311                                                NaN   \n",
       "4312                                                NaN   \n",
       "4313                                                NaN   \n",
       "4314                                                NaN   \n",
       "4315                                                NaN   \n",
       "4316                                                NaN   \n",
       "4317                                                NaN   \n",
       "4318                                                NaN   \n",
       "4319                                                NaN   \n",
       "4320                                                NaN   \n",
       "4321  ([6, 31, 128, 152, 476, 630, 454, 2088, 1681, ...   \n",
       "4322  ([632, 632, 1011, 939, 1302, 810, 1606, 2270, ...   \n",
       "4323  ([14, 167, 277, 249, 129, 180, 43, 394, 2, 970...   \n",
       "4324                                       ([676], [2])   \n",
       "4325                                                NaN   \n",
       "4326                                                NaN   \n",
       "4327  ([30, 7, 7, 7, 31, 124, 129, 112, 43, 171, 102...   \n",
       "4328                                                NaN   \n",
       "4329                                                NaN   \n",
       "4330                                                NaN   \n",
       "4331                                                NaN   \n",
       "4332                                                NaN   \n",
       "4333                                                NaN   \n",
       "4334                                                NaN   \n",
       "4335                                                NaN   \n",
       "4336  ([1, 81, 246, 64, 28, 0, 6, 101, 44, 110, 296,...   \n",
       "4337                                                NaN   \n",
       "\n",
       "                                         orders_future4  \\\n",
       "0                                                   NaN   \n",
       "1     ([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...   \n",
       "2                                                   NaN   \n",
       "3                                                   NaN   \n",
       "4                                                   NaN   \n",
       "5                                                   NaN   \n",
       "6                                                   NaN   \n",
       "7                                                   NaN   \n",
       "8                                                   NaN   \n",
       "9                                                   NaN   \n",
       "10                                                  NaN   \n",
       "11    ([10, 386, 348, 125, 125, 458, 91, 817, 813, 1...   \n",
       "12    ([0, 82, 192, 770, 835, 2, 417, 102, 42, 175, ...   \n",
       "13                                                  NaN   \n",
       "14                                                  NaN   \n",
       "15    ([25, 81, 10, 36, 43, 133, 90, 85, 2, 541, 334...   \n",
       "16                                                  NaN   \n",
       "17                                                  NaN   \n",
       "18                                                  NaN   \n",
       "19                                                  NaN   \n",
       "20                                                  NaN   \n",
       "21                                                  NaN   \n",
       "22                                                  NaN   \n",
       "23                                                  NaN   \n",
       "24                                                  NaN   \n",
       "25                                                  NaN   \n",
       "26                                                  NaN   \n",
       "27                                                  NaN   \n",
       "28    ([116, 410, 10, 7, 273, 14, 49, 248, 229, 1133...   \n",
       "29    ([81, 10, 28, 0, 0, 131, 7, 7, 6, 182, 342, 18...   \n",
       "...                                                 ...   \n",
       "4308                                                NaN   \n",
       "4309  ([25, 293, 92, 1538, 801, 229, 541, 956, 467, ...   \n",
       "4310                                                NaN   \n",
       "4311  ([1, 14, 67, 623, 293, 167, 637, 49, 106, 2258...   \n",
       "4312                                                NaN   \n",
       "4313                                                NaN   \n",
       "4314                                                NaN   \n",
       "4315                               ([3, 1808], [4, 12])   \n",
       "4316                                                NaN   \n",
       "4317  ([532, 28, 203, 47, 55, 26, 15, 144, 351, 1500...   \n",
       "4318                                                NaN   \n",
       "4319  ([157, 119, 74, 432, 812, 243, 1264, 58, 218, ...   \n",
       "4320                                                NaN   \n",
       "4321  ([6, 31, 128, 152, 476, 630, 454, 2088, 1681, ...   \n",
       "4322  ([632, 632, 1011, 939, 1302, 810, 1606, 2270, ...   \n",
       "4323  ([14, 167, 277, 249, 129, 180, 43, 394, 2, 970...   \n",
       "4324                                       ([676], [2])   \n",
       "4325                                                NaN   \n",
       "4326                                                NaN   \n",
       "4327  ([30, 7, 7, 7, 31, 124, 129, 112, 43, 171, 102...   \n",
       "4328                                                NaN   \n",
       "4329                                                NaN   \n",
       "4330                                                NaN   \n",
       "4331                                                NaN   \n",
       "4332                                                NaN   \n",
       "4333                                                NaN   \n",
       "4334  ([92, 545, 412, 646, 877, 1016, 15], [6, 12, 1...   \n",
       "4335                                                NaN   \n",
       "4336  ([1, 1, 1, 81, 246, 64, 64, 28, 28, 28, 28, 0,...   \n",
       "4337                                                NaN   \n",
       "\n",
       "                                         orders_future5  \n",
       "0                                                   NaN  \n",
       "1     ([77, 25, 25, 25, 40, 138, 138, 111, 283, 101,...  \n",
       "2                        ([10, 312, 549], [1, 120, 96])  \n",
       "3     ([30, 81, 10, 293, 637, 103, 103, 510, 340, 45...  \n",
       "4                                                   NaN  \n",
       "5     ([95, 426, 111, 10, 10, 10, 946, 946, 819, 819...  \n",
       "6                                                   NaN  \n",
       "7                                                   NaN  \n",
       "8                                                   NaN  \n",
       "9                                    ([2, 176], [2, 3])  \n",
       "10    ([72, 72, 219, 77, 25, 40, 386, 348, 125, 637,...  \n",
       "11    ([10, 386, 348, 125, 125, 458, 91, 817, 813, 1...  \n",
       "12    ([77, 25, 40, 0, 0, 0, 44, 80, 1099, 193, 82, ...  \n",
       "13    ([324, 81, 81, 10, 10, 7, 7, 7, 7, 168, 168, 2...  \n",
       "14                                                  NaN  \n",
       "15    ([77, 77, 25, 25, 25, 40, 40, 81, 81, 81, 81, ...  \n",
       "16    ([225, 136, 336, 742, 490, 263, 220], [12, 36,...  \n",
       "17    ([10, 10, 10, 278, 278, 14, 67, 65, 49, 49, 34...  \n",
       "18                                                  NaN  \n",
       "19                                                  NaN  \n",
       "20    ([1, 4, 946, 819, 821, 153, 568, 767, 174, 126...  \n",
       "21    ([72, 219, 281, 10, 6, 273, 36, 929, 1458, 106...  \n",
       "22    ([81, 56, 116, 410, 10, 75, 90, 114, 156, 784,...  \n",
       "23                                                  NaN  \n",
       "24    ([10, 123, 635, 106, 59, 718, 888, 605, 113, 1...  \n",
       "25    ([10, 10, 0, 7, 7, 83, 226, 179, 142, 135, 87,...  \n",
       "26                                                  NaN  \n",
       "27    ([281, 240, 916, 77, 40, 81, 56, 116, 410, 111...  \n",
       "28    ([81, 116, 410, 10, 10, 0, 7, 6, 273, 14, 49, ...  \n",
       "29    ([30, 1263, 81, 81, 81, 111, 111, 10, 10, 10, ...  \n",
       "...                                                 ...  \n",
       "4308  ([4, 77, 25, 40, 376, 7, 41, 450, 223, 204, 2,...  \n",
       "4309  ([25, 293, 92, 1538, 801, 229, 541, 956, 467, ...  \n",
       "4310                             ([405, 401], [16, 80])  \n",
       "4311  ([1, 14, 67, 623, 293, 21, 167, 637, 637, 49, ...  \n",
       "4312  ([605, 204, 1024, 1357, 34, 905, 696, 1872], [...  \n",
       "4313                                                NaN  \n",
       "4314  ([14, 101, 67, 65, 128, 113, 136, 127, 1047, 8...  \n",
       "4315  ([4, 123, 28, 83, 342, 405, 5, 5, 5, 510, 522,...  \n",
       "4316  ([1, 110, 433, 66, 294, 1693], [6, 16, 6, 24, ...  \n",
       "4317  ([1, 178, 532, 28, 28, 0, 0, 7, 7, 6, 44, 41, ...  \n",
       "4318  ([72, 151, 151, 219, 219, 123, 123, 130, 130, ...  \n",
       "4319  ([157, 119, 74, 432, 812, 243, 1264, 58, 218, ...  \n",
       "4320  ([22, 309, 174, 174, 301, 301, 169, 483, 431, ...  \n",
       "4321  ([6, 31, 128, 152, 476, 630, 454, 2088, 1681, ...  \n",
       "4322  ([632, 632, 154, 441, 53, 1011, 495, 939, 1302...  \n",
       "4323  ([4, 95, 109, 14, 82, 167, 277, 119, 249, 129,...  \n",
       "4324                                       ([676], [2])  \n",
       "4325                                                NaN  \n",
       "4326  ([398, 828, 2255, 1815, 2304, 368], [12, 12, 8...  \n",
       "4327  ([30, 30, 7, 7, 7, 14, 31, 31, 31, 124, 888, 6...  \n",
       "4328                                     ([1812], [40])  \n",
       "4329  ([397, 333, 605, 2, 206, 507, 311, 8, 295, 200...  \n",
       "4330  ([283, 89, 174, 1118, 104, 833, 66, 312, 445, ...  \n",
       "4331  ([4, 386, 125, 767, 162, 51, 1717, 368], [8, 3...  \n",
       "4332  ([25, 123, 70, 43, 222, 46, 474, 52, 915], [4,...  \n",
       "4333                                                NaN  \n",
       "4334  ([92, 545, 412, 646, 877, 1016, 15], [6, 12, 1...  \n",
       "4335  ([277, 605, 672, 1493, 1468, 2601, 221], [1, 9...  \n",
       "4336  ([1, 1, 1, 30, 138, 138, 138, 81, 246, 246, 24...  \n",
       "4337  ([123, 130, 89, 1446, 1446, 1447, 169, 204, 95...  \n",
       "\n",
       "[4338 rows x 22 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "customer_info_orders"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "25"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_past = np.zeros((len(customer_info_orders),counter)).astype(np.float32)\n",
    "for i in range(len(customer_info_orders)):\n",
    "    try:\n",
    "        pdt,quantity = customer_info_orders.iloc[i]['orders']\n",
    "        for j,k in zip(pdt,quantity):\n",
    "            matrix_past[i,j] += k\n",
    "    except TypeError : None #no orders presetn\n",
    "matrix_past = 1*(matrix_past>0)\n",
    "import gc \n",
    "gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_future = np.zeros((len(customer_info_orders),counter)).astype(np.float32)\n",
    "for i in range(len(customer_info_orders)):\n",
    "    try:\n",
    "        pdt,quantity = customer_info_orders.iloc[i]['orders_future']\n",
    "        for j,k in zip(pdt,quantity):\n",
    "            matrix_future[i,j] += k\n",
    "    except TypeError : None #no orders presetn\n",
    "\n",
    "import gc \n",
    "gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_future2 = np.zeros((len(customer_info_orders),counter)).astype(np.float32)\n",
    "for i in range(len(customer_info_orders)):\n",
    "    try:\n",
    "        pdt,quantity = customer_info_orders.iloc[i]['orders_future2']\n",
    "        for j,k in zip(pdt,quantity):\n",
    "            matrix_future2[i,j] += k\n",
    "    except TypeError : None #no orders presetn\n",
    "\n",
    "import gc \n",
    "gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_future3 = np.zeros((len(customer_info_orders),counter)).astype(np.float32)\n",
    "for i in range(len(customer_info_orders)):\n",
    "    try:\n",
    "        pdt,quantity = customer_info_orders.iloc[i]['orders_future3']\n",
    "        for j,k in zip(pdt,quantity):\n",
    "            matrix_future3[i,j] += k\n",
    "    except TypeError : None #no orders presetn\n",
    "\n",
    "import gc \n",
    "gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_future4 = np.zeros((len(customer_info_orders),counter)).astype(np.float32)\n",
    "for i in range(len(customer_info_orders)):\n",
    "    try:\n",
    "        pdt,quantity = customer_info_orders.iloc[i]['orders_future4']\n",
    "        for j,k in zip(pdt,quantity):\n",
    "            matrix_future4[i,j] += k\n",
    "    except TypeError : None #no orders presetn\n",
    "\n",
    "import gc \n",
    "gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_future5 = np.zeros((len(customer_info_orders),counter)).astype(np.float32)\n",
    "for i in range(len(customer_info_orders)):\n",
    "    try:\n",
    "        pdt,quantity = customer_info_orders.iloc[i]['orders_future5']\n",
    "        for j,k in zip(pdt,quantity):\n",
    "            matrix_future5[i,j] += k\n",
    "    except TypeError : None #no orders presetn\n",
    "\n",
    "import gc \n",
    "gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>CustomerID</th>\n",
       "      <th>TotalRevenue</th>\n",
       "      <th>Revenue_2010_12</th>\n",
       "      <th>Revenue_2011_1</th>\n",
       "      <th>Revenue_2011_2</th>\n",
       "      <th>Revenue_2011_3</th>\n",
       "      <th>Revenue_2011_4</th>\n",
       "      <th>Revenue_2011_5</th>\n",
       "      <th>Revenue_2011_6</th>\n",
       "      <th>...</th>\n",
       "      <th>Revenue_2011_9</th>\n",
       "      <th>Revenue_2011_10</th>\n",
       "      <th>Revenue_2011_11</th>\n",
       "      <th>Revenue_2011_12</th>\n",
       "      <th>orders</th>\n",
       "      <th>orders_future</th>\n",
       "      <th>orders_future2</th>\n",
       "      <th>orders_future3</th>\n",
       "      <th>orders_future4</th>\n",
       "      <th>orders_future5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>12346.0</td>\n",
       "      <td>77183.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>77183.60</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([598], [74215])</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>12347.0</td>\n",
       "      <td>4310.00</td>\n",
       "      <td>674.29</td>\n",
       "      <td>475.39</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>636.25</td>\n",
       "      <td>0.0</td>\n",
       "      <td>382.52</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1294.32</td>\n",
       "      <td>0.00</td>\n",
       "      <td>224.82</td>\n",
       "      <td>([1490, 1490, 77, 77, 25, 25, 40, 40, 138, 519...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...</td>\n",
       "      <td>([77, 25, 25, 25, 40, 138, 138, 111, 283, 101,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>12348.0</td>\n",
       "      <td>1797.24</td>\n",
       "      <td>892.80</td>\n",
       "      <td>227.44</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>367.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>310.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([10, 10, 10, 67, 67, 65, 65, 439, 128, 128, 1...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([10, 312, 549], [1, 120, 96])</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>12349.0</td>\n",
       "      <td>1757.55</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1757.55</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>([30, 81, 10, 293, 637, 103, 103, 510, 340, 45...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>12350.0</td>\n",
       "      <td>334.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>334.4</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>([10, 1019, 100, 217, 1120, 133, 90, 1114, 120...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   index  CustomerID  TotalRevenue  Revenue_2010_12  Revenue_2011_1  \\\n",
       "0      0     12346.0      77183.60             0.00        77183.60   \n",
       "1      1     12347.0       4310.00           674.29          475.39   \n",
       "2      2     12348.0       1797.24           892.80          227.44   \n",
       "3      3     12349.0       1757.55             0.00            0.00   \n",
       "4      4     12350.0        334.40             0.00            0.00   \n",
       "\n",
       "   Revenue_2011_2  Revenue_2011_3  Revenue_2011_4  Revenue_2011_5  \\\n",
       "0             0.0             0.0            0.00             0.0   \n",
       "1             0.0             0.0          636.25             0.0   \n",
       "2             0.0             0.0          367.00             0.0   \n",
       "3             0.0             0.0            0.00             0.0   \n",
       "4           334.4             0.0            0.00             0.0   \n",
       "\n",
       "   Revenue_2011_6  ...  Revenue_2011_9  Revenue_2011_10  Revenue_2011_11  \\\n",
       "0            0.00  ...             0.0             0.00             0.00   \n",
       "1          382.52  ...             0.0          1294.32             0.00   \n",
       "2            0.00  ...           310.0             0.00             0.00   \n",
       "3            0.00  ...             0.0             0.00          1757.55   \n",
       "4            0.00  ...             0.0             0.00             0.00   \n",
       "\n",
       "   Revenue_2011_12                                             orders  \\\n",
       "0             0.00                                   ([598], [74215])   \n",
       "1           224.82  ([1490, 1490, 77, 77, 25, 25, 40, 40, 138, 519...   \n",
       "2             0.00  ([10, 10, 10, 67, 67, 65, 65, 439, 128, 128, 1...   \n",
       "3             0.00                                                NaN   \n",
       "4             0.00  ([10, 1019, 100, 217, 1120, 133, 90, 1114, 120...   \n",
       "\n",
       "   orders_future                                     orders_future2  \\\n",
       "0            NaN                                                NaN   \n",
       "1            NaN  ([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...   \n",
       "2            NaN                                                NaN   \n",
       "3            NaN                                                NaN   \n",
       "4            NaN                                                NaN   \n",
       "\n",
       "  orders_future3                                     orders_future4  \\\n",
       "0            NaN                                                NaN   \n",
       "1            NaN  ([25, 419, 435, 1700, 1593, 210, 276, 1200, 11...   \n",
       "2            NaN                                                NaN   \n",
       "3            NaN                                                NaN   \n",
       "4            NaN                                                NaN   \n",
       "\n",
       "                                      orders_future5  \n",
       "0                                                NaN  \n",
       "1  ([77, 25, 25, 25, 40, 138, 138, 111, 283, 101,...  \n",
       "2                     ([10, 312, 549], [1, 120, 96])  \n",
       "3  ([30, 81, 10, 293, 637, 103, 103, 510, 340, 45...  \n",
       "4                                                NaN  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "customer_info_orders.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2677\n"
     ]
    }
   ],
   "source": [
    "# recommendation system , for our case since entries are small, we use SVD to do matrix factorization\n",
    "# instead of a less expensive but approximate algorithm like alternating last squares. WARNING This is not scalable. \n",
    "U,D,V = np.linalg.svd(matrix_past)\n",
    "print len(D)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0, 0, 0, ..., 0, 0, 0],\n",
       "       [0, 0, 1, ..., 0, 0, 0],\n",
       "       [0, 0, 0, ..., 0, 0, 0],\n",
       "       ...,\n",
       "       [0, 0, 0, ..., 0, 0, 0],\n",
       "       [1, 1, 0, ..., 0, 0, 0],\n",
       "       [0, 0, 0, ..., 0, 0, 0]])"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "matrix_past"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'U2' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-22-01ad7b624c85>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmatmul\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmatmul\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mU2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdiag\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mD2\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;36m.5\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmatmul\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdiag\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mD2\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;36m.5\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mV2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m: name 'U2' is not defined"
     ]
    }
   ],
   "source": [
    "np.matmul(np.matmul(U2,np.diag(D2**.5)),np.matmul(np.diag(D2**.5),V2))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "num = 1000\n",
    "U2=U[:,:num]\n",
    "D2=D[:num]\n",
    "V2=V[:num]\n",
    "Z = sum(D)\n",
    "print sum(D2)/Z\n",
    "plt.plot(map(lambda x : np.sum(D[:x])/Z,range(len(D2))))\n",
    "plt.show()\n",
    "print matrix_past\n",
    "np.matmul(np.matmul(U2,np.diag(D2)),V2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(counter):\n",
    "    customer_info_orders['pdt_'+str(i)] = matrix_past[:,i].astype(np.uint16)\n",
    "for i in range(U2.shape[1]):\n",
    "    customer_info_orders['svd_'+str(i)] = U2[:,i].astype(np.float32)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "colsA =  ['Revenue_2011_' + str(x) for x in [1,2,3,4]]+['Revenue_2010_12']\n",
    "#print np.corrcoef(customer_info_orders['target2'].values,\n",
    "#           np.mean(np.log10(1+customer_info_orders[colsA].values),1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders.iloc[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders.keys()[3:8]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "# SQUARED LOGLOSS\n",
    "#predict customer orders\n",
    "import xgboost as  xgb\n",
    "'''\n",
    "train = data2[((data2['Year']==2010)*(data2['Month'].isin([12,]))) | \\\n",
    "              ((data2['Year']==2011)*(data2['Month'].isin([1,2,3,4])))]\n",
    "test = data2[ ((data2['Year']==2011)*(data2['Month'].isin([5])))]\n",
    "test2 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([6,])))]\n",
    "test3 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([7,])))]\n",
    "test4 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([6,7,])))]\n",
    "test5 = data2[ ((data2['Year']==2011)*(data2['Month'].isin([6,7,8,9,10,11])))]\n",
    "\n",
    "len(train),len(test),len(test2),len(test3),len(test4),len(test5)\n",
    "'''\n",
    "customer_info_orders.columns = [regex.sub(\"_\", col) if any(x in str(col) for x in set(('[', ']', '<'))) else col for col in customer_info_orders.columns.values]\n",
    "\n",
    "predictors = list(customer_info_orders.keys()[3:8])+['mean_log_rev_train',]+\\\n",
    "                     list([x for x in customer_info_orders.keys() if 'svd' in str(x)]) [:30]\n",
    "colsA =  ['Revenue_2011_' + str(x) for x in [1,2,3,4]]+['Revenue_2010_12']\n",
    "customer_info_orders['mean_log_rev_train']= np.log10(1+np.mean(customer_info_orders[colsA].values,1))\n",
    "z = customer_info_orders[['pdt_'+str(x) for x in range(100)]].describe().loc['mean']\n",
    "predictors += list(z[z>0.03].index)\n",
    "target = 'target'\n",
    "gc.collect()\n",
    "for i in range(2,6):\n",
    "    cols = [[0,],[0,],[6,],[7,],[8,],[6,7,8]][i]\n",
    "    cols = ['Revenue_2011_'+str(x) for x in cols]\n",
    "    customer_info_orders[target+str(i)]= np.log10(1+np.mean(customer_info_orders[cols].values,1))\n",
    "\n",
    "\n",
    "if True:\n",
    "    customer_info_orders2 = customer_info_orders.copy()\n",
    "    customer_info_orders2 = customer_info_orders2[customer_info_orders2['mean_log_rev_train']>0] #remove datapoints which have not brought stuff\n",
    "    customer_info_orders2[target]= np.log10(1+np.mean(customer_info_orders2[['Revenue_2011_5',]].values,1))\n",
    "    train_id = [x for x in range(len(customer_info_orders2)) if x%5!=0]\n",
    "    test_id = [x for x in range(len(customer_info_orders2)) if x%5==0]\n",
    "    dtrain = customer_info_orders2.iloc[train_id]\n",
    "    dcv = customer_info_orders2.iloc[test_id]\n",
    "    dtest = customer_info_orders2\n",
    "    gc.collect()\n",
    "    params = {}\n",
    "    params[\"objective\"] = \"reg:linear\"\n",
    "    params[\"eta\"] = 0.01/10\n",
    "    params[\"min_child_weight\"] = 1\n",
    "    params[\"subsample\"] = 0.3\n",
    "    params[\"colsample_bytree\"] = 0.3\n",
    "    params[\"scale_pos_weight\"] = 1.0\n",
    "    params[\"silent\"] = 1\n",
    "    params[\"verbose\"] = 1\n",
    "    params[\"max_depth\"] = 5\n",
    "    #params[\"nthread\"] = 6\n",
    "    params[\"nthread\"] = -1\n",
    "    early_stopping_rounds = 50\n",
    "    plst = list(params.items())\n",
    "    xgtrain = xgb.DMatrix(dtrain[predictors].values, label=dtrain[target].values)\n",
    "    xgcv = xgb.DMatrix(dcv[predictors].values, label=dcv[target].values)\n",
    "    xgtest2 = xgb.DMatrix(dtest[predictors].values, label=dtest[target+'2'].values)\n",
    "    xgtest3 = xgb.DMatrix(dtest[predictors].values, label=dtest[target+'3'].values)\n",
    "    xgtest4 = xgb.DMatrix(dtest[predictors].values, label=dtest[target+'4'].values)\n",
    "    xgtest5 = xgb.DMatrix(dtest[predictors].values, label=dtest[target+'5'].values)\n",
    "    #    xgb.train(xgtrain[predictors],dtrain['Demanda_uni_equil'],eval_set=evallist ,\n",
    "    #            eval_metric='rmse', early_stopping_rounds=early_stopping_rounds)\n",
    "    watchlist  = [ (xgtrain,'train'),(xgtest2,'2month'),(xgtest3,'3month'),\n",
    "                  (xgtest4,'4month'),(xgtest5,'5month'),(xgcv,'eval')][:]\n",
    "    a = {}\n",
    "    model=xgb.train(plst,xgtrain,10*5510,watchlist,verbose_eval =1000,feval=None,\n",
    "                    early_stopping_rounds=early_stopping_rounds*3,evals_result=a)\n",
    "    print np.corrcoef(np.nan_to_num(np.log10(model.predict(xgtest2)[test_id])),\n",
    "                      customer_info_orders['target'].iloc[test_id])\n",
    "    val = 0\n",
    "    for j in range(2,6):\n",
    "        j = str(j)\n",
    "        customer_info_orders2['pred'+j] = model.predict(xgtest2)\n",
    "        xxxx = np.corrcoef(model.predict(xgtest2),customer_info_orders2['target'+j])\n",
    "        val += xxxx[1,0]\n",
    "        print xxxx\n",
    "        \n",
    "    print val/4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import xgbfir\n",
    "xgbfir.saveXgbFI(model,MaxTrees =1000,feature_names=predictors )\n",
    "xgb_explain = pd.read_excel('./XgbFeatureInteractions.xlsx')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print xgb_explain.sort_values('Gain').iloc[::-1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "plt.plot(customer_info_orders2['mean_log_rev_train'],customer_info_orders2['target5'],'ro',markersize=0.5)\n",
    "plt.xlabel('mean revenue from month 1-5',weight='bold',fontsize=12)\n",
    "plt.ylabel('mean revenue from month 7-12',weight='bold',fontsize=12)\n",
    "plt.title('Past revenue vs future revenue',weight='bold',fontsize=12)\n",
    "plt.xticks(range(5),[10**x for x in range(5)])\n",
    "plt.yticks(range(5),[10**x for x in range(5)])\n",
    "plt.show()\n",
    "plt.close()\n",
    "plt.plot(np.log10(1+customer_info_orders2['Revenue_2011_3']),customer_info_orders2['target5'],'ro',markersize=0.5)\n",
    "plt.xlabel('mean revenue from month 3',weight='bold',fontsize=12)\n",
    "plt.ylabel('mean revenue from month 7-12',weight='bold',fontsize=12)\n",
    "plt.title('Month 4 vs future revenue',weight='bold',fontsize=12)\n",
    "plt.xticks(range(5),[10**x for x in range(5)])\n",
    "plt.yticks(range(5),[10**x for x in range(5)])\n",
    "plt.show()\n",
    "plt.plot(np.log10(1+customer_info_orders2['Revenue_2011_4']),\n",
    "         np.log10(1+customer_info_orders2['Revenue_2011_5']),'ro',markersize=0.5)\n",
    "plt.xlabel('mean revenue from month 3',weight='bold',fontsize=12)\n",
    "plt.ylabel('mean revenue from month 7-12',weight='bold',fontsize=12)\n",
    "plt.title('Month 4 vs future revenue',weight='bold',fontsize=12)\n",
    "plt.xticks(range(5),[10**x for x in range(5)])\n",
    "plt.yticks(range(5),[10**x for x in range(5)])\n",
    "plt.show()\n",
    "plt.plot(customer_info_orders2['svd_0'],1+customer_info_orders2['Revenue_2011_5'],'ro',markersize=0.5)\n",
    "plt.xlabel('mean revenue from month 3',weight='bold',fontsize=12)\n",
    "plt.ylabel('mean revenue from month 7-12',weight='bold',fontsize=12)\n",
    "plt.title('Month 4 vs future revenue',weight='bold',fontsize=12)\n",
    "#plt.xticks(range(5),[10**x for x in range(5)])\n",
    "plt.yscale('log')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "col = ['r','m','b','g'][::-1]\n",
    "percentile = [(0,1),(1,5),(5,20),(20,100)][::-1]\n",
    "size= [3,2,1,0.3][::-1]\n",
    "labels = ['Top 1% contributing 32% rev','1-5%, 18% Rev','5-20%, 25% Rev','20-100%, 25% Rev'][::-1]\n",
    "temp = customer_info_orders[customer_info_orders['mean_log_rev_train'] >0].sort_values('mean_log_rev_train').iloc[::-1].reset_index(drop=True)\n",
    "for i in range(4):\n",
    "    a,b = 0.01*len(temp)*percentile[i][0],0.01*len(temp)*percentile[i][1]\n",
    "    a,b = int(a),int(b)\n",
    "    plt.plot(temp['svd_0'].iloc[a:b],temp['svd_1'].iloc[a:b],'o',\n",
    "             color=col[i],markersize=size[i],label=labels[i])\n",
    "    print len(temp['svd_0'].iloc[a:b])\n",
    "plt.ylim(-0.25,0.4)\n",
    "plt.legend()\n",
    "plt.title('Looks like two clusters, inside and outside')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "num = np.array([0,1])\n",
    "U2=U[:,num]\n",
    "D2=D[num]\n",
    "V2=V[num]\n",
    "\n",
    "Customer_embeddings = U2\n",
    "Product_embeddings = V2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.plot(range(len(V2[0,:])),V2[1,:],'ro',markersize=.5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#get products closest to clusters inside\n",
    "cluster_inside = np.array([[-0.025,0.1]])\n",
    "closest_to_inside = np.argsort(np.matmul(cluster_inside,V2)[0,:])[::-1]\n",
    "stock_code_decribe = data2.groupby('StockCode_NR_int')['Description'].apply(np.unique).reset_index(drop=False)\n",
    "closest_pdts = closest_to_inside[:10]\n",
    "print 'products...'\n",
    "print stock_code_decribe[stock_code_decribe.StockCode_NR_int.isin(closest_pdts)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#get products closest to clusters outside (impt customers)\n",
    "cluster_outside = np.array([[-0.125,-0.1]])\n",
    "closest_to_outside = np.argsort(np.matmul(cluster_outside,V2)[0,:])[::-1]\n",
    "stock_code_decribe = data2.groupby('StockCode_NR_int')['Description'].apply(np.unique).reset_index(drop=False)\n",
    "closest_pdts = closest_to_outside[:10]\n",
    "print 'products...'\n",
    "print stock_code_decribe[stock_code_decribe.StockCode_NR_int.isin(closest_pdts)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#get products closest to clusters outside (impt customers)\n",
    "cluster_outside = np.array([[-0.025,-0.1]])\n",
    "closest_to_outside = np.argsort(np.matmul(cluster_outside,V2)[0,:])[::-1]\n",
    "stock_code_decribe = data2.groupby('StockCode_NR_int')['Description'].apply(np.unique).reset_index(drop=False)\n",
    "closest_pdts = closest_to_outside[:10]\n",
    "print 'products...'\n",
    "print stock_code_decribe[stock_code_decribe.StockCode_NR_int.isin(closest_pdts)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "stock_code_decribe = data2.groupby('StockCode_NR_int')['Description'].apply(np.unique).reset_index(drop=False)\n",
    "closest_pdts = closest_to_inside[:10]\n",
    "print 'products...'\n",
    "print stock_code_decribe[stock_code_decribe.StockCode_NR_int.isin(closest_pdts)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.hist(dtest['mean_log_rev_train'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.hist(customer_info_orders['target']);\n",
    "plt.yscale('log');plt.yscale('log');plt.show();plt.close()\n",
    "plt.hist(customer_info_orders['target4']);\n",
    "plt.yscale('log');plt.yscale('log');plt.show();plt.close()\n",
    "plt.hist(customer_info_orders['target3']);\n",
    "plt.yscale('log');plt.yscale('log');plt.show();plt.close()\n",
    "plt.hist(model.predict(xgtest3));\n",
    "plt.yscale('log');plt.yscale('log');plt.show();plt.close()\n",
    "\n",
    "\n",
    "plt.plot(10**model.predict(xgtest2)-1,10**customer_info_orders['target5']-1,'ro',markersize=1);\n",
    "plt.xscale('log');plt.yscale('log');plt.xlabel('Prediction');plt.ylabel('Actual')\n",
    "plt.show();plt.close()\n",
    "plt.plot(10**model.predict(xgtest2)-1,10**customer_info_orders['target2']-1,'go',markersize=1);\n",
    "plt.xscale('log');plt.yscale('log');plt.xlabel('Prediction');plt.ylabel('Actual')\n",
    "plt.show();plt.close()\n",
    "#plt.plot(model.predict(xgtest3),customer_info_orders['target4'],'bo')\n",
    "#plt.plot(model.predict(xgtest3),customer_info_orders['target5'],'yo')\n",
    "#plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.cluster import KMeans\n",
    "df = customer_info_orders[['svd_'+str(x) for x in range(50) ]]\n",
    "for num in range(2,6):\n",
    "    kmeans = KMeans(n_clusters=num).fit(df)\n",
    "    centroids = kmeans.cluster_centers_\n",
    "    total_ss = np.sum((df.values-np.mean(df.values,0))**2)\n",
    "    unexplained_ss = 0\n",
    "    for i in range(num):\n",
    "        unexplained_ss += np.sum((df[kmeans.labels_==i].values-centroids[i])**2)\n",
    "    print unexplained_ss/total_ss\n",
    "    customer_info_orders['kmeans'] = kmeans.labels_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.hist(np.sum(df**2,1));plt.yscale('log');plt.xscale('log');plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#kmeans does not look sucesful"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#print model.get_fscore()\n",
    "#print predictors\n",
    "print sorted([(model.get_fscore()['f'+str(x)],predictors[x]) for x in range(len(predictors))])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders[customer_info_orders['kmeans']!=0]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders[customer_info_orders['kmeans']!=110].groupby('kmeans')['TotalRevenue'].apply(np.mean)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from collections import Counter\n",
    "Counter(kmeans.labels_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders[[x for x in  customer_info_orders.keys() if 'reve' in str(x).lower()]].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#usinf predictions to predict instead"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders['predict']=model.predict(xgtest2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders['error'] = np.abs(model.predict(xgtest2)-customer_info_orders['target5'].values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.plot(10** model.predict(xgtest2)-1,10**customer_info_orders[['target5']]-1,'ro',markersize=0.8);\n",
    "plt.yscale('log');plt.xscale('log');plt.show()\n",
    "plt.plot(customer_info_orders[['target5']],customer_info_orders[['error']],'ro',markersize=0.8);\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_info_orders['target5_equal0'] = customer_info_orders['target5'] ==0 \n",
    "customer_info_orders.groupby('target5_equal0')['error'].apply(lambda x : (np.mean(x),np.std(x)))\n",
    "#possibly predict which custoemrs will fall out\n",
    "#or possibly try to see why large customers fall, Top 20 percent of customers,75.0 percent of profit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "np.array(temp.values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#group of customers where the model is predicting poorly\n",
    "var = 'predict'\n",
    "customer_info_orders['target5_1dp'] = np.round(customer_info_orders['target5']*4,0)/4\n",
    "customer_info_orders['target5_1dp'] = (customer_info_orders['target5_1dp'] <3.75) * customer_info_orders['target5_1dp']  + (customer_info_orders['target5_1dp'] >3.75) *4 \n",
    "temp = customer_info_orders.groupby('target5_1dp')[var].apply(lambda x : (np.mean(x),np.std(x)/len(x)**.5,len(x))).reset_index(drop=False)\n",
    "print temp\n",
    "plt.errorbar(temp['target5_1dp'],[x[0] for x in temp[var]],yerr=[x[1] for x in temp[var]])\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# looking at the top20% for the first half and see which ones did not make it in second half\n",
    "#later\n",
    "customer_info_orders['Rev_first_half'] = np.mean(customer_info_orders[[x for x in customer_info_orders.keys() if 'Revenue_' in str(x)][:6]],1)\n",
    "customer_info_orders['Rev_second_half'] = np.mean(customer_info_orders[[x for x in customer_info_orders.keys() if 'Revenue_' in str(x)][6:]],1)\n",
    "customer_info_orders['Rev_future'] = (1*(customer_info_orders['Rev_second_half'] > customer_info_orders['Rev_first_half']))\n",
    "#customer_info_orders['Rev_future'] = np.log10(1+np.abs(customer_info_orders['Rev_future']))*np.sign(customer_info_orders['Rev_future'])\n",
    "\n",
    "\n",
    "colsA =  ['Revenue_2011_' + str(x) for x in [1,2,3,4,5]]+['Revenue_2010_12']\n",
    "customer_info_orders['mean_log_rev_firsthalf']= np.log10(1+np.mean(customer_info_orders[colsA].values,1))\n",
    "\n",
    "for i in ['Revenue_2011_' + str(x) for x in [1,2,3,4,5]]+['Revenue_2010_12']:\n",
    "    customer_info_orders['log_r'+i[1:]] = np.log10(1+customer_info_orders[i])\n",
    "\n",
    "predictors = ['log_r'+i[1:] for i in list(customer_info_orders.keys()[3:9])]+ ['mean_log_rev_firsthalf','constant']+\\\n",
    "                 list([x for x in customer_info_orders.keys() if 'svd' in str(x)]) [:00] \n",
    "\n",
    "target= 'Rev_future'\n",
    "\n",
    "import statsmodels.formula.api as smf\n",
    "\n",
    "#print predictors\n",
    "customer_info_orders['constant']=1\n",
    "customer_info_orders2 = customer_info_orders[customer_info_orders['Rev_first_half']!=0].reset_index(drop=True)\n",
    "#customer_info_orders2 = customer_info_orders2.sort_values(target).reset_index(drop=True)\n",
    "z = customer_info_orders2[['pdt_'+str(x) for x in range(100)]].describe().loc['mean']\n",
    "predictors += list(z[z>0.03].index)\n",
    "dtrain = customer_info_orders2\n",
    "train_id = [x for x in range(len(dtrain)) if x%5!=0]\n",
    "test_id = [x for x in range(len(dtrain)) if x%5==0]\n",
    "dtrain1 = customer_info_orders2.iloc[train_id].reset_index(drop=True)\n",
    "dtrain2 = customer_info_orders2.iloc[test_id].reset_index(drop=True)\n",
    "#print customer_info_orders2[[target,'Rev_first_half','Rev_second_half']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "plt.hist(customer_info_orders2[target])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "import sklearn\n",
    "from sklearn.metrics import roc_auc_score\n",
    "\n",
    "import statsmodels.api as sm\n",
    "for alpha in [0.02,0.025,0.03,0.04][:1]:\n",
    "    if alpha!=0.0511:\n",
    "        dtrain_scaled = (dtrain[predictors]-np.mean(dtrain[predictors].values,0))/np.std(dtrain[predictors].values,0)\n",
    "        dtrain1_scaled = (dtrain1[predictors]-np.mean(dtrain1[predictors].values,0))/np.std(dtrain1[predictors].values,0)\n",
    "        dtrain2_scaled = (dtrain2[predictors]-np.mean(dtrain1[predictors].values,0))/np.std(dtrain1[predictors].values,0)\n",
    "        dtrain_scaled['constant'] = 1\n",
    "        dtrain1_scaled['constant'] = 1\n",
    "        dtrain2_scaled['constant'] = 1\n",
    "        predictors_noNan = np.array(predictors)[~dtrain1_scaled.describe().loc['mean'].isnull()]\n",
    "        model = sm.GLM(dtrain1[target],dtrain1_scaled[predictors_noNan],family=sm.families.Binomial()).fit_regularized(alpha= alpha)\n",
    "        predictors_nonZero = list(predictors_noNan[model.params!=0])\n",
    "        model_unbias = sm.GLM(dtrain1[target],dtrain1_scaled[predictors_nonZero],family=sm.families.Binomial()).fit()\n",
    "        model_unbias_full = sm.GLM(dtrain[target],dtrain_scaled[predictors_nonZero],family=sm.families.Binomial()).fit()\n",
    "        print  alpha,len(predictors_nonZero)\n",
    "        print 'train R2',roc_auc_score(dtrain1[target],model_unbias.predict(dtrain1_scaled[predictors_nonZero]))\n",
    "        print 'test R2',roc_auc_score(dtrain2[target],model_unbias.predict(dtrain2_scaled[predictors_nonZero]))\n",
    "        print model_unbias_full.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# products associated with improved spending in future\n",
    "print 'products associated with positive future revenue...'\n",
    "print model_unbias_full.params[model_unbias_full.params>0]\n",
    "stock_code_decribe = data2.groupby('StockCode_NR_int')['Description'].apply(np.unique).reset_index(drop=False)\n",
    "pos_params = model_unbias_full.params[model_unbias_full.params>0]\n",
    "pos_params = [int(x.split('_')[1]) for x in pos_params.index if 'pdt' in x]\n",
    "print 'products...'\n",
    "print stock_code_decribe[stock_code_decribe.StockCode_NR_int.isin(pos_params)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# products associated with improved spending in future\n",
    "print 'products associated with negative future revenue...'\n",
    "print model_unbias_full.params[model_unbias_full.params<0]\n",
    "stock_code_decribe = data2.groupby('StockCode_NR_int')['Description'].apply(np.unique).reset_index(drop=False)\n",
    "neg_params = model_unbias_full.params[model_unbias_full.params<0]\n",
    "neg_params = [int(x.split('_')[1]) for x in neg_params.index if 'pdt' in x]\n",
    "print 'products...'\n",
    "print stock_code_decribe[stock_code_decribe.StockCode_NR_int.isin(neg_params)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# looking at top 20% customers which consistute 75% revenue"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# looking at the top20% for the first half and see which ones did not make it in second half\n",
    "#later\n",
    "customer_info_orders['Rev_first_half'] = np.mean(customer_info_orders[[x for x in customer_info_orders.keys() if 'Revenue_' in str(x)][:6]],1)\n",
    "customer_info_orders['Rev_second_half'] = np.mean(customer_info_orders[[x for x in customer_info_orders.keys() if 'Revenue_' in str(x)][6:]],1)\n",
    "customer_info_orders['Rev_future'] = (1*(customer_info_orders['Rev_second_half'] > customer_info_orders['Rev_first_half']))\n",
    "#customer_info_orders['Rev_future'] = np.log10(1+np.abs(customer_info_orders['Rev_future']))*np.sign(customer_info_orders['Rev_future'])\n",
    "\n",
    "\n",
    "colsA =  ['Revenue_2011_' + str(x) for x in [1,2,3,4,5]]+['Revenue_2010_12']\n",
    "customer_info_orders['mean_log_rev_firsthalf']= np.log10(1+np.mean(customer_info_orders[colsA].values,1))\n",
    "\n",
    "for i in ['Revenue_2011_' + str(x) for x in [1,2,3,4,5]]+['Revenue_2010_12']:\n",
    "    customer_info_orders['log_r'+i[1:]] = np.log10(1+customer_info_orders[i])\n",
    "\n",
    "predictors = ['log_r'+i[1:] for i in list(customer_info_orders.keys()[3:9])]+ ['mean_log_rev_firsthalf','constant']+\\\n",
    "                 list([x for x in customer_info_orders.keys() if 'svd' in str(x)]) [:00] \n",
    "\n",
    "target= 'Rev_future'\n",
    "\n",
    "import statsmodels.formula.api as smf\n",
    "\n",
    "#print predictors\n",
    "customer_info_orders['constant']=1\n",
    "customer_info_orders2 = customer_info_orders[customer_info_orders['Rev_first_half']!=0].reset_index(drop=True)\n",
    "#customer_info_orders2 = customer_info_orders2.sort_values(target).reset_index(drop=True)\n",
    "\n",
    "\n",
    "z = customer_info_orders2[['pdt_'+str(x) for x in range(50)]].describe().loc['mean']\n",
    "predictors += list(z[z>0.05].index)\n",
    "customer_info_orders2 = customer_info_orders2.sort_values('TotalRevenue').iloc[-2*135:]\n",
    "dtrain = customer_info_orders2\n",
    "train_id = [x for x in range(len(dtrain)) if x%5!=0]\n",
    "test_id = [x for x in range(len(dtrain)) if x%5==0]\n",
    "dtrain1 = customer_info_orders2.iloc[train_id].reset_index(drop=True)\n",
    "dtrain2 = customer_info_orders2.iloc[test_id].reset_index(drop=True)\n",
    "#print customer_info_orders2[[target,'Rev_first_half','Rev_second_half']]\n",
    "plt.hist(customer_info_orders2[target])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "predictors_nonZero"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sklearn\n",
    "from sklearn.metrics import roc_auc_score\n",
    "\n",
    "import statsmodels.api as sm\n",
    "for alpha in [0.07,][:]:\n",
    "    if alpha!=0.0511:\n",
    "        dtrain_scaled = (dtrain[predictors]-np.mean(dtrain[predictors].values,0))/np.std(dtrain[predictors].values,0)\n",
    "        dtrain1_scaled = (dtrain1[predictors]-np.mean(dtrain1[predictors].values,0))/np.std(dtrain1[predictors].values,0)\n",
    "        dtrain2_scaled = (dtrain2[predictors]-np.mean(dtrain1[predictors].values,0))/np.std(dtrain1[predictors].values,0)\n",
    "        dtrain_scaled['constant'] = 1\n",
    "        dtrain1_scaled['constant'] = 1\n",
    "        dtrain2_scaled['constant'] = 1\n",
    "        predictors_noNan = np.array(predictors)[~dtrain1_scaled.describe().loc['mean'].isnull()]\n",
    "        model = sm.GLM(dtrain1[target],dtrain1_scaled[predictors_noNan],family=sm.families.Binomial()).fit_regularized(alpha= alpha)\n",
    "        predictors_nonZero = list(predictors_noNan[model.params!=0])\n",
    "        model_unbias = sm.GLM(dtrain1[target],dtrain1_scaled[predictors_nonZero],family=sm.families.Binomial()).fit()\n",
    "        model_unbias_full = sm.GLM(dtrain[target],dtrain_scaled[predictors_nonZero],family=sm.families.Binomial()).fit()\n",
    "        print  alpha,len(predictors_nonZero)\n",
    "        print 'train R2',roc_auc_score(dtrain1[target],model_unbias.predict(dtrain1_scaled[predictors_nonZero]))\n",
    "        print 'test R2',roc_auc_score(dtrain2[target],model_unbias.predict(dtrain2_scaled[predictors_nonZero]))\n",
    "        print model_unbias_full.summary()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python (python27)",
   "language": "python",
   "name": "python27"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
