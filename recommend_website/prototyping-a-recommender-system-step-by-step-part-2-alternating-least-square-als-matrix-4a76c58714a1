<!doctype html><html lang="en"><head><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title data-rh="true">Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix Factorization in Collaborative Filtering</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-11-19T08:33:49.342Z"/><meta data-rh="true" name="title" content="Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix Factorization in Collaborative Filtering"/><meta data-rh="true" property="og:title" content="Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix Factorization in Collaborative Filtering"/><meta data-rh="true" property="twitter:title" content="Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix Factorization in Collaborative Filtering"/><meta data-rh="true" name="twitter:site" content="@TDataScience"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/4a76c58714a1"/><meta data-rh="true" property="al:android:url" content="medium://p/4a76c58714a1"/><meta data-rh="true" property="al:ios:url" content="medium://p/4a76c58714a1"/><meta data-rh="true" name="apple-itunes-app" content="app-id=828256236,app-argument=medium://p/4a76c58714a1"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In the last post, we covered a lot of ground in how to build our own recommender systems and got our hand dirty with Pandas and Scikit-learn to implement a KNN item-based collaborative filtering…"/><meta data-rh="true" property="og:description" content="In the last post, we covered a lot of ground in how to build our own recommender systems. We also got our hand dirty with Pandas and…"/><meta data-rh="true" property="twitter:description" content="In the last post, we covered a lot of ground in how to build our own recommender systems. We also got our hand dirty with Pandas and…"/><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/prototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1"/><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/prototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*EZu5sHcoyDhsRC00C9ZCTg.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*EZu5sHcoyDhsRC00C9ZCTg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="/@keliao"/><meta data-rh="true" name="author" content="Kevin Liao"/><meta data-rh="true" name="robots" content="index,follow"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="9 min read"/><link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"/><link data-rh="true" rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"/><link data-rh="true" rel="author" href="/@keliao"/><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/prototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/4a76c58714a1"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":105,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F210\u002F1*EZu5sHcoyDhsRC00C9ZCTg.png"},"thumbnailUrl":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F210\u002F1*EZu5sHcoyDhsRC00C9ZCTg.png","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1","dateCreated":"2018-11-17T08:34:18.344Z","datePublished":"2018-11-17T08:34:18.344Z","dateModified":"2018-11-19T08:33:49.342Z","headline":"Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix…","name":"Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix…","articleId":"4a76c58714a1","keywords":["Lite:true","Tag:Machine Learning","Tag:Data Science","Tag:Recommendation System","Tag:Distributed Systems","Tag:Spark","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:4"],"author":{"@type":"Person","name":"Kevin Liao","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@keliao"},"creator":["Kevin Liao"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":161,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F322\u002F1*5EUO1kUYBthpOCPzRj_l2g.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1"}</script><script data-rh="true" >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><style type="text/css" data-fela-rehydration="359" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.n{display:block}.o{position:fixed}.p{top:0}.q{left:0}.r{right:0}.s{z-index:500}.t{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.u{transition:transform 300ms ease}.v{will-change:transform}.x{padding-left:24px}.y{padding-right:24px}.z{margin-left:auto}.ab{margin-right:auto}.ac{height:65px}.ae{width:100%}.af{max-width:1080px}.ag{box-sizing:border-box}.ah{display:flex}.ai{align-items:center}.al{flex:1 0 auto}.am{margin-left:-6px}.an{fill:rgba(0, 0, 0, 0.84)}.ao{flex:0 0 auto}.ap{margin-left:16px}.aq{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.ar{font-style:normal}.as{line-height:20px}.at{font-size:15.8px}.au{letter-spacing:0px}.av{color:rgba(0, 0, 0, 0.54)}.aw{fill:rgba(0, 0, 0, 0.54)}.ax{color:rgba(90, 118, 144, 1)}.ay{fill:rgba(102, 138, 170, 1)}.az{font-size:inherit}.ba{border:inherit}.bb{font-family:inherit}.bc{letter-spacing:inherit}.bd{font-weight:inherit}.be{padding:0}.bf{margin:0}.bg:hover{cursor:pointer}.bh:hover{color:rgba(84, 108, 131, 1)}.bi:hover{fill:rgba(90, 118, 144, 1)}.bj:focus{outline:none}.bk:disabled{cursor:default}.bl:disabled{color:rgba(3, 168, 124, 0.5)}.bm:disabled{fill:rgba(3, 168, 124, 0.5)}.bn{padding:8px 16px}.bo{background:0}.bp{border-color:rgba(102, 138, 170, 1)}.bq:hover{border-color:rgba(90, 118, 144, 1)}.br{border-radius:4px}.bs{border-width:1px}.bt{border-style:solid}.bu{display:inline-block}.bv{text-decoration:none}.bw{border-top:none}.bx{background-color:rgba(53, 88, 118, 1)}.bz{height:54px}.ca{overflow:hidden}.cb{margin-right:40px}.cc{height:36px}.cd{width:97px}.ce{overflow:auto}.cf{flex:0 1 auto}.cg{list-style-type:none}.ch{line-height:40px}.ci{white-space:nowrap}.cj{overflow-x:auto}.ck{align-items:flex-start}.cl{margin-top:20px}.cm{padding-top:20px}.cn{height:80px}.co{height:20px}.cp{margin-right:15px}.cq{margin-left:15px}.cr:first-child{margin-left:0}.cs{min-width:1px}.ct{background-color:rgba(197, 210, 225, 1)}.cu{font-weight:300}.cv{font-size:15px}.cw{line-height:21px}.cx{color:rgba(197, 210, 225, 1)}.cy{text-transform:uppercase}.cz{letter-spacing:1px}.da{color:inherit}.db{fill:inherit}.dc:hover{color:rgba(251, 255, 255, 1)}.dd:hover{fill:rgba(233, 241, 250, 1)}.de:disabled{color:rgba(150, 171, 191, 1)}.df:disabled{fill:rgba(150, 171, 191, 1)}.dg{margin-bottom:0px}.dh{height:119px}.dk{padding-bottom:1px}.dl{margin-top:40px}.dm{max-width:728px}.dn{opacity:0}.do{pointer-events:none}.dp{will-change:opacity}.dq{transition:opacity 200ms}.dr{width:131px}.ds{left:50%}.dt{transform:translateX(-516px)}.du{top:calc(65px + 54px + 40px)}.dv{flex-direction:column}.dw{padding-bottom:28px}.dx{border-bottom:1px solid rgba(0, 0, 0, 0.1)}.dy:hover{color:rgba(0, 0, 0, 0.9)}.dz:hover{fill:rgba(0, 0, 0, 0.9)}.ea:disabled{color:rgba(0, 0, 0, 0.54)}.eb:disabled{fill:rgba(0, 0, 0, 0.54)}.ec{font-weight:600}.ed{font-size:18px}.ee{color:rgba(0, 0, 0, 0.84)}.ef{padding-bottom:20px}.eg{padding-top:2px}.eh{font-size:16px}.ei{max-height:120px}.ej{text-overflow:ellipsis}.ek{display:-webkit-box}.el{-webkit-line-clamp:6}.em{-webkit-box-orient:vertical}.en{padding:4px 12px}.eo{padding-top:28px}.ep{margin-bottom:19px}.eq{margin-left:-5px}.er{margin-right:5px}.es{position:relative}.et{outline:0}.eu{border:0}.ev{user-select:none}.ew{cursor:pointer}.ex> svg{pointer-events:none}.ey:active{border-style:none}.ez:focus{fill:rgba(90, 118, 144, 1)}.fa{margin-top:5px}.fb button{text-align:left}.fc{clear:both}.fd{justify-content:center}.fe{margin-right:8px}.ff{margin-bottom:8px}.fg{border-radius:3px}.fh{padding:5px 10px}.fi{background:rgba(0, 0, 0, 0.05)}.fj{line-height:22px}.fk{justify-content:space-between}.fl{margin-top:15px}.fm{margin-right:16px}.fn{border:1px solid rgba(0, 0, 0, 0.1)}.fo{border-radius:50%}.fp{height:60px}.fq{transition:border-color 150ms ease}.fr{width:60px}.fs::before{background:
      radial-gradient(circle, rgba(90, 118, 144, 1) 60%, transparent 70%)
    }.ft::before{border-radius:50%}.fu::before{content:""}.fv::before{display:block}.fw::before{z-index:0}.fx::before{left:0}.fy::before{height:100%}.fz::before{position:absolute}.ga::before{top:0}.gb::before{width:100%}.gc:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.gd:active{border-style:solid}.ge{background:rgba(255, 255, 255, 1)}.gf{z-index:2}.gg{height:100%}.gh{position:absolute}.gi{padding-right:8px}.gj{display:none}.gk{padding-top:32px}.gl{border-top:1px solid rgba(0, 0, 0, 0.1)}.gm{margin-bottom:25px}.gn{margin-top:25px}.go{margin-bottom:32px}.gp{min-height:80px}.gu{width:80px}.gv{padding-left:102px}.gx{letter-spacing:0.05em}.gy{margin-bottom:6px}.gz{font-size:28px}.ha{line-height:36px}.hb{border-color:rgba(0, 0, 0, 0.54)}.hc:hover{color:rgba(0, 0, 0, 0.97)}.hd:hover{fill:rgba(0, 0, 0, 0.97)}.he:hover{border-color:rgba(0, 0, 0, 0.84)}.hf:disabled{fill:rgba(0, 0, 0, 0.76)}.hg:disabled{border-color:rgba(0, 0, 0, 0.2)}.hh:disabled{cursor:inherit}.hi:disabled:hover{color:rgba(0, 0, 0, 0.54)}.hj:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.hk:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.hl{max-width:555px}.hm{max-width:450px}.hn{line-height:24px}.hp{max-width:550px}.hq{padding-top:25px}.hr{padding:20px}.hs{border:1px solid rgba(102, 138, 170, 1)}.ht{text-align:center}.hu{margin-top:64px}.hv{background-color:rgba(0, 0, 0, 0.02)}.hw{top:calc(100vh + 100px)}.hx{bottom:calc(100vh + 100px)}.hy{width:10px}.hz{word-break:break-word}.ia{word-wrap:break-word}.ib:after{display:block}.ic:after{content:""}.id:after{clear:both}.ie{margin:0 auto}.if{line-height:1.23}.ig{letter-spacing:0}.ih{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.ii{font-size:40px}.io{margin-bottom:-0.27em}.ip{line-height:48px}.iq{margin-top:32px}.ir{height:48px}.is{width:48px}.it{margin-left:12px}.iu{margin-bottom:2px}.iw{max-height:20px}.ix{-webkit-line-clamp:1}.iy:hover{text-decoration:underline}.iz{margin-left:8px}.ja{padding:0px 8px}.jb{line-height:18px}.jh{max-width:781px}.ji{transition:opacity 100ms 400ms}.jj{transform:translateZ(0)}.jk{margin:auto}.jl{background-color:rgba(0, 0, 0, 0.05)}.jm{padding-bottom:56.978233034571055%}.jn{filter:blur(20px)}.jo{transform:scale(1.1)}.jp{line-height:1.4}.jq{margin-top:10px}.js{line-height:1.58}.jt{letter-spacing:-0.004em}.ju{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.kf{margin-bottom:-0.46em}.kg{font-style:italic}.kh{background-repeat:repeat-x}.ki{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.kj{background-size:1px 1px}.kk{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.kl{font-weight:700}.km{line-height:1.12}.kn{letter-spacing:-0.022em}.ky{margin-bottom:-0.28em}.kz{max-width:1910px}.la{padding-bottom:33.61256544502618%}.lb{list-style-type:disc}.lc{margin-left:30px}.ld{padding-left:0px}.lj{padding:2px 4px}.lk{font-size:75%}.ll{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.lm{max-width:1922px}.ln{padding-bottom:51.92507804370448%}.lt{max-width:1686px}.lu{padding-bottom:40.68801897983393%}.lv{list-style-type:decimal}.lw{max-width:338px}.lx{padding-bottom:34.9112426035503%}.ly{max-width:800px}.lz{padding-bottom:71.375%}.ma{padding-bottom:14.90909090909091%}.mb{max-width:1280px}.mc{padding-bottom:56.25%}.md{max-width:1846px}.me{padding-bottom:40.736728060671716%}.mf{padding-bottom:NaN%}.mg{line-height:1.18}.mh{margin-top:-0.09em}.mi{margin-bottom:-0.09em}.mj{white-space:pre-wrap}.mk{max-width:2100px}.ml{margin-left:24px}.mm{margin-right:24px}.mn{padding-bottom:18%}.mo{font-family:medium-content-slab-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.mp{border:none}.mq{margin-top:30px}.mr:before{content:"..."}.ms:before{letter-spacing:0.6em}.mt:before{text-indent:0.6em}.mu:before{font-style:italic}.mv:before{line-height:1.4}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (max-width: 1256px)">.d{display:none}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (max-width: 1080px)">.e{display:none}.jr{text-align:center}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (max-width: 904px)">.f{display:none}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (max-width: 728px)">.g{display:none}.aj{height:56px}.ak{display:flex}.by{display:block}.di{margin-bottom:0px}.dj{height:110px}.gq{margin-bottom:24px}.gr{align-items:center}.gs{width:102px}.gt{position:relative}.gw{padding-left:0}.ho{margin-top:24px}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (max-width: 552px)">.h{display:none}.iv{margin-bottom:0px}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (min-width: 1080px)">.i{display:none}.in{margin-top:0.78em}.jg{margin-top:56px}.kd{font-size:21px}.ke{margin-top:2em}.kw{font-size:34px}.kx{margin-top:1.95em}.li{margin-top:1.05em}.ls{margin-top:0.86em}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.j{display:none}.im{margin-top:0.78em}.jf{margin-top:56px}.kb{font-size:21px}.kc{margin-top:2em}.ku{font-size:34px}.kv{margin-top:1.95em}.lh{margin-top:1.05em}.lr{margin-top:0.86em}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.k{display:none}.il{margin-top:0.78em}.je{margin-top:56px}.jz{font-size:21px}.ka{margin-top:2em}.ks{font-size:34px}.kt{margin-top:1.95em}.lg{margin-top:1.05em}.lq{margin-top:0.86em}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.l{display:none}.ik{margin-top:0.39em}.jd{margin-top:40px}.jx{font-size:18px}.jy{margin-top:1.56em}.kq{font-size:30px}.kr{margin-top:1.2em}.lf{margin-top:1.34em}.lp{margin-top:0.67em}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="all and (max-width: 551.98px)">.m{display:none}.ij{margin-top:0.39em}.jc{margin-top:40px}.jv{font-size:18px}.jw{margin-top:1.56em}.ko{font-size:30px}.kp{margin-top:1.2em}.le{margin-top:1.34em}.lo{margin-top:0.67em}</style><style type="text/css" data-fela-rehydration="359" data-fela-type="RULE" media="print">.w{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k l m"></div><nav class="n o p q r c s t u v w"><div class="branch-journeys-top"><div class="n c"><section class="x y z ab ac ae af ag ah ai aj ak"><div class="ah ai al s"><div class="am n"><a href="https://medium.com/?source=post_page---------------------------" aria-label="Homepage"><svg width="45" height="45" viewBox="0 0 45 45" class="an"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></a></div></div><div class="n ao s"><div class="ah ai"><div class="ah g"><div class="ap n"><span class="aq b ar as at au n av aw"><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1&amp;source=post_page--------------------------nav_reg-" class="ax ay az ba bb bc bd be bf bg bh bi bj bk bl bm">Sign in</a></span></div></div><div class="ap n"><button class="bn bo ax ay bp bh bi bq bg br aq b ar as at au bs bt ag bu bv bj">Get started</button></div></div></div></section></div><div class="bw n bx by"><section class="x y z ab bz ae af ag ca ah ai"><div class="cb n ao"><a href="https://towardsdatascience.com/?source=post_page---------------------------"><div class="cc cd n"><img alt="Towards Data Science" src="https://miro.medium.com/max/194/1*5EUO1kUYBthpOCPzRj_l2g.png" class="" width="97" height="36"/></div></a></div><div class="ce n cf"><ul class="cg bf ch ci cj ah ck g cl cm cn"><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/data-science/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">Data Science</a></span></li><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/machine-learning/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">Machine Learning</a></span></li><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/programming/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">Programming</a></span></li><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/data-visualization/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">Visualization</a></span></li><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/artificial-intelligence/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">AI</a></span></li><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/data-journalism/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">Journalism</a></span></li><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a class="da db az ba bb bc bd be bf bg dc dd bj bk de df" href="/toronto-machine-learning-summit-8bae371d4bb1?source=post_page---------------------------">Events</a></span></li><span class="co cs ct"></span><li class="ah ai co cp cq cr"><span class="aq cu cv cw cx cy cz"><a href="https://towardsdatascience.com/contribute/home?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg dc dd bj bk de df">Submit</a></span></li></ul></div></section></div></div></nav><div class="dg dh n di dj"></div><article><div class="dk dl n"><section class="x y z ab ae dm ag n"></section></div><span class="n"></span><div><div class="gh q hw hx hy do"></div><section class="hz ia ib ic id"><div class="ag ie ae dm x y"><div><div id="98e4" class="if ig ee ar ih b ii ij ik il im in io"><h1 class="ih b ii ip ee">Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix Factorization in Collaborative Filtering</h1></div><div class="iq"><div class="ai ah"><div><a href="/@keliao?source=post_page---------------------------"><img alt="Kevin Liao" src="https://miro.medium.com/fit/c/96/96/1*CTPk1L9tt53nOR4MH6dxPQ.jpeg" class="n fo ir is" width="48" height="48"/></a></div><div class="it ae n"><div class="ah"><div style="flex:1"><span class="aq b ar as at au n ee an"><div class="iu ah ai iv" data-test-id="postByline"><span class="aq cu eh as ca iw ej ek ix em ee"><a href="/@keliao?source=post_page---------------------------" class="da db az ba bb bc bd be bf bg iy bj bk ea eb">Kevin Liao</a></span><div class="iz n ao h"><button class="ja ee an bo hb hc hd he bg ea hf hg hh hi hj hk br aq b ar jb cv au bs bt ag bu bv bj">Follow</button></div></div></span></div></div><span class="aq b ar as at au n av aw"><span class="aq cu eh as ca iw ej ek ix em av"><div><a class="da db az ba bb bc bd be bf bg iy bj bk ea eb" href="/prototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1?source=post_page---------------------------">Nov 17, 2018</a> <!-- -->·<!-- --> <!-- -->9<!-- --> min read</div></span></span></div></div></div></div><figure class="jc jd je jf jg fc jh z ab paragraph-image"><div class="jk n es jl"><div class="jm n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*EZu5sHcoyDhsRC00C9ZCTg.png?q=20" class="gh p q gg ae jn jo" width="700" height="399"/></div><img class="dn ji gh p q gg ae ge" width="700" height="399"/><noscript><img src="https://miro.medium.com/max/1400/1*EZu5sHcoyDhsRC00C9ZCTg.png" class="gh p q gg ae" width="700" height="399"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Item Based Collaborative Filtering Movie Recommender</figcaption></figure><p id="57bc" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Part 1 of <em class="kg">recommender systems</em> can be found <a class="da bv kh ki kj kk" href="/prototyping-a-recommender-system-step-by-step-part-1-knn-item-based-collaborative-filtering-637969614ea?source=post_page---------------------------"><em class="kg">here</em></a></p><p id="ac5d" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">In the <a href="https://medium.com/@keliao/prototyping-a-recommender-system-step-by-step-part-1-knn-item-based-collaborative-filtering-637969614ea?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">last post</em></a>, we covered a lot of ground in how to build our own recommender systems and got our hand dirty with <strong class="ju kl">Pandas</strong> and <strong class="ju kl">Scikit-learn</strong> to implement a <strong class="ju kl">KNN item-based collaborative filtering</strong> movie recommender. The source code of the KNN recommender system can be found in my <a href="https://github.com/KevinLiao159/MyDataSciencePortfolio/blob/master/movie_recommender/src/knn_recommender.py?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">Github repo</em></a>.<br/><br/>In this post, we will talk about how to improve our movie recommender system with a more sophisticated machine learning technique: <strong class="ju kl">Matrix Factorization</strong>. Later in this post, we will discuss why we want to use matrix factorization in collaborative filtering and what is matrix factorization and how is it implemented in <strong class="ju kl">Spark</strong>.</p><h1 id="ed32" class="km kn ee ar aq ec ko kp kq kr ks kt ku kv kw kx ky">Shortcomings in Item Based Collaborative Filtering</h1><figure class="jc jd je jf jg fc kz z ab paragraph-image"><div class="jk n es jl"><div class="la n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*6gB-RTb3ANp3lrkdvhC2CQ.png?q=20" class="gh p q gg ae jn jo" width="700" height="235"/></div><img class="dn ji gh p q gg ae ge" width="700" height="235"/><noscript><img src="https://miro.medium.com/max/1400/1*6gB-RTb3ANp3lrkdvhC2CQ.png" class="gh p q gg ae" width="700" height="235"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Output of KNN Item Based Collaborative Filtering Recommender From Previous Post</figcaption></figure><p id="7f53" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">During the last section in <a href="https://medium.com/@keliao/prototyping-a-recommender-system-step-by-step-part-1-knn-item-based-collaborative-filtering-637969614ea?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">previous post</em></a>, we asked our model for some movie recommendations. After we evaluated the list of recommended movies, we quickly identified two obvious limitations in our KNN approach. One is the “popularity bias”, the other is “item cold-start problem”. There will be another limitation, “scalability issue”, if the underlying training data is too big to fit in one machine</p><ul class=""><li id="48e7" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf lb lc ld"><strong class="ju kl">popularity bias:</strong> refers to system recommends the movies with the most interactions without any personalization</li><li id="0ca5" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lb lc ld"><strong class="ju kl">item cold-start problem</strong>: refers to when movies added to the catalogue have either none or very little interactions while recommender rely on the movie’s interactions to make recommendations</li><li id="e8cb" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lb lc ld"><strong class="ju kl">scalability issue</strong>: refers to lack of the ability to scale to much larger sets of data when more and more users and movies added into our database</li></ul><p id="ba9c" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">All three above are very typical challenges for collaborative filtering recommender. They arrive naturally along with the user-movie (or movie-user) interaction matrix where each entry records an interaction of a user <code class="jl lj lk ll b">i</code> and a movie <code class="jl lj lk ll b">j</code>. In a real world setting, the vast majority of movies receive very few or even no ratings at all by users. We are looking at an extremely sparse matrix with more than 99% of entries are missing values.</p><figure class="jc jd je jf jg fc lm z ab paragraph-image"><div class="jk n es jl"><div class="ln n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*rvCsSPh2EHj-B2HFwAgwmg.png?q=20" class="gh p q gg ae jn jo" width="700" height="363"/></div><img class="dn ji gh p q gg ae ge" width="700" height="363"/><noscript><img src="https://miro.medium.com/max/1400/1*rvCsSPh2EHj-B2HFwAgwmg.png" class="gh p q gg ae" width="700" height="363"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Sparse Rating Data</figcaption></figure><p id="f5b9" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">With such a sparse matrix, what ML algorithms can be trained and reliable to make inference? To find solutions to the question, we are effectively solving a data sparsity problem.</p><h1 id="fa10" class="km kn ee ar aq ec ko kp kq kr ks kt ku kv kw kx ky">Matrix Factorization</h1><p id="01e6" class="js jt ee ar ju b jv lo jx lp jz lq kb lr kd ls kf">In collaborative filtering, <strong class="ju kl">matrix factorization</strong> is the state-of-the-art solution for sparse data problem, although it has become widely known since <a href="https://www.netflixprize.com/?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">Netflix Prize Challenge</em></a>.</p><figure class="jc jd je jf jg fc lt z ab paragraph-image"><div class="jk n es jl"><div class="lu n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*xMxQL_V9CWeLggrk-Uyzmg.png?q=20" class="gh p q gg ae jn jo" width="700" height="285"/></div><img class="dn ji gh p q gg ae ge" width="700" height="285"/><noscript><img src="https://miro.medium.com/max/1400/1*xMxQL_V9CWeLggrk-Uyzmg.png" class="gh p q gg ae" width="700" height="285"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Matrix Factorization of Movie Ratings Data</figcaption></figure><p id="07b8" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">What is matrix factorization? Matrix factorization is simply a family of mathematical operations for matrices in linear algebra. To be specific, a matrix factorization is a factorization of a matrix into a product of matrices. In the case of collaborative filtering, <strong class="ju kl">matrix factorization</strong> algorithms work by <strong class="ju kl">decomposing</strong> the user-item interaction matrix into the product of two <strong class="ju kl">lower dimensionality rectangular matrices</strong>. One matrix can be seen as the user matrix where rows represent users and columns are latent factors. The other matrix is the item matrix where rows are latent factors and columns represent items.</p><p id="2075" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">How does matrix factorization solve our problems?</p><ol class=""><li id="b103" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf lv lc ld">Model learns to factorize rating matrix into user and movie representations, which allows model to predict better personalized movie ratings for users</li><li id="6b36" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lv lc ld">With matrix factorization, less-known movies can have rich latent representations as much as popular movies have, which improves recommender’s ability to recommend less-known movies</li></ol><p id="03ba" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">In the sparse user-item interaction matrix, the predicted rating user <code class="jl lj lk ll b">u</code> will give item <code class="jl lj lk ll b">i</code> is computed as:</p><figure class="jc jd je jf jg fc lw z ab paragraph-image"><div class="jk n es jl"><div class="lx n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*EwHsfRtda-N-IUj-lMtQpg.png?q=20" class="gh p q gg ae jn jo" width="338" height="118"/></div><img class="dn ji gh p q gg ae ge" width="338" height="118"/><noscript><img src="https://miro.medium.com/max/676/1*EwHsfRtda-N-IUj-lMtQpg.png" class="gh p q gg ae" width="338" height="118"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">where H is user matrix, W is item matrix</figcaption></figure><p id="b16a" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Rating of item <code class="jl lj lk ll b">i</code> given by user <code class="jl lj lk ll b">u</code> can be expressed as a dot product of the user latent vector and the item latent vector.</p><p id="b4d3" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Notice in above formula, the number of <strong class="ju kl">latent factors</strong> can be tuned via cross-validation. <strong class="ju kl">Latent factors</strong> are the features in the lower dimension latent space projected from user-item interaction matrix. The idea behind matrix factorization is to use latent factors to represent user preferences or movie topics in a much lower dimension space. Matrix factorization is one of very effective <strong class="ju kl">dimension reduction</strong> techniques in machine learning.</p><figure class="jc jd je jf jg fc ly z ab paragraph-image"><div class="jk n es jl"><div class="lz n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*HJut9UgXP5STwpYInxvJVg.png?q=20" class="gh p q gg ae jn jo" width="700" height="500"/></div><img class="dn ji gh p q gg ae ge" width="700" height="500"/><noscript><img src="https://miro.medium.com/max/1400/1*HJut9UgXP5STwpYInxvJVg.png" class="gh p q gg ae" width="700" height="500"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Variance Explained By Components In PCA</figcaption></figure><p id="0bc9" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Very much like the concept of <strong class="ju kl">components</strong> in <strong class="ju kl">PCA</strong>, the number of latent factors determines the amount of abstract information that we want to store in a lower dimension space. A matrix factorization with one latent factor is equivalent to a <em class="kg">most popular</em> or <em class="kg">top popular</em> recommender (e.g. recommends the items with the most interactions without any personalization). Increasing the number of latent factors will improve personalization, until the number of factors becomes too high, at which point the model starts to overfit. A common strategy to avoid overfitting is to add <strong class="ju kl">regularization terms</strong> to the objective function.</p><p id="b871" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">The objective of matrix factorization is to minimize the error between true rating and predicted rating:</p><figure class="jc jd je jf jg fc hp z ab paragraph-image"><div class="jk n es jl"><div class="ma n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*Oi7FYyZc31s5x3hsk8a48Q.png?q=20" class="gh p q gg ae jn jo" width="550" height="82"/></div><img class="dn ji gh p q gg ae ge" width="550" height="82"/><noscript><img src="https://miro.medium.com/max/1100/1*Oi7FYyZc31s5x3hsk8a48Q.png" class="gh p q gg ae" width="550" height="82"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">where H is user matrix, W is item matrix</figcaption></figure><p id="c106" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Once we have an objective function, we just need a training routine (eg, gradient descent) to complete the implementation of a matrix factorization algorithm. This implementation is actually called <strong class="ju kl">Funk SVD</strong>. It is named after Simon Funk, who he shared his findings with the research community during Netflix prize challenge in 2006.</p><figure class="jc jd je jf jg fc mb z ab paragraph-image"><div class="jk n es jl"><div class="mc n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*tYxWuyksovxA1Thu8PggPQ.jpeg?q=20" class="gh p q gg ae jn jo" width="700" height="394"/></div><img class="dn ji gh p q gg ae ge" width="700" height="394"/><noscript><img src="https://miro.medium.com/max/1400/1*tYxWuyksovxA1Thu8PggPQ.jpeg" class="gh p q gg ae" width="700" height="394"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Scaling Machine Learning Applications With Distributed Computing</figcaption></figure><p id="6107" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Although Funk SVD was very effective in matrix factorization with single machine during that time, it’s not <strong class="ju kl">scalable</strong> as the amount of data grows today. With terabytes or even petabytes of data, it’s impossible to load data with such size into a single machine. So we need a machine learning model (or framework) that can train on dataset spreading across from cluster of machines.</p><h1 id="0c6c" class="km kn ee ar aq ec ko kp kq kr ks kt ku kv kw kx ky">Alternating Least Square (ALS) with Spark ML</h1><p id="306b" class="js jt ee ar ju b jv lo jx lp jz lq kb lr kd ls kf">Alternating Least Square (ALS) is also a matrix factorization algorithm and it runs itself in a parallel fashion. ALS is implemented in Apache Spark ML and built for a larges-scale collaborative filtering problems. ALS is doing a pretty good job at solving scalability and sparseness of the Ratings data, and it’s simple and scales well to very large datasets.</p><p id="0c64" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Some high-level ideas behind ALS are:</p><ul class=""><li id="6839" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf lb lc ld">Its objective function is slightly different than Funk SVD: ALS uses <strong class="ju kl">L2 regularization</strong> while Funk uses <strong class="ju kl">L1 regularization</strong></li><li id="cd15" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lb lc ld">Its training routine is different: ALS minimizes <strong class="ju kl">two loss functions alternatively</strong>; It first holds user matrix fixed and runs gradient descent with item matrix; then it holds item matrix fixed and runs gradient descent with user matrix</li><li id="e16b" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lb lc ld">Its scalability: ALS runs its gradient descent in <strong class="ju kl">parallel</strong> across multiple partitions of the underlying training data from a cluster of machines</li></ul><figure class="jc jd je jf jg fc md z ab paragraph-image"><div class="jk n es jl"><div class="me n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*OqbfYwHNfpR0ZUsY7AH3NQ.png?q=20" class="gh p q gg ae jn jo" width="700" height="285"/></div><img class="dn ji gh p q gg ae ge" width="700" height="285"/><noscript><img src="https://miro.medium.com/max/1400/1*OqbfYwHNfpR0ZUsY7AH3NQ.png" class="gh p q gg ae" width="700" height="285"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">Pseudocode For SGD In Matrix Factorization</figcaption></figure><p id="8a76" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">If you are interested in learning more about ALS, you can find more details in this paper: <a href="https://endymecy.gitbooks.io/spark-ml-source-analysis/content/%E6%8E%A8%E8%8D%90/papers/Large-scale%20Parallel%20Collaborative%20Filtering%20the%20Netflix%20Prize.pdf?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">Large-scale Parallel Collaborative Filtering for the Netflix Prize</em></a></p><p id="d618" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Just like other machine learning algorithms, ALS has its own set of hyper-parameters. We probably want to tune its hyper-parameters via <strong class="ju kl">hold-out validation</strong> or <strong class="ju kl">cross-validation</strong>.</p><p id="b306" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Most important hyper-params in Alternating Least Square (ALS):</p><ul class=""><li id="cb68" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf lb lc ld">maxIter: the maximum number of iterations to run (defaults to 10)</li><li id="c4e0" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lb lc ld">rank: the number of latent factors in the model (defaults to 10)</li><li id="1095" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lb lc ld">regParam: the regularization parameter in ALS (defaults to 1.0)</li></ul><p id="a067" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Hyper-parameter tuning is a highly recurring task in many machine learning projects. We can code it up in a function to speed up the tuning iterations.</p><figure class="jc jd je jf jg"><div class="jk n es"><div class="mf n"><iframe src="https://towardsdatascience.com/media/505bfde2068d2da6e1d42386deec844d" frameBorder="0" height="0" width="0" title="A function for ALS hyper-param tuning" class="gh p q gg ae"></iframe></div></div></figure><p id="9378" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">After tuning, we found the best choice of hyper-parameters: <code class="jl lj lk ll b">maxIter=10</code>, <code class="jl lj lk ll b">regParam=0.05</code>, <code class="jl lj lk ll b">rank=20</code></p><h1 id="8a57" class="km kn ee ar aq ec ko kp kq kr ks kt ku kv kw kx ky">Implementing ALS Recommender System</h1><p id="4bf8" class="js jt ee ar ju b jv lo jx lp jz lq kb lr kd ls kf">Now that we know we have a wonderful model for movie recommendation, the next question is: how do we take our wonderful model and productize it into a recommender system? Machine learning model productization is another big topic and I won’t get into details about it. In this post, I will show how to build a MVP (minimum viable product) version for ALS recommender.</p><p id="fbb9" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">To productize a model, we need to build a work flow around the model. Typical ML work flow roughly starts with data preparation via pre-defined set of ETL jobs, offline/online model training, then ingesting trained models to web services for production. In our case, we are going to build a very minimum version of movie recommender that just does the job. Our work flow is following:</p><ol class=""><li id="3c64" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf lv lc ld">A new user inputs his/her favorite movies, then system create new user-movie interaction samples for the model</li><li id="532c" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lv lc ld">System retrains ALS model on data with the new inputs</li><li id="1334" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lv lc ld">System creates movie data for inference (in my case, I sample all movies from the data)</li><li id="859a" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lv lc ld">System make rating predictions on all movies for that user</li><li id="cf39" class="js jt ee ar ju b jv le jx lf jz lg kb lh kd li kf lv lc ld">System outputs top N movie recommendations for that user based on the ranking of movie rating predictions</li></ol><p id="12ac" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Here is a small snippet of the source code for our MVP recommender system:</p><figure class="jc jd je jf jg"><div class="jk n es"><div class="mf n"><iframe src="https://towardsdatascience.com/media/19045ad30ca6ef2007776932a0e84c34" frameBorder="0" height="0" width="0" title="The &quot;make_recommendations&quot; method from my ALS recommender" class="gh p q gg ae"></iframe></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">snippet of our final step in ALS recommender’s implementation</figcaption></figure><p id="8871" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">This snippet demos our <code class="jl lj lk ll b">make_recommendations</code> method in our recommender’s implementation. Please find the detailed source code for recommender application in my <a href="https://github.com/KevinLiao159/MyDataSciencePortfolio/blob/master/movie_recommender/src/als_recommender.py?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">GitHub Repo</em></a>.</p><h1 id="c6a7" class="km kn ee ar aq ec ko kp kq kr ks kt ku kv kw kx ky">Let’s Make Some Recommendations</h1><p id="4294" class="js jt ee ar ju b jv lo jx lp jz lq kb lr kd ls kf">Once we implemented the ALS recommender system in a python script as a small <strong class="ju kl">Pyspark</strong> program, we can submit our spark application to a cluster with Client Deploy Mode or Cluster Deploy Mode and enjoy the power of distributed computing.</p><p id="991d" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Finally, we are done with the technical details and implementations. Now let’s ask our recommender for some movie recommendations. I will pretend a new user and input my favorite movie “Iron Man” again into this new recommender system. Let’s see what movies it recommends to me. Hopefully, they are not the same list of popular movies that I have watched many times before.</p><p id="29d2" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">For demo purpose, I submit my spark application locally by running following commends in terminal: (instruction of commands can be found <a href="https://github.com/KevinLiao159/MyDataSciencePortfolio/blob/0bc389b38de4573863446c4c90cbca3c31f7b0ef/movie_recommender/src/als_recommender.py?source=post_page---------------------------#L313" class="da bv kh ki kj kk">here</a>)</p><pre class="jc jd je jf jg hr fi cj"><span id="642d" class="mg kn ee ar ll b eh mh mi n mj">spark-submit --master local[4] --driver-memory 4g <br/>             --executor-memory 8g src/als_recommender.py <br/>             --movie_name &quot;Iron Man&quot; --top_n 10</span></pre></div><div class="ag ie ae af"><figure class="jc jd je jf jg fc mk ml mm paragraph-image"><div class="jk n es jl"><div class="mn n"><div class="dn ji gh p q gg ae ca v jj"><img src="https://miro.medium.com/max/60/1*tllu7jihkhbmuKQ8FuuJMA.png?q=20" class="gh p q gg ae jn jo" width="1000" height="180"/></div><img class="dn ji gh p q gg ae ge" width="1000" height="180"/><noscript><img src="https://miro.medium.com/max/2000/1*tllu7jihkhbmuKQ8FuuJMA.png" class="gh p q gg ae" width="1000" height="180"/></noscript></div></div><figcaption class="av eh jp jq ht dm z ab jr aq cu">List of Movie Recommendations Based On My Favorite Movie: “Iron Man”</figcaption></figure></div><div class="ag ie ae dm x y"><p id="b3e8" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">Yay!! Successfully run our movie recommender with Spark.</p><p id="8717" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">This new list of recommended movies are completely different than the list from previous KNN recommender, which is very interesting!! I have never watch any one of movies from this new list. I find it very surprising that the new recommender proposed me unusual movies. They might be too unusual for other users, which is problematic.</p><p id="1f86" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">One idea to further improve our movie recommender system is to blend this new list of movie recommendations with the previous list from KNN recommender. We basically implement a hybrid recommender system and this hybrid recommender can offer both popular and less-know content to users.</p><h1 id="379e" class="km kn ee ar aq ec ko kp kq kr ks kt ku kv kw kx ky">Summary</h1><p id="59e0" class="js jt ee ar ju b jv lo jx lp jz lq kb lr kd ls kf">In this post, we covered how to improve collaborative filtering recommender system with <strong class="ju kl">matrix factorization</strong>. We learned that matrix factorization can solve “popular bias” and “item cold-start” problems in collaborative filtering. We also leveraged <strong class="ju kl">Spark ML</strong> to implement distributed recommender system using <strong class="ju kl">Alternating Least Square (ALS)</strong>. The <strong class="ju kl">Jupyter Notebook version</strong> for this blog post can be found <a href="https://github.com/KevinLiao159/MyDataSciencePortfolio/blob/master/movie_recommender/movie_recommendation_using_ALS.ipynb?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">here</em></a>. If you want to play around my <strong class="ju kl">source code</strong>, you can find it <a href="https://github.com/KevinLiao159/MyDataSciencePortfolio/blob/master/movie_recommender/src/als_recommender.py?source=post_page---------------------------" class="da bv kh ki kj kk"><em class="kg">here</em></a>.</p><p id="2c5c" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf">In my next post, we will dig deeper at Matrix Factorization techniques. We can develop a more generalized form of matrix factorization model with <strong class="ju kl">neural network </strong>implementation<strong class="ju kl"> </strong>in<strong class="ju kl"> Keras. </strong>Stay tuned! Until then, have fun with machine learning and recommenders!</p></div></section><hr class="mo cu gz mp mq ht mr ms mt mu mv"/><section class="hz ia ib ic id"><div class="ag ie ae dm x y"><p id="84b1" class="js jt ee ar ju b jv jw jx jy jz ka kb kc kd ke kf"><em class="kg">Like what you read? Checkout more data science / machine learning projects at my Github: </em><a href="https://github.com/KevinLiao159/MyDataSciencePortfolio?source=post_page---------------------------" class="da bv kh ki kj kk"><strong class="ju kl"><em class="kg">Kevin’s Data Science Portfolio</em></strong></a></p></div></section></div></article><div class="dn do dp o dq dr ds dt du e" data-test-id="post-sidebar"><div class="ah dv"><div class="dw dx n"><a href="https://towardsdatascience.com/?source=post_sidebar--------------------------post_sidebar-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><h2 class="aq ec ed as ee">Towards Data Science</h2></a><div class="ef eg n"><h4 class="aq cu eh as ca ei ej ek el em av">Sharing concepts, ideas, and codes.</h4></div><div class="bu"><button class="en bo ax ay bp bh bi bq bg br aq b ar as at au bs bt ag bu bv bj">Follow</button></div></div><div class="eo ep eq ah"><div class="ah ai"><div class="er n es"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1&amp;source=post_sidebar-----4a76c58714a1---------------------clap_sidebar-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><div class="be et eu ev ew ex ey ay ez"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="fa n"><div class="fb"><h4 class="aq cu eh as av"><button class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb">504 </button></h4></div></div></div></div><div><div class="bu"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div><div><div class="dl fc ah dv fd"><section class="x y z ab ae dm ag n"><ul class="be bf"><li class="bu cg fe ff"><a href="/tag/machine-learning" class="fg fh bv av n fi fj a b cv">Machine Learning</a></li><li class="bu cg fe ff"><a href="/tag/data-science" class="fg fh bv av n fi fj a b cv">Data Science</a></li><li class="bu cg fe ff"><a href="/tag/recommendation-system" class="fg fh bv av n fi fj a b cv">Recommendation System</a></li><li class="bu cg fe ff"><a href="/tag/distributed-systems" class="fg fh bv av n fi fj a b cv">Distributed Systems</a></li><li class="bu cg fe ff"><a href="/tag/spark" class="fg fh bv av n fi fj a b cv">Spark</a></li></ul><div class="ah fk fl w"><div class="ah ai"><div class="fm n es"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1&amp;source=post_actions_footer-----4a76c58714a1---------------------clap_footer-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><div class="c fn fo ah ai fp es fq fr bq fs ft fu fv fw fx fy fz ga gb gc"><div class="be et eu ev ew ex gd ai ge fo ah ay fd gf q gg gh p ae ez"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></div></a></div><div class="fa n"><div class="fb"><h4 class="aq cu eh as ee"><button class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb">504 claps</button></h4></div></div></div><div class="ah ai"><div class="gi n ao g"><a href="//medium.com/p/4a76c58714a1/share/twitter?source=follow_footer--------------------------follow_footer-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><svg width="29" height="29" class="an"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="gi n ao g"><a href="//medium.com/p/4a76c58714a1/share/facebook?source=follow_footer--------------------------follow_footer-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><svg width="29" height="29" class="an"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="gi gj by"><div class="bu"><button class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><svg width="25" height="25" class="an"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="gi n ao"><div><div class="bu"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1&amp;source=post_actions_footer--------------------------bookmark_sidebar-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div><div class="bu"><div class="bu"><div class="n ao"><button class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="an"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div><div class="gk gl gm gn n w"><div class="go gp n es"><span class="n gq ak gr"><div class="n gh gs gt"><a href="/@keliao?source=follow_footer--------------------------follow_footer-"><img alt="Kevin Liao" src="https://miro.medium.com/fit/c/160/160/1*CTPk1L9tt53nOR4MH6dxPQ.jpeg" class="n fo cn gu" width="80" height="80"/></a></div><span class="n"><div class="gv n gw"><p class="aq cu cv as av cy gx">Written by</p></div><div class="gv gy ah gw"><div class="ae ah ai fk"><h2 class="aq ec gz ha ee"><a href="/@keliao?source=follow_footer--------------------------follow_footer-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb">Kevin Liao</a></h2><div class="n g"><button class="en ee an bo hb hc hd he bg ea hf hg hh hi hj hk br aq b ar as at au bs bt ag bu bv bj">Follow</button></div></div></div></span></span><div class="gv hl n gw by"><div class="hm n"><h4 class="aq cu ed hn av">Data Scientist | Machine Learning Practitioner</h4></div><div class="gj ho by"><button class="en ee an bo hb hc hd he bg ea hf hg hh hi hj hk br aq b ar as at au bs bt ag bu bv bj">Follow</button></div></div></div><div class="gk n"></div><div class="go gp n es"><span class="n gq ak gr"><div class="n gh gs gt"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-"><img alt="Towards Data Science" src="https://miro.medium.com/fit/c/160/160/1*F0LADxTtsKOgmPa-_7iUEQ.jpeg" class="br gu cn" width="80" height="80"/></a></div><span class="n"><div class="gv gy ah gw"><div class="ae ah ai fk"><h2 class="aq ec gz ha ee"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb">Towards Data Science</a></h2><div class="n g"><div class="bu"><button class="en bo ax ay bp bh bi bq bg br aq b ar as at au bs bt ag bu bv bj">Follow</button></div></div></div></div></span></span><div class="gv hp n gw by"><div class="hm n"><h4 class="aq cu ed hn av">Sharing concepts, ideas, and codes.</h4></div><div class="gj ho by"><div class="bu"><button class="en bo ax ay bp bh bi bq bg br aq b ar as at au bs bt ag bu bv bj">Follow</button></div></div></div></div></div><div class="hq gl n w"><a href="https://medium.com/p/4a76c58714a1/responses/show?source=follow_footer--------------------------follow_footer-" class="da db az ba bb bc bd be bf bg dy dz bj bk ea eb"><div class="hr hs fg n ht by"><span class="ax">See responses (7)</span></div></a></div></section><div class="hu n hv w"><section class="x y z ab ae af ag n"></section></div></div></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script></div></div><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20190726-174015-452435f282","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","iTunesAppId":"828256236","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20190726-174015-452435f282"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"]},"debug":{"requestId":"d964d5c2-7cc4-4467-a2d9-0a00aabdf2ad","originalSpanCarrier":{"ot-tracer-spanid":"016f0e9f26cd2fee","ot-tracer-traceid":"2de157dc5e071bc8","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_8bdMa6kBxo6T"},"xsrf":""},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hideGoogleOneTap":false,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1","host":"towardsdatascience.com","hostname":"towardsdatascience.com","currentHash":""},"client":{"isBot":false,"isDnt":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":true},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"viewer":null,"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"}],"meterPost({\"postId\":\"4a76c58714a1\",\"postMeteringOptions\":{}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"4a76c58714a1\"})":{"type":"id","generated":false,"id":"Post:4a76c58714a1","typename":"Post"}},"ROOT_QUERY.variantFlags.0":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.3":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.4":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.5":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.6":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.7":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.10":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.11":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.14":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.29":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_quarantine_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_lite_claps","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_live_user_post_scoring","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_lite_email_sign_in_flow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_lite_paywall_alert","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_serve_recs_from_ml_rank_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_serve_recs_from_ml_rank_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_serve_recs_from_ml_rank_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_lite_thanks_to","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_lite_google_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_lite_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_lite_audio_upsells","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_lite_verify_email_butter_bar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"remove_social_proof_on_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_lite_unread_notification_count","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_icymi_section_in_digest_with_two_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:4a76c58714a1":{"__typename":"Post","creator":{"type":"id","generated":false,"id":"User:93b225681c92","typename":"User"},"isLocked":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","id":"4a76c58714a1","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"sequence":null,"firstPublishedAt":1542443658344,"isPublished":true,"title":"Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix…","canonicalUrl":"","layerCake":4,"primaryTopic":null,"content({\"postMeteringOptions\":{}})":{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}})","typename":"PostContent"},"highlights":[{"type":"id","generated":false,"id":"Quote:anon_66f5a80e8fa4","typename":"Quote"}],"latestPublishedVersion":"81aa129cd981","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fprototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1","readingTime":8.110377358490567,"statusForCollection":"APPROVED","visibility":"PUBLIC","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:machine-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:data-science","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:recommendation-system","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:distributed-systems","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:spark","typename":"Tag"}],"viewerClapCount":null,"readingList":"READING_LIST_NONE","clapCount":504,"voterCount":107,"recommenders":[],"pendingCollection":null,"responsesCount":7,"collaborators":[],"inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":0,"audioVersionUrl":null,"socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1542616429342,"previewContent":{"type":"id","generated":true,"id":"$Post:4a76c58714a1.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*EZu5sHcoyDhsRC00C9ZCTg.png","typename":"ImageMetadata"},"updatedAt":1542616429342,"topics":[],"isSuspended":false},"User:93b225681c92":{"id":"93b225681c92","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Kevin Liao","isFollowing":false,"username":"keliao","bio":"Data Scientist | Machine Learning Practitioner","imageId":"1*CTPk1L9tt53nOR4MH6dxPQ.jpeg","mediumMemberAt":0,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":""},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","__typename":"Collection","slug":"towards-data-science","domain":"towardsdatascience.com","googleAnalyticsId":"UA-19707169-24","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","name":"Towards Data Science","logo":{"type":"id","generated":false,"id":"ImageMetadata:1*5EUO1kUYBthpOCPzRj_l2g.png","typename":"ImageMetadata"},"creator":{"type":"id","generated":false,"id":"User:895063a310f4","typename":"User"},"viewerCanManage":false,"avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*F0LADxTtsKOgmPa-_7iUEQ.jpeg","typename":"ImageMetadata"},"isEnrolledInHightower":false,"navItems":[{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.0","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.1","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.2","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.3","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.4","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.5","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.6","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.7","typename":"NavItem"}],"colorPalette":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette","typename":"ColorPalette"},"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"description":"Sharing concepts, ideas, and codes.","viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"mediumNewsletterId":"","isUserSubscribedToMediumNewsletter":false,"ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null,"favicon":{"type":"id","generated":false,"id":"ImageMetadata:1*F0LADxTtsKOgmPa-_7iUEQ.jpeg","typename":"ImageMetadata"}},"ImageMetadata:1*5EUO1kUYBthpOCPzRj_l2g.png":{"id":"1*5EUO1kUYBthpOCPzRj_l2g.png","originalWidth":1010,"originalHeight":376,"__typename":"ImageMetadata"},"User:895063a310f4":{"id":"895063a310f4","__typename":"User"},"ImageMetadata:1*F0LADxTtsKOgmPa-_7iUEQ.jpeg":{"id":"1*F0LADxTtsKOgmPa-_7iUEQ.jpeg","__typename":"ImageMetadata"},"Collection:7f60cf5620c9.navItems.0":{"title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.1":{"title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.2":{"title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.3":{"title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.4":{"title":"AI","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fartificial-intelligence\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.5":{"title":"Journalism","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-journalism\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.6":{"title":"Events","url":"https:\u002F\u002Ftowardsdatascience.com\u002Ftoronto-machine-learning-summit-8bae371d4bb1","type":"POST_NAV_ITEM","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.7":{"title":"Submit","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM","__typename":"NavItem"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum":{"backgroundColor":"#FF355876","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0":{"color":"#FF355876","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1":{"color":"#FF4D6C88","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2":{"color":"#FF637F99","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3":{"color":"#FF7791A8","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4":{"color":"#FF8CA2B7","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5":{"color":"#FF9FB3C6","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6":{"color":"#FFB2C3D4","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7":{"color":"#FFC5D2E1","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8":{"color":"#FFD7E2EE","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9":{"color":"#FFE9F1FA","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10":{"color":"#FFFBFFFF","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette":{"tintBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum","typename":"ColorSpectrum"},"__typename":"ColorPalette","defaultBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum","typename":"ColorSpectrum"},"highlightSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum","typename":"ColorSpectrum"}},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0":{"color":"#FF668AAA","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1":{"color":"#FF61809D","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2":{"color":"#FF5A7690","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3":{"color":"#FF546C83","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4":{"color":"#FF4D6275","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5":{"color":"#FF455768","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6":{"color":"#FF3D4C5A","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7":{"color":"#FF34414C","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8":{"color":"#FF2B353E","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9":{"color":"#FF21282F","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10":{"color":"#FF161B1F","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0":{"color":"#FFEDF4FC","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1":{"color":"#FFE9F2FD","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2":{"color":"#FFE6F1FD","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3":{"color":"#FFE2EFFD","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4":{"color":"#FFDFEEFD","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5":{"color":"#FFDBECFE","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6":{"color":"#FFD7EBFE","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7":{"color":"#FFD4E9FE","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8":{"color":"#FFD0E7FF","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9":{"color":"#FFCCE6FF","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10":{"color":"#FFC8E4FF","point":1,"__typename":"ColorPoint"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}})":{"isLockedPreviewOnly":false,"__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel","typename":"RichText"}},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.sections.0":{"name":"f4c6","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.sections.1":{"name":"7e91","startIndex":70,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.sections.0","typename":"Section"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.sections.1","typename":"Section"}],"paragraphs":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.0","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.1","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.4","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.5","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.6","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.7","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.8","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.9","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.10","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.11","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.12","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.13","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.15","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.17","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.18","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.19","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.20","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.21","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.22","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.24","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.26","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.27","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.28","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.29","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.30","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.31","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.32","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.33","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.34","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.35","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.36","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.37","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.38","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.39","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.40","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.41","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.42","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.43","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.44","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.45","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.47","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.48","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.49","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.50","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.51","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.52","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.53","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.54","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.55","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.56","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.58","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.59","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.60","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.61","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.62","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.63","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.64","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.65","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.66","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.67","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69","typename":"Paragraph"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70","typename":"Paragraph"}],"__typename":"RichText"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.0":{"name":"98e4","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Prototyping a Recommender System Step by Step Part 2: Alternating Least Square (ALS) Matrix Factorization in Collaborative Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.1":{"name":"dbe3","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*EZu5sHcoyDhsRC00C9ZCTg.png","typename":"ImageMetadata"},"text":"Item Based Collaborative Filtering Movie Recommender","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EZu5sHcoyDhsRC00C9ZCTg.png":{"id":"1*EZu5sHcoyDhsRC00C9ZCTg.png","originalHeight":445,"originalWidth":781,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2":{"name":"57bc","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Part 1 of recommender systems can be found here","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2.markups.0":{"type":"A","start":43,"end":47,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fprototyping-a-recommender-system-step-by-step-part-1-knn-item-based-collaborative-filtering-637969614ea","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2.markups.1":{"type":"EM","start":10,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.2.markups.2":{"type":"EM","start":43,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3":{"name":"ac5d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In the last post, we covered a lot of ground in how to build our own recommender systems and got our hand dirty with Pandas and Scikit-learn to implement a KNN item-based collaborative filtering movie recommender. The source code of the KNN recommender system can be found in my Github repo.\n\nIn this post, we will talk about how to improve our movie recommender system with a more sophisticated machine learning technique: Matrix Factorization. Later in this post, we will discuss why we want to use matrix factorization in collaborative filtering and what is matrix factorization and how is it implemented in Spark.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.6","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.7","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.8","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.0":{"type":"A","start":7,"end":16,"href":"https:\u002F\u002Fmedium.com\u002F@keliao\u002Fprototyping-a-recommender-system-step-by-step-part-1-knn-item-based-collaborative-filtering-637969614ea","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.1":{"type":"A","start":279,"end":290,"href":"https:\u002F\u002Fgithub.com\u002FKevinLiao159\u002FMyDataSciencePortfolio\u002Fblob\u002Fmaster\u002Fmovie_recommender\u002Fsrc\u002Fknn_recommender.py","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.2":{"type":"STRONG","start":117,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.3":{"type":"STRONG","start":128,"end":140,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.4":{"type":"STRONG","start":156,"end":194,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.5":{"type":"STRONG","start":424,"end":444,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.6":{"type":"STRONG","start":611,"end":616,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.7":{"type":"EM","start":7,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.3.markups.8":{"type":"EM","start":279,"end":290,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.4":{"name":"ed32","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Shortcomings in Item Based Collaborative Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.5":{"name":"54e4","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*6gB-RTb3ANp3lrkdvhC2CQ.png","typename":"ImageMetadata"},"text":"Output of KNN Item Based Collaborative Filtering Recommender From Previous Post","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*6gB-RTb3ANp3lrkdvhC2CQ.png":{"id":"1*6gB-RTb3ANp3lrkdvhC2CQ.png","originalHeight":642,"originalWidth":1910,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.6":{"name":"7f53","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"During the last section in previous post, we asked our model for some movie recommendations. After we evaluated the list of recommended movies, we quickly identified two obvious limitations in our KNN approach. One is the “popularity bias”, the other is “item cold-start problem”. There will be another limitation, “scalability issue”, if the underlying training data is too big to fit in one machine","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.6.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.6.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.6.markups.0":{"type":"A","start":27,"end":40,"href":"https:\u002F\u002Fmedium.com\u002F@keliao\u002Fprototyping-a-recommender-system-step-by-step-part-1-knn-item-based-collaborative-filtering-637969614ea","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.6.markups.1":{"type":"EM","start":27,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.7":{"name":"48e7","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"popularity bias: refers to system recommends the movies with the most interactions without any personalization","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.7.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.7.markups.0":{"type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.8":{"name":"0ca5","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"item cold-start problem: refers to when movies added to the catalogue have either none or very little interactions while recommender rely on the movie’s interactions to make recommendations","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.8.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.8.markups.0":{"type":"STRONG","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.9":{"name":"e8cb","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"scalability issue: refers to lack of the ability to scale to much larger sets of data when more and more users and movies added into our database","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.9.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.9.markups.0":{"type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.10":{"name":"ba9c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"All three above are very typical challenges for collaborative filtering recommender. They arrive naturally along with the user-movie (or movie-user) interaction matrix where each entry records an interaction of a user i and a movie j. In a real world setting, the vast majority of movies receive very few or even no ratings at all by users. We are looking at an extremely sparse matrix with more than 99% of entries are missing values.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.10.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.10.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.10.markups.0":{"type":"CODE","start":218,"end":219,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.10.markups.1":{"type":"CODE","start":232,"end":233,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.11":{"name":"c609","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*rvCsSPh2EHj-B2HFwAgwmg.png","typename":"ImageMetadata"},"text":"Sparse Rating Data","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rvCsSPh2EHj-B2HFwAgwmg.png":{"id":"1*rvCsSPh2EHj-B2HFwAgwmg.png","originalHeight":998,"originalWidth":1922,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.12":{"name":"f5b9","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"With such a sparse matrix, what ML algorithms can be trained and reliable to make inference? To find solutions to the question, we are effectively solving a data sparsity problem.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.13":{"name":"fa10","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Matrix Factorization","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14":{"name":"01e6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In collaborative filtering, matrix factorization is the state-of-the-art solution for sparse data problem, although it has become widely known since Netflix Prize Challenge.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14.markups.0":{"type":"A","start":149,"end":172,"href":"https:\u002F\u002Fwww.netflixprize.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14.markups.1":{"type":"STRONG","start":28,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.14.markups.2":{"type":"EM","start":149,"end":172,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.15":{"name":"f797","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*xMxQL_V9CWeLggrk-Uyzmg.png","typename":"ImageMetadata"},"text":"Matrix Factorization of Movie Ratings Data","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xMxQL_V9CWeLggrk-Uyzmg.png":{"id":"1*xMxQL_V9CWeLggrk-Uyzmg.png","originalHeight":686,"originalWidth":1686,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16":{"name":"07b8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"What is matrix factorization? Matrix factorization is simply a family of mathematical operations for matrices in linear algebra. To be specific, a matrix factorization is a factorization of a matrix into a product of matrices. In the case of collaborative filtering, matrix factorization algorithms work by decomposing the user-item interaction matrix into the product of two lower dimensionality rectangular matrices. One matrix can be seen as the user matrix where rows represent users and columns are latent factors. The other matrix is the item matrix where rows are latent factors and columns represent items.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16.markups.0":{"type":"STRONG","start":267,"end":287,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16.markups.1":{"type":"STRONG","start":307,"end":318,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.16.markups.2":{"type":"STRONG","start":376,"end":417,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.17":{"name":"2075","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"How does matrix factorization solve our problems?","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.18":{"name":"b103","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Model learns to factorize rating matrix into user and movie representations, which allows model to predict better personalized movie ratings for users","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.19":{"name":"6b36","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"With matrix factorization, less-known movies can have rich latent representations as much as popular movies have, which improves recommender’s ability to recommend less-known movies","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.20":{"name":"03ba","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In the sparse user-item interaction matrix, the predicted rating user u will give item i is computed as:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.20.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.20.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.20.markups.0":{"type":"CODE","start":70,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.20.markups.1":{"type":"CODE","start":87,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.21":{"name":"afca","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*EwHsfRtda-N-IUj-lMtQpg.png","typename":"ImageMetadata"},"text":"where H is user matrix, W is item matrix","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EwHsfRtda-N-IUj-lMtQpg.png":{"id":"1*EwHsfRtda-N-IUj-lMtQpg.png","originalHeight":118,"originalWidth":338,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.22":{"name":"b16a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Rating of item i given by user u can be expressed as a dot product of the user latent vector and the item latent vector.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.22.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.22.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.22.markups.0":{"type":"CODE","start":15,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.22.markups.1":{"type":"CODE","start":31,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23":{"name":"b4d3","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Notice in above formula, the number of latent factors can be tuned via cross-validation. Latent factors are the features in the lower dimension latent space projected from user-item interaction matrix. The idea behind matrix factorization is to use latent factors to represent user preferences or movie topics in a much lower dimension space. Matrix factorization is one of very effective dimension reduction techniques in machine learning.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23.markups.0":{"type":"STRONG","start":39,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23.markups.1":{"type":"STRONG","start":89,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.23.markups.2":{"type":"STRONG","start":389,"end":408,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.24":{"name":"e815","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*HJut9UgXP5STwpYInxvJVg.png","typename":"ImageMetadata"},"text":"Variance Explained By Components In PCA","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HJut9UgXP5STwpYInxvJVg.png":{"id":"1*HJut9UgXP5STwpYInxvJVg.png","originalHeight":571,"originalWidth":800,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25":{"name":"0bc9","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Very much like the concept of components in PCA, the number of latent factors determines the amount of abstract information that we want to store in a lower dimension space. A matrix factorization with one latent factor is equivalent to a most popular or top popular recommender (e.g. recommends the items with the most interactions without any personalization). Increasing the number of latent factors will improve personalization, until the number of factors becomes too high, at which point the model starts to overfit. A common strategy to avoid overfitting is to add regularization terms to the objective function.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.4","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.0":{"type":"STRONG","start":30,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.1":{"type":"STRONG","start":44,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.2":{"type":"STRONG","start":572,"end":592,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.3":{"type":"EM","start":239,"end":251,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.25.markups.4":{"type":"EM","start":255,"end":266,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.26":{"name":"b871","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The objective of matrix factorization is to minimize the error between true rating and predicted rating:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.27":{"name":"3e2a","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*Oi7FYyZc31s5x3hsk8a48Q.png","typename":"ImageMetadata"},"text":"where H is user matrix, W is item matrix","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Oi7FYyZc31s5x3hsk8a48Q.png":{"id":"1*Oi7FYyZc31s5x3hsk8a48Q.png","originalHeight":82,"originalWidth":550,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.28":{"name":"c106","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Once we have an objective function, we just need a training routine (eg, gradient descent) to complete the implementation of a matrix factorization algorithm. This implementation is actually called Funk SVD. It is named after Simon Funk, who he shared his findings with the research community during Netflix prize challenge in 2006.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.28.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.28.markups.0":{"type":"STRONG","start":198,"end":206,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.29":{"name":"baf3","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*tYxWuyksovxA1Thu8PggPQ.jpeg","typename":"ImageMetadata"},"text":"Scaling Machine Learning Applications With Distributed Computing","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tYxWuyksovxA1Thu8PggPQ.jpeg":{"id":"1*tYxWuyksovxA1Thu8PggPQ.jpeg","originalHeight":720,"originalWidth":1280,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.30":{"name":"6107","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Although Funk SVD was very effective in matrix factorization with single machine during that time, it’s not scalable as the amount of data grows today. With terabytes or even petabytes of data, it’s impossible to load data with such size into a single machine. So we need a machine learning model (or framework) that can train on dataset spreading across from cluster of machines.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.30.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.30.markups.0":{"type":"STRONG","start":108,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.31":{"name":"0c6c","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Alternating Least Square (ALS) with Spark ML","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.32":{"name":"306b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Alternating Least Square (ALS) is also a matrix factorization algorithm and it runs itself in a parallel fashion. ALS is implemented in Apache Spark ML and built for a larges-scale collaborative filtering problems. ALS is doing a pretty good job at solving scalability and sparseness of the Ratings data, and it’s simple and scales well to very large datasets.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.33":{"name":"0c64","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Some high-level ideas behind ALS are:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.34":{"name":"6839","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Its objective function is slightly different than Funk SVD: ALS uses L2 regularization while Funk uses L1 regularization","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.34.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.34.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.34.markups.0":{"type":"STRONG","start":69,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.34.markups.1":{"type":"STRONG","start":103,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.35":{"name":"cd15","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Its training routine is different: ALS minimizes two loss functions alternatively; It first holds user matrix fixed and runs gradient descent with item matrix; then it holds item matrix fixed and runs gradient descent with user matrix","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.35.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.35.markups.0":{"type":"STRONG","start":49,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.36":{"name":"e16b","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Its scalability: ALS runs its gradient descent in parallel across multiple partitions of the underlying training data from a cluster of machines","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.36.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.36.markups.0":{"type":"STRONG","start":50,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.37":{"name":"78f9","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*OqbfYwHNfpR0ZUsY7AH3NQ.png","typename":"ImageMetadata"},"text":"Pseudocode For SGD In Matrix Factorization","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OqbfYwHNfpR0ZUsY7AH3NQ.png":{"id":"1*OqbfYwHNfpR0ZUsY7AH3NQ.png","originalHeight":752,"originalWidth":1846,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.38":{"name":"8a76","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"If you are interested in learning more about ALS, you can find more details in this paper: Large-scale Parallel Collaborative Filtering for the Netflix Prize","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.38.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.38.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.38.markups.0":{"type":"A","start":91,"end":157,"href":"https:\u002F\u002Fendymecy.gitbooks.io\u002Fspark-ml-source-analysis\u002Fcontent\u002F%E6%8E%A8%E8%8D%90\u002Fpapers\u002FLarge-scale%20Parallel%20Collaborative%20Filtering%20the%20Netflix%20Prize.pdf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.38.markups.1":{"type":"EM","start":91,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.39":{"name":"d618","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Just like other machine learning algorithms, ALS has its own set of hyper-parameters. We probably want to tune its hyper-parameters via hold-out validation or cross-validation.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.39.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.39.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.39.markups.0":{"type":"STRONG","start":136,"end":155,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.39.markups.1":{"type":"STRONG","start":159,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.40":{"name":"b306","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Most important hyper-params in Alternating Least Square (ALS):","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.41":{"name":"cb68","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"maxIter: the maximum number of iterations to run (defaults to 10)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.42":{"name":"c4e0","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"rank: the number of latent factors in the model (defaults to 10)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.43":{"name":"1095","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"regParam: the regularization parameter in ALS (defaults to 1.0)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.44":{"name":"a067","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Hyper-parameter tuning is a highly recurring task in many machine learning projects. We can code it up in a function to speed up the tuning iterations.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.45":{"name":"e1a1","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.45.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:505bfde2068d2da6e1d42386deec844d":{"id":"505bfde2068d2da6e1d42386deec844d","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"A function for ALS hyper-param tuning","__typename":"MediaResource"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.45.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:505bfde2068d2da6e1d42386deec844d","typename":"MediaResource"},"__typename":"Iframe"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46":{"name":"9378","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"After tuning, we found the best choice of hyper-parameters: maxIter=10, regParam=0.05, rank=20","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46.markups.0":{"type":"CODE","start":60,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46.markups.1":{"type":"CODE","start":72,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.46.markups.2":{"type":"CODE","start":87,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.47":{"name":"8a57","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Implementing ALS Recommender System","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.48":{"name":"4bf8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we know we have a wonderful model for movie recommendation, the next question is: how do we take our wonderful model and productize it into a recommender system? Machine learning model productization is another big topic and I won’t get into details about it. In this post, I will show how to build a MVP (minimum viable product) version for ALS recommender.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.49":{"name":"fbb9","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"To productize a model, we need to build a work flow around the model. Typical ML work flow roughly starts with data preparation via pre-defined set of ETL jobs, offline\u002Fonline model training, then ingesting trained models to web services for production. In our case, we are going to build a very minimum version of movie recommender that just does the job. Our work flow is following:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.50":{"name":"3c64","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"A new user inputs his\u002Fher favorite movies, then system create new user-movie interaction samples for the model","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.51":{"name":"532c","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"System retrains ALS model on data with the new inputs","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.52":{"name":"1334","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"System creates movie data for inference (in my case, I sample all movies from the data)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.53":{"name":"859a","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"System make rating predictions on all movies for that user","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.54":{"name":"cf39","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"System outputs top N movie recommendations for that user based on the ranking of movie rating predictions","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.55":{"name":"12ac","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is a small snippet of the source code for our MVP recommender system:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.56":{"name":"da5b","__typename":"Paragraph","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"snippet of our final step in ALS recommender’s implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.56.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:19045ad30ca6ef2007776932a0e84c34":{"id":"19045ad30ca6ef2007776932a0e84c34","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"The \"make_recommendations\" method from my ALS recommender","__typename":"MediaResource"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.56.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:19045ad30ca6ef2007776932a0e84c34","typename":"MediaResource"},"__typename":"Iframe"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57":{"name":"8871","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"This snippet demos our make_recommendations method in our recommender’s implementation. Please find the detailed source code for recommender application in my GitHub Repo.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57.markups.0":{"type":"CODE","start":23,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57.markups.1":{"type":"A","start":159,"end":170,"href":"https:\u002F\u002Fgithub.com\u002FKevinLiao159\u002FMyDataSciencePortfolio\u002Fblob\u002Fmaster\u002Fmovie_recommender\u002Fsrc\u002Fals_recommender.py","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.57.markups.2":{"type":"EM","start":159,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.58":{"name":"c6a7","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Let’s Make Some Recommendations","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.59":{"name":"4294","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Once we implemented the ALS recommender system in a python script as a small Pyspark program, we can submit our spark application to a cluster with Client Deploy Mode or Cluster Deploy Mode and enjoy the power of distributed computing.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.59.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.59.markups.0":{"type":"STRONG","start":77,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.60":{"name":"991d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, we are done with the technical details and implementations. Now let’s ask our recommender for some movie recommendations. I will pretend a new user and input my favorite movie “Iron Man” again into this new recommender system. Let’s see what movies it recommends to me. Hopefully, they are not the same list of popular movies that I have watched many times before.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.61":{"name":"29d2","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For demo purpose, I submit my spark application locally by running following commends in terminal: (instruction of commands can be found here)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.61.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.61.markups.0":{"type":"A","start":137,"end":141,"href":"https:\u002F\u002Fgithub.com\u002FKevinLiao159\u002FMyDataSciencePortfolio\u002Fblob\u002F0bc389b38de4573863446c4c90cbca3c31f7b0ef\u002Fmovie_recommender\u002Fsrc\u002Fals_recommender.py#L313","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.62":{"name":"642d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"spark-submit --master local[4] --driver-memory 4g \n             --executor-memory 8g src\u002Fals_recommender.py \n             --movie_name \"Iron Man\" --top_n 10","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.62.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.62.markups.0":{"type":"CODE","start":0,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.63":{"name":"7ad8","__typename":"Paragraph","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*tllu7jihkhbmuKQ8FuuJMA.png","typename":"ImageMetadata"},"text":"List of Movie Recommendations Based On My Favorite Movie: “Iron Man”","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tllu7jihkhbmuKQ8FuuJMA.png":{"id":"1*tllu7jihkhbmuKQ8FuuJMA.png","originalHeight":378,"originalWidth":2100,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.64":{"name":"b3e8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Yay!! Successfully run our movie recommender with Spark.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.65":{"name":"8717","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"This new list of recommended movies are completely different than the list from previous KNN recommender, which is very interesting!! I have never watch any one of movies from this new list. I find it very surprising that the new recommender proposed me unusual movies. They might be too unusual for other users, which is problematic.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.66":{"name":"1f86","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"One idea to further improve our movie recommender system is to blend this new list of movie recommendations with the previous list from KNN recommender. We basically implement a hybrid recommender system and this hybrid recommender can offer both popular and less-know content to users.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.67":{"name":"379e","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Summary","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68":{"name":"59e0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In this post, we covered how to improve collaborative filtering recommender system with matrix factorization. We learned that matrix factorization can solve “popular bias” and “item cold-start” problems in collaborative filtering. We also leveraged Spark ML to implement distributed recommender system using Alternating Least Square (ALS). The Jupyter Notebook version for this blog post can be found here. If you want to play around my source code, you can find it here.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.6","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.7","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.8","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.0":{"type":"A","start":401,"end":405,"href":"https:\u002F\u002Fgithub.com\u002FKevinLiao159\u002FMyDataSciencePortfolio\u002Fblob\u002Fmaster\u002Fmovie_recommender\u002Fmovie_recommendation_using_ALS.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.1":{"type":"A","start":466,"end":470,"href":"https:\u002F\u002Fgithub.com\u002FKevinLiao159\u002FMyDataSciencePortfolio\u002Fblob\u002Fmaster\u002Fmovie_recommender\u002Fsrc\u002Fals_recommender.py","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.2":{"type":"STRONG","start":88,"end":108,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.3":{"type":"STRONG","start":249,"end":257,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.4":{"type":"STRONG","start":308,"end":338,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.5":{"type":"STRONG","start":344,"end":368,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.6":{"type":"STRONG","start":437,"end":448,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.7":{"type":"EM","start":401,"end":405,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.68.markups.8":{"type":"EM","start":466,"end":470,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69":{"name":"2c5c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In my next post, we will dig deeper at Matrix Factorization techniques. We can develop a more generalized form of matrix factorization model with neural network implementation in Keras. Stay tuned! Until then, have fun with machine learning and recommenders!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69.markups.0":{"type":"STRONG","start":146,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69.markups.1":{"type":"STRONG","start":175,"end":176,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.69.markups.2":{"type":"STRONG","start":178,"end":186,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70":{"name":"84b1","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Like what you read? Checkout more data science \u002F machine learning projects at my Github: Kevin’s Data Science Portfolio","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70.markups.0":{"type":"A","start":89,"end":119,"href":"https:\u002F\u002Fgithub.com\u002FKevinLiao159\u002FMyDataSciencePortfolio","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70.markups.1":{"type":"STRONG","start":89,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Post:4a76c58714a1.content({\"postMeteringOptions\":{}}).bodyModel.paragraphs.70.markups.2":{"type":"EM","start":0,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Quote:anon_66f5a80e8fa4":{"id":"anon_66f5a80e8fa4","paragraphs":[{"type":"id","generated":true,"id":"Quote:anon_66f5a80e8fa4.paragraphs.0","typename":"Paragraph"}],"__typename":"Quote","userId":"anon","startOffset":0,"endOffset":360,"user":null},"Quote:anon_66f5a80e8fa4.paragraphs.0":{"name":"306b","__typename":"Paragraph"},"Tag:machine-learning":{"id":"machine-learning","displayTitle":"Machine Learning","__typename":"Tag"},"Tag:data-science":{"id":"data-science","displayTitle":"Data Science","__typename":"Tag"},"Tag:recommendation-system":{"id":"recommendation-system","displayTitle":"Recommendation System","__typename":"Tag"},"Tag:distributed-systems":{"id":"distributed-systems","displayTitle":"Distributed Systems","__typename":"Tag"},"Tag:spark":{"id":"spark","displayTitle":"Spark","__typename":"Tag"},"$Post:4a76c58714a1.previewContent":{"subtitle":"In the last post, we covered a lot of ground in how to build our own recommender systems. We also got our hand dirty with Pandas and…","__typename":"PreviewContent"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1a88ce65.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~main.85c53847.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.6bc5e071.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~screen.landingpages.trumpland~screen.post~screen.post.amp~screen.post.series~screen.profile~~b319665e.f2be28a6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.post~screen.post.amp~screen.post.series~screen.profile~screen.sequence.library~screen.sequenc~036c6b37.7f2d92d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.landingpages.trumpland~screen.post~screen.post.amp~screen.post.series~screen.profile~screen.s~5e114ebe.bc582780.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.post~screen.post.amp~screen.sequence.post.3c81fdb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.post.a30d0995.chunk.js"></script><script>window.main();</script></body></html>